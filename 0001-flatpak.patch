From e88d5cb42fe2f01fa49cd3bd19ff5a08925947a8 Mon Sep 17 00:00:00 2001
From: Christoph Settgast <csett86@web.de>
Date: Sat, 5 Nov 2022 21:12:54 +0100
Subject: [PATCH] Flatpak specifics

---
 common.pri                         |  2 --
 src/app/seamly2d/seamly2d.pro      | 12 ++++++------
 src/app/seamlyme/seamlyme.pro      |  2 +-
 src/libs/vmisc/vcommonsettings.cpp |  2 +-
 4 files changed, 8 insertions(+), 10 deletions(-)

diff --git a/common.pri b/common.pri
index fce91cc14..ccad2e664 100644
--- a/common.pri
+++ b/common.pri
@@ -268,7 +268,6 @@ ISYSTEM += \
 # Usefull GCC warnings keys.
 GCC_DEBUG_CXXFLAGS += \
     -O0 \ # Turn off oprimization.
-    $$ISYSTEM \ # Ignore warnings Qt headers.
     # Last gdb doesn't show debug symbols with Qt Creator (issue with Python 3 and debug scripts that use Python 2.7).
     # Solution to use older version gdb, that's why we use old standard of debug information.
     -gdwarf-3 \
@@ -458,7 +457,6 @@ CLANG_DEBUG_CXXFLAGS += \
     -Wduplicate-method-arg \
     -Wduplicate-method-match \
     -Wdynamic-class-memaccess \
-    -Weffc++ \
     -Wembedded-directive \
     -Wempty-body \
     -Wempty-translation-unit \
diff --git a/src/app/seamly2d/seamly2d.pro b/src/app/seamly2d/seamly2d.pro
index f83e20950..5f3b8a01d 100644
--- a/src/app/seamly2d/seamly2d.pro
+++ b/src/app/seamly2d/seamly2d.pro
@@ -164,12 +164,12 @@ unix{
         seamlyme.files += $${OUT_PWD}/../seamlyme/$${DESTDIR}/seamlyme
 
         # .desktop file
-        desktop.path = /usr/share/applications/
+        desktop.path = $$PREFIX/share/applications/
         desktop.files += ../../../dist/$${TARGET}.desktop \
         desktop.files += ../../../dist/seamlyme.desktop
 
         # logo
-        pixmaps.path = /usr/share/pixmaps/
+        pixmaps.path = $$PREFIX/share/pixmaps/
         pixmaps.files += \
             ../../../dist/$${TARGET}.png \
             ../../../dist/seamlyme.png \
@@ -178,19 +178,19 @@ unix{
             ../../../dist/application-x-seamly2d-s-measurements.png \
 
         # Path to translation files after installation
-        translations.path = /usr/share/$${TARGET}/translations/
+        translations.path = $$PREFIX/share/$${TARGET}/translations/
         translations.files = $$INSTALL_TRANSLATIONS
 
         # Path to multisize measurement after installation
-        multisize.path = /usr/share/$${TARGET}/tables/multisize/
+        multisize.path = $$PREFIX/share/$${TARGET}/tables/multisize/
         multisize.files = $$INSTALL_MULTISIZE_MEASUREMENTS
 
         # Path to templates after installation
-        templates.path = /usr/share/$${TARGET}/tables/templates/
+        templates.path = $$PREFIX/share/$${TARGET}/tables/templates/
         templates.files = $$INSTALL_STANDARD_TEMPLATES
 
         # Path to label templates after installation
-        label.path = /usr/share/$${TARGET}/labels/
+        label.path = $$PREFIX/share/$${TARGET}/labels/
         label.files = $$INSTALL_LABEL_TEMPLATES
 
         INSTALLS += \
diff --git a/src/app/seamlyme/seamlyme.pro b/src/app/seamlyme/seamlyme.pro
index f7cb07527..e482cd8b5 100644
--- a/src/app/seamlyme/seamlyme.pro
+++ b/src/app/seamlyme/seamlyme.pro
@@ -214,7 +214,7 @@ unix{
         # Path to bin file after installation
         target.path = $$PREFIX/bin
 
-        rcc_diagrams.path = /usr/share/seamly2d/
+        rcc_diagrams.path = $$PREFIX/share/seamly2d/
         rcc_diagrams.files = $${OUT_PWD}/$${DESTDIR}/diagrams.rcc
         rcc_diagrams.CONFIG = no_check_exist
 
diff --git a/src/libs/vmisc/vcommonsettings.cpp b/src/libs/vmisc/vcommonsettings.cpp
index 26ea1cc5c..4fa868854 100644
--- a/src/libs/vmisc/vcommonsettings.cpp
+++ b/src/libs/vmisc/vcommonsettings.cpp
@@ -212,7 +212,7 @@ QStringList ClearFormats(const QStringList &predefinedFormats, QStringList forma
 static const QString commonIniFilename = QStringLiteral("common");
 
 #if !defined(Q_OS_WIN)
-const QString VCommonSettings::unixStandardSharePath = QStringLiteral("/usr/share/seamly2d");
+const QString VCommonSettings::unixStandardSharePath = QStringLiteral("/app/share/seamly2d");
 #endif
 
 namespace
-- 
2.34.1

