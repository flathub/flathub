app-id: org.robiot.xclicker
runtime: org.freedesktop.Platform
runtime-version: 21.08
sdk: org.freedesktop.Sdk
command: xclicker-start
desktop-file-name-suffix:  (Flatpak)
finish-args:
  - --require-version=0.10.3
  - --share=ipc
  - --socket=x11
  - --socket=pulseaudio
  - --socket=ssh-auth
  - --share=network
  - --device=all
  - --filesystem=xdg-config/gtk-3.0
  - --filesystem=host
  - --allow=devel
  - --talk-name=org.freedesktop.Notifications
  - --talk-name=org.freedesktop.secrets
  - --talk-name=org.freedesktop.Flatpak
  - --env=NPM_CONFIG_GLOBALCONFIG=/app/etc/npmrc
  - --env=LD_LIBRARY_PATH=/app/lib
  - --filesystem=xdg-config/kdeglobals:ro
  - --talk-name=com.canonical.AppMenu.Registrar
  - --talk-name=com.canonical.AppMenu.Registrar.*
  - --system-talk-name=org.freedesktop.login1

modules:
  - name: ImageMagick
    config-opts:
      - --enable-static=no
      - --with-modules
      - --disable-docs
      - --disable-deprecated
      - --without-autotrace
      - --without-bzlib
      - --without-djvu
      - --without-dps
      - --without-fftw
      - --without-fontconfig
      - --without-fpx
      - --without-freetype
      - --without-gvc
      - --without-jbig
      - --without-jpeg
      - --without-lcms
      - --without-lzma
      - --without-magick-plus-plus
      - --without-openexr
      - --without-openjp2
      - --without-pango
      - --without-raqm
      - --without-tiff
      - --without-webp
      - --without-wmf
      - --without-x
      - --without-xml
      - --without-zlib
    sources:
      - type: archive
        url: https://imagemagick.org/download/releases/ImageMagick-7.0.10-7.tar.xz
        sha256: 7a0365e20eeef2129cb8ffee1acf1d21cdbc2ea8b57ce2941c6ca0e935d4f843
  - name: xclicker
    buildsystem: simple
    build-commands:
      - . ${FLATPAK_BUILDER_BUILDDIR}/build
    sources:
      - type: file
        path: apply_extra.sh
  
      - type: file
        path: xclicker-build.sh
        dest-filename: build

      - type: script
        dest-filename: xclicker.sh
        commands:
          - exec /app/extra/usr/bin/xclicker

      - type: file
        dest-filename: xclicker.deb
        only-arches: [x86_64]
        url: https://github.com/robiot/xclicker/releases/download/v1.3.1/xclicker_1.3.1_amd64.deb
        sha256: b6ebc0df3d867c15f8b17ce520b38f610f2193a0c638b77ae4229aa80c8c6db3
        x-checker-data:
          type: debian-repo
          package-name: xclicker
          root: https://github.com/robiot/xclicker/releases
          dist: stable
          component: main

      - type: extra-data
        filename: xclicker.deb
        only-arches: [x86_64]
        url: https://github.com/robiot/xclicker/releases/download/v1.3.1/xclicker_1.3.1_amd64.deb
        sha256: b6ebc0df3d867c15f8b17ce520b38f610f2193a0c638b77ae4229aa80c8c6db3
        size: 16844
        x-checker-data:
          type: debian-repo
          package-name: xclicker
          root: https://github.com/robiot/xclicker/releases
          dist: stable
          component: main
