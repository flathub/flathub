app-id: org.robiot.xclicker
runtime: org.freedesktop.Platform
runtime-version: "21.08"
sdk: org.freedesktop.Sdk
command: xclicker
desktop-file-name-suffix: " (Flatpak)"
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=pulseaudio
  - --socket=ssh-auth
  - --share=network
  - --device=all
  - --filesystem=xdg-config/gtk-3.0
  - --filesystem=host
  - --allow=devel
  - --talk-name=org.freedesktop.Notifications
  - --talk-name=org.freedesktop.secrets
  - --talk-name=org.freedesktop.Flatpak
  - --filesystem=xdg-config/kdeglobals:ro
  - --talk-name=com.canonical.AppMenu.Registrar
  - --talk-name=com.canonical.AppMenu.Registrar.*
  - --system-talk-name=org.freedesktop.login1

modules:
  - name: ImageMagick
    config-opts:
      - --enable-static=no
      - --with-modules
      - --disable-docs
      - --disable-deprecated
      - --without-autotrace
      - --without-bzlib
      - --without-djvu
      - --without-dps
      - --without-fftw
      - --without-fontconfig
      - --without-fpx
      - --without-freetype
      - --without-gvc
      - --without-jbig
      - --without-jpeg
      - --without-lcms
      - --without-lzma
      - --without-magick-plus-plus
      - --without-openexr
      - --without-openjp2
      - --without-pango
      - --without-raqm
      - --without-tiff
      - --without-webp
      - --without-wmf
      - --without-x
      - --without-xml
      - --without-zlib
    sources:
      - type: archive
        url: https://imagemagick.org/download/releases/ImageMagick-7.0.10-7.tar.xz
        sha256: 7a0365e20eeef2129cb8ffee1acf1d21cdbc2ea8b57ce2941c6ca0e935d4f843

  - name: xclicker
    buildsystem: meson
    build-commands:
      - . ${FLATPAK_BUILDER_BUILDDIR}/build
    sources:
      - type: file
        path: xclicker-build.sh
        dest-filename: build

      - type: script
        dest-filename: xclicker.sh
        commands:
          - exec /app/extra/usr/bin/xclicker

      - type: archive
        only-arches: [x86_64]
        url: https://github.com/robiot/xclicker/archive/refs/tags/v1.3.2.zip
        sha256: eac78ce5dbdf3dd8b0e9674e10841c5fd297a6ffad973df6fc7deed052dc23db
