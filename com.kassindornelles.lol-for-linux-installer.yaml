app-id: com.kassindornelles.lolforlinuxinstaller
runtime: org.kde.Platform
runtime-version: '5.15-22.08'
sdk: org.kde.Sdk
base: com.riverbankcomputing.PyQt.BaseApp
base-version: 5.15-22.08
cleanup-commands:
  - /app/cleanup-BaseApp.sh
build-options:
  env:
    - BASEAPP_REMOVE_WEBENGINE=1
finish-args:
  - --env=QTWEBENGINEPROCESS_PATH=/app/bin/QtWebEngineProcess
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --share=network
  - --device=dri
  - --socket=pulseaudio
command: com.kassindornelles.lolforlinuxinstaller
modules:
    - name: PyQtApp
    - python3-modules.json
    - name: lol-for-linux
      buildsystem: simple
      cleanup:
        - '.github'
        - './src'
        - 'wine_build.json'
        - 'README.md'
        - '.gitignore'

      build-commands:
        - install -d -m 755 /app/bin
        - install -D -m 755 ./src/com.kassindornelles.lolforlinuxinstaller.py /app/bin/com.kassindornelles.lolforlinuxinstaller

        - install -D -m 644 ./src/com.kassindornelles.lolforlinuxinstaller.desktop /app/share/applications/com.kassindornelles.lolforlinuxinstaller.desktop
        - install -D -m 644 ./src/lolforlinuxinstaller.svg /app/share/icons/hicolor/scalable/apps/com.kassindornelles.lolforlinuxinstaller.svg

        - desktop-file-edit --set-key="Icon" --set-value="com.kassindornelles.lolforlinuxinstaller" /app/share/applications/com.kassindornelles.lolforlinuxinstaller.desktop
        - desktop-file-edit --set-key="Exec" --set-value="com.kassindornelles.LolForLinuxInstaller %F" /app/share/applications/com.kassindornelles.lolforlinuxinstaller.desktop


        - install -D -m 644 ./src/launch-script.py /app/usr/share/lol-for-linux-installer/launch-script.py
        - install -D -m 644 ./src/vulkan_layers.py /app/usr/share/lol-for-linux-installer/vulkan_layers.py
        - install -D -m 644 ./src/env_vars.json /app/usr/share/lol-for-linux-installer/env_vars.json

        - install -D -m 644 ./src/leagueinstaller_code.py /app/usr/share/lol-for-linux-installer/leagueinstaller_code.py
        - install -D -m 644 ./src/installer.ui /app/usr/share/lol-for-linux-installer/installer.ui

      sources:
        - type: git
          url: https://github.com/kassindornelles/lol-for-linux-installer.git
          branch: main

    - name: wine-LoL
      buildsystem: simple
      build-commands:
        - install -d /app/league-of-legends/wine/wine-build/
        - mv ./bin /app/league-of-legends/wine/wine-build/
        - mv ./lib /app/league-of-legends/wine/wine-build/
        - mv ./lib64 /app/league-of-legends/wine/wine-build/
        - mv ./share /app/league-of-legends/wine/wine-build/

      sources:
        - type: archive
          url: https://github.com/kassindornelles/lol-for-linux-installer-wine-builds/releases/download/8.7-4/wine-lutris-ge-lol-8.7-4-x86_64.tar.xz
          sha256: 403b04c0c6bc388bcc5626bc0347ef49c43eac6ec9895b322e2d5847265e5e8f


    # - name: Lutris-GE-lol
    #   buildsystem: simple
    #   cleanup:
    #     - './bin'
    #     - './lib'
    #     - './lib64'
    #     - './share'
    #
    #   build-commands:
    #     - mv ./bin/* /app/bin
    #     - install -d /app/lib
    #     - mv ./lib/* /app/lib
    #     - install -d /app/lib64
    #     - mv ./lib64/* /app/lib64
    #     - install -d /app/share/applications
    #     - mv ./share/applications/* /app/share/applications
    #
      # sources:
      #   - type: archive
      #     url: https://github.com/GloriousEggroll/wine-ge-custom/releases/download/8.7-GE-1-LoL/wine-lutris-ge-lol-8.7-1-x86_64.tar.xz
      #     sha256: 66b2a7a175080d81499d04a706b50a9d93f40bd4ecff88df49562026f4bdcabc
    #
    #
