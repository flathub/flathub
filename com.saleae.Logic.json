{
    "app-id": "com.saleae.Logic",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "18.08",
    "sdk": "org.freedesktop.Sdk",
    "command": "logic-wrapper",
    "finish-args": [
        "--socket=x11",
        "--share=ipc",
        "--device=all",
        "--env=LD_LIBRARY_PATH=/app/extra/lib",
        "--env=QT_ACCESSIBILITY=0",
        "--env=NO_AT_BRIDGE=1"
    ],
    "modules": [
        {
            "name": "Logic",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "file",
                    "path": "com.saleae.Logic.desktop"
                },
                {
                    "type": "file",
                    "path": "com.saleae.Logic.appdata.xml"
                },
                {
                    "type": "file",
                    "path": "com.saleae.Logic.svg"
                },
                {
                    "type": "script",
                    "dest-filename": "logic-wrapper",
                    "commands": [
                        "exec /app/extra/bin/Logic -workingdir /var/data"
                    ]
                },
                {
                    "type": "script",
                    "dest-filename": "apply_extra",
                    "commands": [
                        "unzip logic-64.zip",
                        "rm -f logic-64.zip",
                        "mv Logic* logic-64",
                        "install -Dm755 logic-64/Logic /app/extra/bin/Logic",
                        "install -D -t /app/extra/lib logic-64/libAnalyzer.so",
                        "install -D -t /app/extra/lib logic-64/libicudata.so.56",
                        "install -D -t /app/extra/lib logic-64/libicui18n.so.56",
                        "install -D -t /app/extra/lib logic-64/libicuuc.so.56",
                        "install -D -t /app/extra/lib logic-64/libQt5Core.so.5",
                        "install -D -t /app/extra/lib logic-64/libQt5DBus.so.5",
                        "install -D -t /app/extra/lib logic-64/libQt5Gui.so.5",
                        "install -D -t /app/extra/lib logic-64/libQt5Network.so.5",
                        "install -D -t /app/extra/lib logic-64/libQt5Sql.so.5",
                        "install -D -t /app/extra/lib logic-64/libQt5Widgets.so.5",
                        "install -D -t /app/extra/lib logic-64/libQt5XcbQpa.so.5",
                        "mv logic-64/platforms /app/extra/lib",
                        "mv logic-64/Analyzers /app/extra/lib",
                        "mv logic-64/sqldrivers /app/extra/lib",
                        "ln -fs /app/extra/lib/Analyzers /app/extra/bin",
                        "ln -fs /app/extra/lib/platforms /app/extra/bin",
                        "rm -rf logic-64"
                    ]
                },
                {
                    "type": "extra-data",
                    "filename": "logic-64.zip",
                    "url": "http://downloads.saleae.com/logic/1.2.18/Logic+1.2.18+(64-bit).zip",
                    "sha256": "081601d6fdef1e88a3009fc81e403c180cbfab93cc6d16ff961a3dbd458e0a52",
                    "size": 27416409
                }
            ],
            "build-commands": [
                "install -Dm755 -t /app/bin logic-wrapper",
                "install -Dt /app/bin apply_extra",
                "install -Dm644 -t /app/share/appdata com.saleae.Logic.appdata.xml",
                "install -Dm644 -t /app/share/applications com.saleae.Logic.desktop",
                "install -Dm644 -t /app/share/icons/hicolor/scalable/apps com.saleae.Logic.svg"
            ]
        }
    ]
}
