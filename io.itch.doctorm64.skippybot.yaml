app-id: io.itch.doctorm64.skippybot
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
tags:
  - proprietary
finish-args:
- --socket=wayland
- --socket=fallback-x11
- --share=ipc

# sound and graphics
- --socket=pulseaudio
- --device=dri

command: skippybot
modules:
  - name: skippybot
    build-options:
      env:
        SKIPPY_VERSION: "115"
    buildsystem: simple
    build-commands:
      # Game
      - install -Dm644 UnityPlayer.so /app/bin/UnityPlayer.so
      - install -Dm755 skippy_${SKIPPY_VERSION}.x86_64 /app/bin/skippybot
      - cp -r skippy_${SKIPPY_VERSION}_Data/ /app/bin/skippybot_Data
      # meta files
      - install -Dm644 $FLATPAK_ID.appdata.xml /app/share/metainfo/$FLATPAK_ID.appdata.xml
      - install -Dm644 $FLATPAK_ID.png /app/share/icons/hicolor/128x128/apps/$FLATPAK_ID.png
      - install -Dm644 $FLATPAK_ID.desktop /app/share/applications/$FLATPAK_ID.desktop
    sources:
      - type: archive
        # itch.io does not provide direct downloads of assets for unregistered users.
        # This is why we're using this URL which somehow circumvents itch's limitation and allows us to download the asset from itch directly.
        url: https://cdn.matix-media.net/dd/595efc05
        dest-filename: skippy_linux64_115.zip
        strip-components: 0
        sha512: 616768b369e69d9874b16432b503e018b096f76dc6b048a97f6190eea99fc50f4db13bc6fbd011f0852a02f9af198eaafcacc9274305a34c1cc7908c8fc921a0
      - type: file
        path: io.itch.doctorm64.skippybot.appdata.xml
      - type: file
        path: io.itch.doctorm64.skippybot.png
      - type: file
        path: io.itch.doctorm64.skippybot.desktop
