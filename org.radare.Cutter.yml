id: org.radare.Cutter
runtime: org.kde.Platform
runtime-version: 5.11
sdk: org.kde.Sdk
command: Cutter
rename-desktop-file: Cutter.desktop
rename-icon: cutter # I could install it under the right name, but then I need to patch the desktop file
finish-args:
 - --share=ipc
 - --socket=x11
 - --socket=wayland
 - --filesystem=host

modules:
 - name: radare
   # translation of the arch build script
   sources:
    - type: archive
      url: https://github.com/radare/radare2/archive/2.6.0.tar.gz
      sha256: c4722519e53bbb03289e3b98e89e637e2d1f401d02cf78a198e42c2e92aeb820
    - type: file
      url: https://github.com/radare/radare2/commit/3752d992f3140806ea1d513739b6f23addf52df1.patch
      sha256: 80c84b357f89b49c6a48f78c20647b968ebe2a97e039ef669989671e0b0e93d8
    - type: file
      url: https://github.com/radare/radare2/commit/a555204c3617438250cded94d084b4dec1aaf551.patch
      sha256: ca8d31dabd4f6b3ef7ac0e618945bf5e543cbe7259f7971bab9584eda9cd8436
    - type: file
      url: https://github.com/radare/radare2/pull/10164/commits/bd21b8b0f5968849b19ec705f43460a104300356.patch
      sha256: c968b3f113982e2a4e092e84a8f8cd512b6212bb27d4a09bd6a7ae311bd966f0
    - type: shell
      commands: set -eux; for p in *5*4*f*.patch; do patch -p1 <$p; done
    - type: git
      url:  https://github.com/aquynh/capstone.git
      commit: 37569a6874c8547b349a80823adda9284499fe80
      dest: shlr/capstone
   config-opts:
    - --with-syscapstone
    - --with-syszip
    - --with-openssl
 - name: cutter
   sources:
    - type: archive
      url: https://github.com/radareorg/cutter/archive/v1.4.tar.gz
      sha256: f2fff960ea102fc8cf7d62fe25ee2c992b2e19857a4f6a2e308b3c9cba93e5b8
    - type: script
      commands:
       - mkdir build
       - cd build
       - qmake "PREFIX+=/app" ../src/Cutter.pro
      dest-filename: configure
    - type: file
      path: cutter-Makefile
      dest-filename: Makefile
    - type: file
      path: org.radare.Cutter.appdata.xml
