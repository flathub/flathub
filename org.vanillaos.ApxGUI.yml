id: org.vanillaos.ApxGUI
runtime: org.gnome.Platform
runtime-version: '49'
sdk: org.gnome.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.golang
command: apx-gui

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri
  - --talk-name=org.freedesktop.Flatpak

modules:
  - name: apx
    buildsystem: simple
    build-options:
      append-path: /usr/lib/sdk/golang/bin
      env:
        GOBIN: /app/bin
    build-commands:
      - go install -mod=vendor
    sources:
      - type: git
        url: https://github.com/Vanilla-OS/apx.git
        tag: v2.5.0
        commit: ac65627cfa279c39ff85f5feb95cb1ab3e821442
      - go.mod.yml

  - name: apx-configs
    buildsystem: simple
    build-commands:
      - mkdir -p /app/share/apx
      - mv * /app/share/apx
    sources:
      - type: git
        url: https://github.com/Vanilla-OS/vanilla-apx-configs.git
        tag: v1.0.0
        commit: 691d7c737b0fff095f81adfca4736aecc318beaa
      - type: file
        path: apx.json

  - name: fast_float
    buildsystem: cmake-ninja
    sources:
      - type: git
        url: https://github.com/fastfloat/fast_float.git
        tag: v8.2.2
        commit: 97b54ca9e75f5303507699d27c6b4f4efe4641a1

  - name: simdutf
    buildsystem: cmake-ninja
    sources:
      - type: git
        url: https://github.com/simdutf/simdutf.git
        tag: v7.7.1
        commit: 98218fc47232b57dda64191b0204c25c09984f03

  - name: vte
    buildsystem: meson
    config-opts:
      - -Dapp=false
      - -Dglade=false
      - -Dgtk3=false
      - -Dvapi=false
    sources:
      - type: git
        url: https://gitlab.gnome.org/GNOME/vte.git
        tag: 0.82.3
        commit: 18fca6d0a124c2d0fb87293306626db1d5ba8ebc

  - python3-requests.json

  - python3-PyYAML.json

  - name: apx-gui
    buildsystem: meson
    sources:
      - type: git
        url: https://github.com/Vanilla-OS/apx-gui.git
        tag: v1.0.5
        commit: 42f1f99bc4a4c4db4b901bdedb50090d267eb507
