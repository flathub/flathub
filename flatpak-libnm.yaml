## All the dependencies we need to build libnm from source.
## TODO: Remove this and use QtDbus to manipulate the API instead?
name: libnl
build-commands: []
buildsystem: simple
modules:
  - name: intltool
    cleanup:
      - '*'
    sources:
      - type: archive
        url: https://launchpad.net/intltool/trunk/0.51.0/+download/intltool-0.51.0.tar.gz
        sha256: 67c74d94196b153b774ab9f89b2fa6c6ba79352407037c8c14d5aeb334e959cd

  - name: libndp
    buildsystem: autotools
    cleanup:
      - /bin
      - /include
      - /lib/pkgconfig
      - /share/man
    sources:
      - type: archive
        url: https://github.com/jpirko/libndp/archive/v1.9.tar.gz
        sha256: e564f5914a6b1b799c3afa64c258824a801c1b79a29e2fe6525b682249c65261

  - name: NetworkManager
    buildsystem: meson
    build-options:
      cflags: -ltinfo
      cxxflags: -ltinfo
    config-opts:
      - -Dsystemdsystemunitdir=no
      - -Ddbus_conf_dir=/app/etc/dbus-1/system.d
      - -Diptables=/usr/bin/true
      - -Ddnsmasq=/usr/bin/true
      - -Dsession_tracking=no
      - -Dselinux=false
      - -Dsystemd_journal=false
      - -Dlibaudit=no
      - -Dwext=false
      - -Dwifi=false
      - -Dppp=false
      - -Dmodem_manager=false
      - -Dovs=false
      - -Dnmcli=false
      - -Dnmtui=false
      # We need introspection
      - -Dintrospection=true
      - -Dvapi=false
      - -Ddocs=false
      - -Dtests=no
      - -Dfirewalld_zone=false
      - -Dlibpsl=false
      - -Dqt=false
      - -Dpolkit=false
    cleanup:
      - /sbin
      - /etc
      - /include
      - /lib/pkgconfig
      - /libexec
      - /var
      - /share/bash-completion
      - /share/doc
    sources:
      - type: git
        url: https://gitlab.freedesktop.org/NetworkManager/NetworkManager.git
        tag: 1.40.18
        commit: 2db3748ec8162ce948ba52f71b42a258ff8d64ba
