{
  "app-id": "org.qtodotxt.qtodotxt",
  "runtime": "org.kde.Platform",
  "runtime-version": "5.12",
  "sdk": "org.kde.Sdk",
  "command": "qtodotxt",
  "finish-args": [
    "--share=ipc",
    "--socket=x11",
    "--device=dri",
    "--socket=wayland",
    "--filesystem=home",
    "--filesystem=/tmp",
    "--filesystem=xdg-config/kdeglobals:ro",
    "--talk-name=com.canonical.AppMenu.Registrar",
    "--talk-name=com.canonical.AppMenu.Registrar.*"
  ],
  "modules":[
    {
      "name": "python3-sip",
      "config-opts": [
        "--sip-module=PyQt5.sip",
        "--bindir=/app/bin",
        "--destdir=/app/lib/python3.7/site-packages",
        "--incdir=/app/include",
        "--pyidir=/app/lib/python3.7/site-packages",
        "--sipdir=/app/share/sip",
        "--stubsdir=/app/lib/python3.7/site-packages"
      ],
      "build-options": {
        "env": {
          "QMAKEPATH": "/app/lib"
        }
      },
      "sources": [
        {
          "type": "archive",
          "url": "https://sourceforge.net/projects/pyqt/files/sip/sip-4.19.13/sip-4.19.13.tar.gz",
          "sha256": "e353a7056599bf5fbd5d3ff9842a6ab2ea3cf4e0304a0f925ec5862907c0d15e"
        },
        {
          "type": "patch",
          "path": "sip-4.18-no_strip.patch"
        },
        {
          "type": "patch",
          "path": "sip-4.18-no_rpath.patch"
        },
        {
          "type": "script",
          "commands": [
            "processed=\"$( sed -e 's|--prefix=/app||' <<< \"${@}\" )\";",
            "python3 \"configure.py\" ${processed};"
          ],
          "dest-filename": "configure"
        }
      ],
      "cleanup": [
        "/bin"
      ]
    },
    {
      "name": "python3-pyqt5",
      "config-opts": [
        "--verbose",
        "--confirm-license",
        "--sip-incdir=/app/include",
        "--bindir=/app/bin",
        "--destdir=/app/lib/python3.7/site-packages",
        "--designer-plugindir=/app/lib/plugins/designer",
        "--qml-plugindir=/app/lib/plugins/PyQt5",
        "--sipdir=/app/share/sip",
        "--stubsdir=/app/lib/python3.7/site-packages/PyQt5",
        "QMAKE_CFLAGS_RELEASE='-I/usr/include/python3.7m/'",
        "QMAKE_CXXFLAGS_RELEASE='-I/usr/include/python3.7m/'"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.11.3/PyQt5_gpl-5.11.3.tar.gz",
          "sha256": "c9b57d15601d436faf35dacf8e0acefa220194829a653e771e80b189b3261073"
        },
        {
          "type": "patch",
          "path": "PyQt5-Timeline.patch"
        },
        {
          "type": "script",
          "commands": [
            "processed=\"$( sed -e 's|prefix|sysroot|' <<< \"${@}\" )\";",
            "python3 \"configure.py\" ${processed};"
          ],
          "dest-filename": "configure"
        }
      ],
      "cleanup": [
        "/bin"
      ]
    },
    {
      "name": "six",
      "buildsystem": "simple",
      "build-commands": [
        "python3 setup.py install --prefix=/app"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/benjaminp/six/archive/1.11.0.tar.gz",
          "sha256": "927dc6fcfccd4e32e1ce161a20bf8cda39d8c9d5f7a845774486907178f69bd4"
        }
      ]
    },
    {
      "name": "python-dateutil",
      "buildsystem": "simple",
      "build-commands": [
        "pip3 install --prefix=/app python_dateutil-2.6.1-py2.py3-none-any.whl"
      ],
      "sources": [
        {
          "type": "file",
          "url": "https://pypi.python.org/packages/4b/0d/7ed381ab4fe80b8ebf34411d14f253e1cf3e56e2820ffa1d8844b23859a2/python_dateutil-2.6.1-py2.py3-none-any.whl#md5=342c025339de1e7c2138c74983c111d7",
          "sha256": "95511bae634d69bc7329ba55e646499a842bc4ec342ad54a8cdb65645a0aad3c"
        }
      ]
    },
    {
      "name": "org.qtodotxt.qtodotxt",
      "buildsystem": "simple",
      "build-commands": [
        "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} qtodotxt",
        "install -Dm644 org.qtodotxt.qtodotxt128x128.png /app/share/icons/hicolor/128x128/apps/org.qtodotxt.qtodotxt.png",
        "install -Dm644 org.qtodotxt.qtodotxt64x64.png /app/share/icons/hicolor/64x64/apps/org.qtodotxt.qtodotxt.png",
        "install -Dm644 org.qtodotxt.qtodotxt.desktop /app/share/applications/org.qtodotxt.qtodotxt.desktop",
        "install -Dm644 org.qtodotxt.qtodotxt.appdata.xml /app/share/appdata/org.qtodotxt.qtodotxt.appdata.xml"
      ],
      "sources": [
        {
          "type": "file",
          "path": "org.qtodotxt.qtodotxt.desktop"
        },
        {
          "type": "file",
          "path": "org.qtodotxt.qtodotxt.appdata.xml"
        },
        {
          "type": "file",
          "path": "org.qtodotxt.qtodotxt64x64.png"
        },
        {
          "type": "file",
          "path": "org.qtodotxt.qtodotxt128x128.png"
        },
        {
          "type": "file",
          "url": "https://files.pythonhosted.org/packages/07/64/b3a364a991ab30b5594157e5f8f6791521ae7bfd5d50780860aa338b8ce6/qtodotxt-1.9.0.tar.gz",
          "sha256": "80e1e76120a0442842e0386c87a7cf4de5455f48ffde08af23df05498e693cdf"
        }
      ]
    }
  ]
}
