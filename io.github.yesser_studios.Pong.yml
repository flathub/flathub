id: io.github.yesser_studios.Pong
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.dotnet8
finish-args:
  - --device=dri
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc

command: run.sh
modules:
  - name: dotnet
    buildsystem: simple
    build-commands:
      - /usr/lib/sdk/dotnet8/bin/install.sh

  - name: pong
    buildsystem: simple
    build-commands:
      - mkdir -p ${FLATPAK_DEST}/bin
      - cp -r ./bin/release/* ${FLATPAK_DEST}/bin/
      - install -Dm644 flatpak/io.github.yesser_studios.Pong.desktop -t ${FLATPAK_DEST}/share/applications/
      - install -Dm644 flatpak/io.github.yesser_studios.Pong.png -t ${FLATPAK_DEST}/share/icons/hicolor/128x128/apps
      - install -Dm644 flatpak/io.github.yesser_studios.Pong.metainfo.xml -t ${FLATPAK_DEST}/share/metainfo
      - install -Dm755 ./run.sh -t ${FLATPAK_DEST}/bin/
    sources:
      - type: git
        url: https://github.com/yesser-studios/Pong.git
        tag: v1.2.0
      - type: archive
        url: https://github.com/yesser-studios/Pong/releases/download/v1.2.0/linux-universal.tar.gz
        sha256: f273b1b9bba002313c3ac4944f5db8917b955b5b70e72bcef7361c0324f475f4
        dest-filename: build.tar.gz
        dest: bin/
        strip-components: 1
      - type: script
        dest-filename: run.sh
        commands:
          - dotnet /app/bin/Pong.Desktop.dll
      
