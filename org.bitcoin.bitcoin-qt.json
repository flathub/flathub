{
    "id": "org.bitcoin.bitcoin-qt",
    "runtime": "org.kde.Platform",
    "runtime-version": "5.12",
    "sdk": "org.kde.Sdk",
    "command": "bitcoin-qt",
    "finish-args": [
	/* Wayland and Xorg support */
	"--socket=x11",
	"--socket=wayland",
	/* Persistent storage */
	"--persist=.bitcoin",
	/* OpenGL access. */
	"--device=dri",
	/* Network acess. */
	"--share=network",
	/* Sound */
	"--share=pulseaudio",
    ],
    "modules": [
	{
	    "name": "boost",
	    "buildsystem": "simple",
	    "config-opts": [
		"--with-boost-libdir=/app/lib"
	    ],
	    "build-commands": [
		"./bootstrap.sh --prefix=/app",
		"./b2 install --prefix=/app --with-chrono --with-filesystem --with-thread --with-system --with-test"
	    ],
	    "sources": [
		{
		    "type": "archive",
		    "url": "https://dl.bintray.com/boostorg/release/1.70.0/source/boost_1_70_0.tar.bz2",
		    "sha256": "430ae8354789de4fd19ee52f3b1f739e1fba576f0aded0897c3c2bc00fb38778"
		}
	    ]
	},
	/* Installed used the same method as in btc-core's repository. */
	{
	    "name": "libdb",
	    "buildsystem": "simple",
	    "build-commands": [
		"patch -p2 < clang.patch",
		"cd build_unix && ../dist/configure --enable-cxx --disable-shared --disable-replication --with-pic --prefix=/app",
		"make install -C build_unix"
	    ],
	    "sources": [
		{
		    "type": "archive",
		    "url": "https://download.oracle.com/berkeley-db/db-4.8.30.NC.tar.gz",
		    "sha256": "12edc0df75bf9abd7f82f821795bcee50f42cb2e5f76a6a281b85732798364ef"
		},
		{
		    "type": "file",
		    "url": "https://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.guess;hb=55eaf3e779455c4e5cc9f82efb5278be8f8f900b",
		    "sha256": "2d1ff7bca773d2ec3c6217118129220fa72d8adda67c7d2bf79994b3129232c1",
		    "path": "dist/config.guess"
		},
		{
		    "type": "file",
		    "url": "https://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.sub;hb=55eaf3e779455c4e5cc9f82efb5278be8f8f900b",
		    "sha256": "3a4befde9bcdf0fdb2763fc1bfa74e8696df94e1ad7aac8042d133c8ff1d2e32",
		    "path": "dist/config.sub"
		},
		{
		    "type": "file",
		    "url":
		    "https://gist.githubusercontent.com/LnL7/5153b251fd525fe15de69b67e63a6075/raw/7778e9364679093a32dec2908656738e16b6bdcb/clang.patch",
		    "sha256": "7a9a47b03fd5fb93a16ef42235fa9512db9b0829cfc3bdf90edd3ec1f44d637c",
		    "path": "clang.patch"
		}
	    ]
	},
	{
	    "name" : "libevent",
	    "sources" : [
		{
		    "type": "git",
		    "url": "https://github.com/libevent/libevent",
		    "tag": "release-2.1.11-stable",
		    "commit": "4c908dde58ef780eeefcc9df4db3063ca62ea862"
		}
	    ]
	},
	{
	    "name": "bitcoin-core",
	    "buildsystem": "autotools",
	    "config-opts": [
		"--with-boost-libdir=/app/lib"
	    ],
	    "sources": [
		{
		    "type": "git",
		    "url": "https://github.com/bitcoin/bitcoin.git",
		    "tag": "v0.18.0",
		    "commit": "2472733a24a9364e4c6233ccd04166a26a68cc65"
		}
	    ]
	},
	{
	    "name": "Icons and .desktop",
	    "buildsystem": "simple",
	    "build-commands": [
		"install -Dp -m 644 org.bitcoin.bitcoin-qt.desktop /app/share/applications/org.bitcoin.bitcoin-qt.desktop",
		"install -Dp -m 644 org.bitcoin.bitcoin-qt-256.png /app/share/icons/hicolor/256x256/apps/org.bitcoin.bitcoin-qt.png",
		"install -Dp -m 644 org.bitcoin.bitcoin-qt-128.png /app/share/icons/hicolor/128x128/apps/org.bitcoin.bitcoin-qt.png",
		"install -Dp -m 644 org.bitcoin.bitcoin-qt-64.png /app/share/icons/hicolor/64x64/apps/org.bitcoin.bitcoin-qt.png",
		"install -Dp -m 644 org.bitcoin.bitcoin-qt.appdata.xml /app/share/appdata/org.bitcoin.bitcoin-qt.appdata.xml"
	    ],
	    "sources": [
		{
		    "type": "file",
		    "path": "org.bitcoin.bitcoin-qt.desktop"
		},
		{
		    "type": "file",
		    "path": "org.bitcoin.bitcoin-qt.appdata.xml"
		},
		{
		    "type": "file",
		    "path": "org.bitcoin.bitcoin-qt-64.png"
		},
		{
		    "type": "file",
		    "path": "org.bitcoin.bitcoin-qt-128.png"
		},
		{
		    "type": "file",
		    "path": "org.bitcoin.bitcoin-qt-256.png"
		}
	    ]
	}
    ]
}
