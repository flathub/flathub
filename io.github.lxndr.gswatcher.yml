app-id: io.github.lxndr.gswatcher
runtime: org.gnome.Platform
runtime-version: '45'
sdk: org.gnome.Sdk
command: gswatcher
finish-args:
  - '--device=dri'
  - '--share=ipc'
  - '--socket=fallback-x11'
  - '--socket=wayland'
  - '--share=network'
modules:
  - shared-modules/lua5.4/lua-5.4.json
  - name: geoip
    buildsystem: autotools
    sources:
      - type: archive
        url: https://github.com/maxmind/geoip-api-c/archive/v1.6.12.tar.gz
        sha256: 99b119f8e21e94f1dfd6d49fbeed29a70df1544896e76cd456f25e397b07d476
      - type: file
        url: https://sources.archlinux.org/other/packages/geoip-database/20230901/GeoIPCity.dat.gz
        sha256: 3fe1e42b1992060165c79168e6a18cf7ccfed26e5cba641052435eb68f1db32b
    post-install:
      - gzip -d GeoIPCity.dat.gz
      - install -d $FLATPAK_DEST/share/GeoIP
      - install -m644 -t $FLATPAK_DEST/share/GeoIP GeoIPCity.dat
  - name: iso-flag-png
    buildsystem: simple
    sources:
      - type: archive
        url: http://packages.linuxmint.com/pool/main/f/flags/flags_1.0.2.tar.xz
        sha256: 4726333387e5795d49a2a54f7ffbbdb5b50f47b6aa20533a78b6eded347ca57c
    build-commands:
      - cp -r usr/share $FLATPAK_DEST
  - name: gswatcher
    buildsystem: meson
    sources:
      - type: git
        url: https://github.com/lxndr/gswatcher
        commit: bbf573aae9f88663a1601c78755cb9f3c0f7566e
cleanup:
  - /bin/geoiplookup
  - /bin/geoiplookup6
  - /include
  - /lib/lua
  - /lib/pkgconfig
  - /share/lua
  - /share/man
  - '*.la'
  - '*.a'

