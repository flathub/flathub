name: ffmpeg
config-opts:
  - --enable-shared
  - --disable-static
  - --disable-doc
  - --disable-manpages
  - --disable-stripping
  - --disable-ffplay
  - --disable-ffprobe

  - --enable-gpl
  - --enable-nonfree
  - --enable-version3
  - --enable-optimizations
  - --enable-postproc
  - --enable-pthreads
  - --enable-gnutls
  - --enable-libxcb-xfixes
  - --enable-openal
  - --enable-opengl
  - --enable-opencl
  - --enable-sdl2
  - --enable-libpulse
  - --enable-libv4l2
  - --enable-vaapi
  - --enable-vdpau
  - --enable-zlib
  - --enable-bzlib
  - --enable-lzma

  - --enable-fontconfig
  - --enable-libfontconfig
  - --enable-libfreetype

  - --enable-libass
  - --enable-libfdk-aac
  - --enable-libmp3lame

  # copied from another manifest
  - --enable-avcodec
  - --enable-avfilter
  - --enable-avresample
  - --enable-libxml2
  - --enable-swscale

  - --enable-frei0r
  - --enable-gcrypt
  - --enable-gmp
  - --enable-ladspa

  - --enable-libaom
  - --enable-libass
  - --enable-libbluray
  - --enable-libbs2b
  - --enable-libcaca
  - --enable-libdrm
  - --enable-libfdk-aac
  - --enable-libfreetype
  - --enable-libfribidi
  - --enable-libgme
  - --enable-libgsm
  - --enable-libilbc
  - --enable-libmodplug
  - --enable-libmp3lame
  - --enable-libopencore-amrnb
  - --enable-libopencore-amrwb
  - --enable-libopenh264
  - --enable-libopenjpeg
  - --enable-libopus
  - --enable-libpulse
  - --enable-librsvg
  - --enable-librubberband
  - --enable-libsnappy
  - --enable-libsoxr
  - --enable-libspeex
  - --enable-libtheora
  - --enable-libtwolame
  - --enable-libv4l2
  - --enable-libvidstab
  - --enable-libvorbis
  - --enable-libvo-amrwbenc
  - --enable-libvpx
  - --enable-libwebp
  - --enable-libx264
  - --enable-libx265
  - --enable-libxcb
  - --enable-libxvid
  - --enable-libzmq

  - --enable-bsf=vp9_superframe
  - --enable-decoder=aac
  - --enable-decoder=aac_latm
  - --enable-decoder=aasc
  - --enable-decoder=ac3
  - --enable-decoder=als
  - --enable-decoder=bink
  - --enable-decoder=binkaudio_rdft
  - --enable-decoder=cscd
  - --enable-decoder=dca
  - --enable-decoder=eac3
  - --enable-decoder=flac
  - --enable-decoder=gif
  - --enable-decoder=h263
  - --enable-decoder=h264
  - --enable-decoder=h264_vdpau
  - --enable-decoder=hevc
  - --enable-decoder=libopus
  - --enable-decoder=libspeex
  - --enable-decoder=libvorbis
  - --enable-decoder=libvpx_vp8
  - --enable-decoder=libvpx_vp9
  - --enable-decoder=mjpeg
  - --enable-decoder=mlp
  - --enable-decoder=mp1
  - --enable-decoder=mp1float
  - --enable-decoder=mp2
  - --enable-decoder=mp2float
  - --enable-decoder=mp3
  - --enable-decoder=mp3adu
  - --enable-decoder=mp3adufloat
  - --enable-decoder=mp3float
  - --enable-decoder=mp3on4
  - --enable-decoder=mp3on4float
  - --enable-decoder=mpeg4
  - --enable-decoder=mpeg4_vdpau
  - --enable-decoder=msmpeg4v2
  - --enable-decoder=msmpeg4v3
  - --enable-decoder=opus
  - --enable-decoder=pcm_alaw
  - --enable-decoder=pcm_f32le
  - --enable-decoder=pcm_mulaw
  - --enable-decoder=pcm_s16be
  - --enable-decoder=pcm_s16le
  - --enable-decoder=pcm_s24be
  - --enable-decoder=pcm_s24le
  - --enable-decoder=pcm_u8
  - --enable-decoder=png
  - --enable-decoder=rawvideo
  - --enable-decoder=theora
  - --enable-decoder=truehd
  - --enable-decoder=vorbis
  - --enable-decoder=vp8
  - --enable-decoder=vp9
  - --enable-decoder=wavpack
  - --enable-decoder=webp
  - --enable-decoder=wmalossless
  - --enable-decoder=wmapro
  - --enable-decoder=wmav1
  - --enable-decoder=wmav2
  - --enable-decoder=wmavoice
  - --enable-demuxer=aac
  - --enable-demuxer=ac3
  - --enable-demuxer=asf
  - --enable-demuxer=avi
  - --enable-demuxer=bink
  - --enable-demuxer=flac
  - --enable-demuxer=gif
  - --enable-demuxer=h264
  - --enable-demuxer=image2
  - --enable-demuxer=m4a
  - --enable-demuxer=m4v
  - --enable-demuxer=matroska
  - --enable-demuxer=mjpeg
  - --enable-demuxer=mov
  - --enable-demuxer=mp3
  - --enable-demuxer=ogg
  - --enable-demuxer=pcm_s16le
  - --enable-demuxer=wav
  - --enable-encoder=aac
  - --enable-encoder=ac3
  - --enable-encoder=apng
  - --enable-encoder=ffvhuff
  - --enable-encoder=gif
  - --enable-encoder=libopus
  - --enable-encoder=libtheora
  - --enable-encoder=libvorbis
  - --enable-encoder=libvpx_vp8
  - --enable-encoder=libvpx_vp9
  - --enable-encoder=libx264
  - --enable-encoder=mpeg4
  - --enable-encoder=png
  - --enable-encoder=wmav2
  - --enable-filter=crop
  - --enable-filter=fps
  - --enable-filter=palettegen
  - --enable-filter=paletteuse
  - --enable-filter=scale
  - --enable-hwaccel=h264_vaapi
  - --enable-hwaccel=h264_vdpau
  - --enable-hwaccel=hevc_vaapi
  - --enable-hwaccel=hevc_vdpau
  - --enable-hwaccel=mpeg4_vaapi
  - --enable-hwaccel=mpeg4_vdpau
  - --enable-hwaccel=vp9_vaapi
  - --enable-indev=v4l2
  - --enable-indev=xcbgrab
  - --enable-muxer=ac3
  - --enable-muxer=apng
  - --enable-muxer=asf
  - --enable-muxer=avi
  - --enable-muxer=gif
  - --enable-muxer=h264
  - --enable-muxer=image2
  - --enable-muxer=ipod
  - --enable-muxer=mov
  - --enable-muxer=mp4
  - --enable-muxer=ogg
  - --enable-muxer=opus
  - --enable-muxer=webm
  - --enable-parser=aac
  - --enable-parser=aac_latm
  - --enable-parser=ac3
  - --enable-parser=dca
  - --enable-parser=flac
  - --enable-parser=h264
  - --enable-parser=hevc
  - --enable-parser=mjpeg
  - --enable-parser=mpeg4video
  - --enable-parser=mpegaudio
  - --enable-parser=opus
  - --enable-parser=vorbis
  - --enable-parser=vp3
  - --enable-parser=vp8
  - --enable-protocol=file
build-options:
  arch:
    i386:
      config-opts:
        - --enable-nvdec
        - --enable-nvenc
        - --enable-cuvid
    x86_64:
      config-opts:
        - --enable-nvdec
        - --enable-nvenc
        - --enable-cuvid
sources:
  - type: archive
    url: https://ffmpeg.org/releases/ffmpeg-4.1.tar.xz
    sha256: a38ec4d026efb58506a99ad5cd23d5a9793b4bf415f2c4c2e9c1bb444acd1994
post-install:
  - install -p -D -m 0644 COPYING* "LICENSE.md" -t "${FLATPAK_DEST}/share/licenses/ffmpeg/";
cleanup:
  - /share/ffmpeg/examples
