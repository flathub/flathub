app-id: io.github.sourcegit_scm.sourcegit
runtime: org.freedesktop.Sdk
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
command: sourcegit
finish-args:
  - --device=dri
  - --socket=x11
  - --share=ipc
  - --share=network
  - --filesystem=~/.gnupg:ro
  - --filesystem=xdg-run/gnupg:ro
  - --filesystem=~/Repos
  - --filesystem=~/Repositories
  - --filesystem=~/Code
  - --filesystem=~/Dev
modules:
  - name: sourcegit
    buildsystem: simple
    sources:
      - type: archive
        url: https://github.com/sourcegit-scm/sourcegit/releases/download/v2025.41/sourcegit-2025.41-1.x86_64.rpm
        sha256: 46eff9524698e88c26ebef8e810d7d390d6e8771e717b710a5096c3b0d721566
        only-arches:
          - x86_64
        x-checker-data:
          type: github
          repo: sourcegit-scm/sourcegit
          tag-pattern: ^v([\d.]+)$
          version-scheme: semantic
          asset-pattern: ^sourcegit-([\d.]+)-1\.x86_64\.rpm$
          is-main-source: true
      - type: archive
        url: https://github.com/sourcegit-scm/sourcegit/releases/download/v2025.41/sourcegit-2025.41-1.aarch64.rpm
        sha256: 329dfab1f0edd3ccb609c5208de0925a9d0e8fa6c961fe9559190b8c8f94a382
        only-arches:
          - aarch64
        x-checker-data:
          type: github
          repo: sourcegit-scm/sourcegit
          tag-pattern: ^v([\d.]+)$
          version-scheme: semantic
          asset-pattern: ^sourcegit-([\d.]+)-1\.aarch64\.rpm$
          is-main-source: true
      - type: file
        path: io.github.sourcegit_scm.sourcegit.desktop
      - type: file
        path: io.github.sourcegit_scm.sourcegit.metainfo.xml
    build-commands:
      - mkdir -p ${FLATPAK_DEST}/bin
      - cp -r sourcegit/* ${FLATPAK_DEST}/bin
      - install -D -m644 share/icons/sourcegit.png ${FLATPAK_DEST}/share/icons/hicolor/256x256/apps/${FLATPAK_ID}.png
      - install -D -m644 -t ${FLATPAK_DEST}/share/applications/ ${FLATPAK_ID}.desktop
      - install -D -m644 -t ${FLATPAK_DEST}/share/metainfo/ ${FLATPAK_ID}.metainfo.xml
