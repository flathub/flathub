id: org.freedesktop.LinuxAudio.Plugins.NeuralAmpModeler
branch: '22.08'
build-extension: true
runtime: org.freedesktop.LinuxAudio.BaseExtension
runtime-version: stable
sdk: org.freedesktop.Sdk//22.08
build-options:
  prefix: /app/extensions/Plugins/NeuralAmpModeler
modules:
  - name: NeuralAmpModeler
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
    post-install:
      - "mv ${FLATPAK_DEST}/lib/lv2 ${FLATPAK_DEST}"
      - "install -Dm644 LICENCE.md ${FLATPAK_DEST}/share/licenses/NeuralAmpModelerLV2Plugin/LICENSE"
      - "install -Dm644 deps/NeuralAmpModelerCore/LICENSE ${FLATPAK_DEST}/share/licenses/NeuralAmpModeler/LICENSE"
      - "install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo org.freedesktop.LinuxAudio.Plugins.NeuralAmpModeler.metainfo.xml"
      - "appstream-compose --basename=${FLATPAK_ID} --prefix=${FLATPAK_DEST} --origin=flatpak ${FLATPAK_ID}"
    cleanup:
      - lib
    sources:
      - type: git
        url: https://github.com/mikeoliphant/neural-amp-modeler-lv2
        tag: 0.1.2
        commit: 1deb8cb5bc4ca29f99a4644612acb7a47b353d10
      - type: patch
        path: nam-fixes.patch
      - type: file
        path: org.freedesktop.LinuxAudio.Plugins.NeuralAmpModeler.metainfo.xml
