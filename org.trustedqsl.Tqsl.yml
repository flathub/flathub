app-id: org.trustedqsl.Tqsl
runtime: org.kde.Platform
runtime-version: '5.15'
sdk: org.kde.Sdk
command: tqsl
rename-desktop-file: tqsl.desktop
rename-icon: tqsl
finish-args:
  - --share=ipc
  - --socket=x11
  - --device=all
  - --share=network
  - --persist=.tqsl
  - --filesystem=home
cleanup:
  - /man
  - /include
  - /share/man
  - /share/doc
  - /doc
  - '*.a'
  - '*.la'
modules:
  - name: prepare
    buildsystem: simple
    build-commands:
       - mkdir $FLATPAK_DEST/bin
       - mkdir $FLATPAK_DEST/man
       - mkdir $FLATPAK_DEST/lib
       - mkdir $FLATPAK_DEST/include
       - mkdir -p $FLATPAK_DEST/share/applications/
       - mkdir -p $FLATPAK_DEST/share/icons/hicolor/128x128/apps/
  - name: lmdb
    buildsystem: simple
    build-commands:
       - sed -i '/^prefix/d' Makefile
       - make prefix=$FLATPAK_DEST 
       - make install prefix=$FLATPAK_DEST
    sources:
      - type: archive
        url: http://ponce.cc/slackware/sources/repo/lmdb-0.9.14.tar.gz
        sha256 : 56aa6edd124335608842c1b69ffa2add815a3b8330d8ef2936f3598d0b39268c
  - name: wx
    sources:
      - type: archive
        url: https://github.com/wxWidgets/wxWidgets/releases/download/v3.1.4/wxWidgets-3.1.4.tar.bz2
        sha256 : 3ca3a19a14b407d0cdda507a7930c2e84ae1c8e74f946e0144d2fa7d881f1a94
  - name: tqsl
    buildsystem: cmake
    build-commands:
       - cp apps/tqsl.desktop $FLATPAK_DEST/share/applications/tqsl.desktop
       - cp apps/icons/key128.png $FLATPAK_DEST/share/icons/hicolor/128x128/apps/tqsl.png
    sources:
      - type: archive
        url: http://www.arrl.org/tqsl/tqsl-2.5.7.tar.gz
        sha256 : d1095350dc0a7aeb91fa7f1e4f4e248b2c00b18de1acf18f607d40f38326c48b
  - name: metainfo
    buildsystem: simple
    build-commands:
        - install -D org.trustedqsl.Tqsl.metainfo.xml /app/share/metainfo/org.trustedqsl.Tqsl.metainfo.xml
    sources:
      - type: file
        path: org.trustedqsl.Tqsl.metainfo.xml
