{
    "id": "com.rustdesk.RustDesk",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "23.08",
    "sdk": "org.freedesktop.Sdk",
    "command": "rustdesk",
    "icon": "share/icons/hicolor/scalable/apps/rustdesk.svg",
    "modules": [
      "shared-modules/libappindicator/libappindicator-gtk3-12.10.json",
      "xdotool.json",
      {
        "name": "pam",    
        "buildsystem": "simple",
        "build-commands": [
            "./configure --disable-selinux --prefix=/app && make -j4 install"
        ],
        "sources": [
          {
            "type": "archive",
            "url": "https://github.com/linux-pam/linux-pam/releases/download/v1.3.1/Linux-PAM-1.3.1.tar.xz",
            "sha256": "eff47a4ecd833fbf18de9686632a70ee8d0794b79aecb217ebd0ce11db4cd0db"
          }
        ]
      },
      {
        "name": "libarchive",
        "buildsystem": "autotools",
        "config-opts": ["--disable-static"],
        "cleanup": ["/include", "/lib/*.la", "/lib/pkgconfig", "/share"],
        "sources": [
            {
                "type": "archive",
                "url": "https://github.com/libarchive/libarchive/releases/download/v3.5.1/libarchive-3.5.1.tar.gz",
                "sha256": "9015d109ec00bb9ae1a384b172bf2fc1dff41e2c66e5a9eeddf933af9db37f5a"
            }
        ]
      },
      {
        "name": "rustdesk",
        "buildsystem": "simple",
        "build-commands": [
          "bsdtar -zxvf rustdesk*.deb",
          "tar -xvf ./data.tar.xz",
          "cp -r usr/*  /app/",
          "mkdir -p /app/bin && ln -s /app/lib/rustdesk/rustdesk /app/bin/rustdesk",
          "mv /app/share/applications/rustdesk.desktop /app/share/applications/com.rustdesk.RustDesk.desktop",
          "mv /app/share/applications/rustdesk-link.desktop /app/share/applications/com.rustdesk.RustDesk-link.desktop",
          "sed -i '/^Icon=/ c\\Icon=com.rustdesk.RustDesk' /app/share/applications/*.desktop",
          "install -Dm644 usr/share/icons/hicolor/256x256/apps/rustdesk.png /app/share/icons/hicolor/256x256/apps/com.rustdesk.RustDesk.png"
        ],
        "cleanup": ["/include", "/lib/pkgconfig", "/share/gtk-doc"],
        "sources": [
          {
            "type": "file",
            "only-arches": ["aarch64"],
            "url": "https://github.com/rustdesk/rustdesk/releases/download/nightly/rustdesk-1.2.4-aarch64.deb",
            "sha256": "2062bacfcc33d61cdf7efa29b99174e4a177a80f55670b415bd07098ce65a2c6",
            "x-checker-data": {
              "type": "anitya",
              "project-id": "309593",
              "url-template": "https://github.com/rustdesk/rustdesk/releases/download/nightly/rustdesk-$version-aarch64.tar.gz"
            }
          },
          {
            "type": "file",
            "only-arches": ["x86_64"],
            "url": "https://github.com/rustdesk/rustdesk/releases/download/nightly/rustdesk-1.2.4-x86_64.deb",
            "sha256": "fa6b855826a35a2f96f6546f9036aab13db68f48bbcecd07c85d852cfb1118cb",
            "x-checker-data": {
              "type": "anitya",
              "project-id": "309593",
              "url-template": "https://github.com/rustdesk/rustdesk/releases/download/nightly/rustdesk-$version-x86_64.tar.gz"
            }
          }
        ]
      }
    ],
    "finish-args": [
      "--share=ipc",
      "--socket=x11",
      "--socket=fallback-x11",
      "--socket=wayland",
      "--share=network",
      "--filesystem=home",
      "--device=dri",
      "--socket=pulseaudio",
      "--talk-name=org.freedesktop.Flatpak"
    ]
  }
  