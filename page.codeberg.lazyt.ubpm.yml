app-id: page.codeberg.lazyt.ubpm
runtime: org.kde.Platform
runtime-version: '6.5'
sdk: org.kde.Sdk
command: ubpm
rename-desktop-file: ubpm.desktop
rename-icon: ubpm
finish-args:
  - --socket=x11
# wayland fails to open default browser?
#  - --socket=wayland
#  - --socket=fallback-x11
  - --socket=cups
  - --device=dri
  - --share=ipc
  - --share=network
  - --allow=bluetooth
  - --system-talk-name=org.bluez
  - --filesystem=home
modules:
  - name: ubpm
    buildsystem: qmake
    subdir: sources
    no-make-install: true
    build-commands:
      - install -d $FLATPAK_DEST/bin $FLATPAK_DEST/share/icons/hicolor/256x256/apps $FLATPAK_DEST/share/applications $FLATPAK_DEST/share/metainfo $FLATPAK_DEST/bin/Guides $FLATPAK_DEST/bin/Languages $FLATPAK_DEST/bin/Plugins $FLATPAK_DEST/bin/Themes
      - cp mainapp/ubpm $FLATPAK_DEST/bin
      - cp mainapp/res/ico/ubpm.png $FLATPAK_DEST/share/icons/hicolor/256x256/apps
      - cp ../release/appbundle/lin/ubpm.desktop $FLATPAK_DEST/share/applications
      - cp ../release/appbundle/lin/$FLATPAK_ID.appdata.xml $FLATPAK_DEST/share/metainfo
      - cp mainapp/hlp/*.q* $FLATPAK_DEST/bin/Guides
      - cp mainapp/lng/mainapp_*.qm plugins/shared/plugin/lng/plugins_*.qm $FLATPAK_DEST/bin/Languages
      - cp plugins/*.so $FLATPAK_DEST/bin/Plugins
      - cp mainapp/qss/*.qss $FLATPAK_DEST/bin/Themes
      - touch $FLATPAK_DEST/bin/.ubpm.flatpak
    sources:
      - type: git
        url: https://codeberg.org/lazyt/ubpm.git
        commit: 4cd4773456b4880b4921717afef89c62b5c13c68
