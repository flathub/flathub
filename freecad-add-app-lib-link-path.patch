From 706581fb357d7561fe686952d25b5d073a429c0e Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@hadess.net>
Date: Mon, 10 Sep 2018 16:52:39 +0200
Subject: [PATCH 1/4] Fix mpi.h not being found if not in the include path

s/OPENMPI_INCLUDE_DIRS/OPENMPI_INCLUDEDIR/
---
 CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 7e0a43aa9..b5e263c21 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -735,7 +735,7 @@ endif()
                 add_compile_options(${OPENMPI_CFLAGS})
                 link_directories(${OPENMPI_LIBRARY_DIRS})
                 link_libraries(${OPENMPI_LIBRARIES})
-                find_file(MpidotH mpi.h PATHS ${OPENMPI_INCLUDE_DIRS} NO_DEFAULT_PATH)
+                find_file(MpidotH mpi.h PATHS ${OPENMPI_INCLUDEDIR} NO_DEFAULT_PATH)
                 if(NOT MpidotH)
                     message( WARNING "mpi.h was not found. Check for error above.")
                 endif()
-- 
2.17.1


From cfd84b0e31e8e9fa7c615586f19a72739a7ea9db Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@hadess.net>
Date: Mon, 10 Sep 2018 16:55:06 +0200
Subject: [PATCH 2/4] salomesmesh: Add /app/lib to the library dirs

---
 src/3rdParty/salomesmesh/CMakeLists.txt | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/3rdParty/salomesmesh/CMakeLists.txt b/src/3rdParty/salomesmesh/CMakeLists.txt
index 303ae6e0a..c23ad1591 100644
--- a/src/3rdParty/salomesmesh/CMakeLists.txt
+++ b/src/3rdParty/salomesmesh/CMakeLists.txt
@@ -41,7 +41,7 @@ include_directories(
     ${MEDFILE_INCLUDE_DIRS}
     ${BOOST_INCLUDE_DIR}
 )
-link_directories(${OCC_LIBRARY_DIR})
+link_directories(${OCC_LIBRARY_DIR} /app/lib)
 
 if(MSVC)
     if(BUILD_FEM_NETGEN)
@@ -88,12 +88,14 @@ else(MSVC)
             ${NGLIB_LIBRARIES}
             ${OCC_LIBRARIES}
             ${OCC_OCAF_LIBRARIES}
+            -L/app/lib ${OPENMPI_LIBRARIES}
         )
         ADD_DEFINITIONS(${NETGEN_DEFINITIONS})
     else(BUILD_FEM_NETGEN)
         set(SMESH_LIBS
             ${OCC_LIBRARIES}
             ${OCC_OCAF_LIBRARIES}
+            -L/app/lib ${OPENMPI_LIBRARIES}
         )
     endif(BUILD_FEM_NETGEN)
 endif(MSVC)
-- 
2.17.1


From 444eb10bc27b8633c179bf7b21107d174630f4ce Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@hadess.net>
Date: Mon, 10 Sep 2018 17:19:09 +0200
Subject: [PATCH 3/4] Base: Add /app/lib to the library dirs

---
 src/Base/CMakeLists.txt | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/Base/CMakeLists.txt b/src/Base/CMakeLists.txt
index 2bbf76288..2925b8ae2 100644
--- a/src/Base/CMakeLists.txt
+++ b/src/Base/CMakeLists.txt
@@ -55,8 +55,9 @@ else(MSVC)
     set(FreeCADBase_LIBS
         ${PYTHON_LIBRARIES}
         ${XercesC_LIBRARIES}
-        ${Boost_LIBRARIES}
+        -L/app/lib ${Boost_LIBRARIES}
         ${ZLIB_LIBRARIES}
+        -L/app/lib ${OPENMPI_LIBRARIES}
     )
 endif(MSVC)
 
-- 
2.17.1


From 4ff42560b3f0dd1325420e902ea5809fa6861b17 Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@hadess.net>
Date: Mon, 10 Sep 2018 18:16:14 +0200
Subject: [PATCH 4/4] Mod/Path/libarea: Add /app/lib to the library dirs

---
 src/Mod/Path/libarea/CMakeLists.txt | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/Mod/Path/libarea/CMakeLists.txt b/src/Mod/Path/libarea/CMakeLists.txt
index 3084693f9..94902db1d 100644
--- a/src/Mod/Path/libarea/CMakeLists.txt
+++ b/src/Mod/Path/libarea/CMakeLists.txt
@@ -133,10 +133,12 @@ elseif(MINGW)
     )
 else(MSVC)
     set(area_native_LIBS
+        -L/app/lib ${OPENMPI_LIBRARIES}
         )
     set(area_LIBS
         ${Boost_LIBRARIES}
         ${PYTHON_LIBRARIES}
+        -L/app/lib ${OPENMPI_LIBRARIES}
     )
 endif(MSVC)
 
-- 
2.17.1

