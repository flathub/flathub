id: io.github.georgewoodall82.jsymphonic
runtime: org.freedesktop.Platform
runtime-version: '23.08'
finish-args:
  - --socket=x11
  - --share=ipc
  - --filesystem=host
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.openjdk21
build-options:
  build-args:
    - --share=network
command: jsymphonic
modules:
  - name: jsymphonic
    buildsystem: simple
    build-commands:
      - mkdir mh
      - JAVA_HOME=/usr/lib/sdk/openjdk21 /usr/lib/sdk/openjdk21/bin/mvn -Dmaven.repo.local=./mh install:install-file -Dfile=./jars/jaudiotagger.jar -DgroupId=org -DartifactId=jaudiotagger -Dversion=1.0 -Dpackaging=jar
      - JAVA_HOME=/usr/lib/sdk/openjdk21 /usr/lib/sdk/openjdk21/bin/mvn -Dmaven.repo.local=./mh install:install-file -Dfile=./jars/swing-layout.jar -DgroupId=org.jdesktop.layout -DartifactId=swing-layout -Dversion=1.0 -Dpackaging=jar
      - JAVA_HOME=/usr/lib/sdk/openjdk21 /usr/lib/sdk/openjdk21/bin/mvn -Dmaven.repo.local=./mh package
      - install -D ./target/jsymphonic-0.4-jar-with-dependencies.jar /app/jsymphonic/jsymphonic.jar
      - /usr/lib/sdk/openjdk21/install.sh
      - install -Dm644 ${FLATPAK_ID}.metainfo.xml /app/share/metainfo/${FLATPAK_ID}.metainfo.xml
      - install -D ${FLATPAK_ID}.png /app/share/icons/hicolor/512x512/apps/${FLATPAK_ID}.png
      - install -D ${FLATPAK_ID}.desktop /app/share/applications/${FLATPAK_ID}.desktop
      - install -Dm755 jsymphonic.sh /app/bin/jsymphonic
    sources:
      - type: script
        dest-filename: jsymphonic.sh
        commands:
          - /app/jre/bin/java -jar /app/jsymphonic/jsymphonic.jar
      - type: git
        url: https://github.com/georgewoodall82/jsymphonic.git
        tag: 0.4.2