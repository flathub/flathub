app-id: io.openrct2.OpenRCT2
runtime: org.freedesktop.Platform
runtime-version: '19.08'
sdk: org.freedesktop.Sdk
command: openrct2
rename-appdata-file: openrct2.appdata.xml
rename-desktop-file: openrct2.desktop
rename-icon: openrct2
copy-icon: true
finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=fallback-x11
  # Wayland access
  - --socket=wayland
  # Pulseaudio access
  - --socket=pulseaudio
  # Filesystem access - for game files
  - --filesystem=home:ro
  # Network access - for multiplayer
  - --share=network
  # OpenGL access
  - --device=dri
modules:
  - shared-modules/SDL/SDL-1.2.15.json
  - shared-modules/SDL/SDL_ttf-2.0.11.json

  - name: libzip
    buildsystem: cmake
    sources:
      - type: archive
        url: https://libzip.org/download/libzip-1.7.3.tar.gz
        sha256: 0e2276c550c5a310d4ebf3a2c3dfc43fb3b4602a072ff625842ad4f3238cb9cc

  - name: Jansson
    buildsystem: autotools
    sources:
      - type: archive
        url: https://digip.org/jansson/releases/jansson-2.13.1.tar.gz
        sha256: f4f377da17b10201a60c1108613e78ee15df6b12016b116b6de42209f47a474f

  - name: SpeexDSP
    buildsystem: autotools
    sources:
      - type: git
        url: https://github.com/xiph/speexdsp.git
        tag: SpeexDSP-1.2.0
        commit: 64cbfa9bca7479a758351aa02bb4abdd76baa9e7

  - name: OpenRCT2
    buildsystem: cmake
    builddir: true
    config-opts:
      - "-DDOWNLOAD_OBJECTS=OFF"
      - "-DDOWNLOAD_TITLE_SEQUENCES=OFF"
    sources:
      - type: git
        url: https://github.com/OpenRCT2/OpenRCT2.git
        tag: v0.2.6
        commit: 6c3c857dfa5cd0d267b89a9d70930fbacdfbaea4
      - type: archive
        url: https://github.com/OpenRCT2/title-sequences/releases/download/v0.1.2c/title-sequences.zip
        dest: data/title
        strip-components: 0
        sha256: 5284333fa501270835b5f0cf420cb52155742335f5658d7889ea35d136b52517
      - type: archive
        url: https://github.com/OpenRCT2/objects/releases/download/v1.0.15/objects.zip
        dest: data/object
        strip-components: 0
        sha256: 0171907a267c564071e587fc683bfe75f36b891a6769e0bd49a6fc46f2ae7ded
      - type: patch
        path: no-lstdcxxfs.patch
      - type: patch
        path: appdata-releases.patch

cleanup:
  - /include
  - /lib/pkgconfig
  - /share/man
  - /share/cmake
  - *.a
  - '*.la'
