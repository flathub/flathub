app-id: so.onekey.wallet
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
base: org.electronjs.Electron2.BaseApp
base-version: '23.08'
command: onekey-wallet
separate-locales: false

finish-args:
  - --share=ipc
  - --share=network
  - --socket=x11
  - --socket=wayland
  - --socket=pcsc
  - --socket=pulseaudio
  - --device=all
  - --talk-name=org.freedesktop.Notifications
  - --env=ELECTRON_DISABLE_SECURITY_WARNINGS=1

modules:
  - name: onekey-desktop
    buildsystem: simple
    sources:
      - type: extra-data
        only-arches: [x86_64]
        url: https://github.com/OneKeyHQ/app-monorepo/releases/download/v5.18.0/OneKey-Wallet-5.18.0-linux-x86_64.AppImage
        sha256: 583da5ef2d750401b88a4d204f3efc00ffd4f927d15036ee96fd7e82d346a214
        size: 189399614
        filename: OneKey-Wallet.AppImage
      - type: extra-data
        only-arches: [aarch64]
        url: https://github.com/OneKeyHQ/app-monorepo/releases/download/v5.18.0/OneKey-Wallet-5.18.0-linux-arm64.AppImage
        sha256: 2913650664e0cce5ea25b534573a30b8e369c305c3bcb799bece6ca7e1de7821
        size: 189596808
        filename: OneKey-Wallet.AppImage
      - type: file
        path: onekey-wallet.sh
      - type: file
        path: so.onekey.wallet.desktop
      - type: file
        path: so.onekey.wallet.metainfo.xml
      - type: file
        path: icons/so.onekey.wallet.png
      - type: file
        path: apply_extra.sh
    build-commands:
      - install -Dm755 apply_extra.sh "${FLATPAK_DEST}/bin/apply_extra"
      - install -Dm755 onekey-wallet.sh "${FLATPAK_DEST}/bin/onekey-wallet"
      - install -Dm644 so.onekey.wallet.desktop "${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.desktop"
      - install -Dm644 so.onekey.wallet.metainfo.xml "${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml"
      - install -Dm644 icons/so.onekey.wallet.png "${FLATPAK_DEST}/share/icons/hicolor/512x512/apps/${FLATPAK_ID}.png"
