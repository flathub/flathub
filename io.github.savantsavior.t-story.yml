id: io.github.savantsavior.t-story
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
base: org.godotengine.godot.BaseApp
base-version: '4.5'
command: godot-runner

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --socket=pulseaudio
  - --device=all
  - --share=network

modules:
  - name: t-story
    buildsystem: simple

    sources:
      # Desktop Entry file from GitHub
      - type: file
        url: https://raw.githubusercontent.com/savantsavior/t-story/88cfa2f8c4ce879660ded10ee8d961ef8cb2cabd/io.github.savantsavior.t-story.desktop
        sha256: 6863cfadbc5c1e97520b968b5120278c2c7b0b99c2729acfe743e7e80645e98c

      # MetaInfo file from GitHub
      - type: file
        url: https://raw.githubusercontent.com/savantsavior/t-story/88cfa2f8c4ce879660ded10ee8d961ef8cb2cabd/io.github.savantsavior.t-story.metainfo.xml
        sha256: 7d6fe5822753fb4a6b9a65ba400f8d163a303b8656f54381226647eba8c3f228

      # Icon file from GitHub
      - type: file
        url: https://raw.githubusercontent.com/savantsavior/t-story/88cfa2f8c4ce879660ded10ee8d961ef8cb2cabd/io.github.savantsavior.t-story.png
        sha256: f30f0fe26859ebf5f8e8cde60522fce25fac1856db05b0b48ca76fab7e76728f

      # Game PCK file from GitHub
      - type: file
        url: https://raw.githubusercontent.com/savantsavior/t-story/88cfa2f8c4ce879660ded10ee8d961ef8cb2cabd/T-Story-R3B2-Linux.pck
        sha256: 4b27855a6a58e92fea3c2859ae06d8abeb10f18d0991ddb7737d95299a1c725f

    build-commands:
      # Install the PCK file with the godot-runner name
      - install -Dm644 T-Story-R3B2-Linux.pck ${FLATPAK_DEST}/bin/godot-runner.pck

      # Install Desktop Entry
      - install -Dm644 ${FLATPAK_ID}.desktop ${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.desktop

      # Install MetaInfo
      - install -Dm644 ${FLATPAK_ID}.metainfo.xml ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml

      # Install icon
      - install -Dm644 ${FLATPAK_ID}.png ${FLATPAK_DEST}/share/icons/hicolor/256x256/apps/${FLATPAK_ID}.png
