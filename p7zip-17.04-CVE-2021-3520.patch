diff -upr p7zip-17.04.org/C/lz4/lz4.c p7zip-17.04/C/lz4/lz4.c
--- p7zip-17.04.org/C/lz4/lz4.c	2021-04-04 05:11:06.000000000 +0200
+++ p7zip-17.04/C/lz4/lz4.c	2021-09-19 15:43:44.358989464 +0200
@@ -1749,7 +1749,7 @@ LZ4_decompress_generic(
                  const size_t dictSize         /* note : = 0 if noDict */
                  )
 {
-    if (src == NULL) { return -1; }
+    if ((src == NULL) || (outputSize < 0)) { return -1; }
 
     {   const BYTE* ip = (const BYTE*) src;
         const BYTE* const iend = ip + srcSize;
