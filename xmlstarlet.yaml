name: xmlstarlet
config-opts:
  - --disable-static-libs
  - --with-libxml-libs-prefix=/usr/lib
  - --with-libxml-include-prefix=/usr/include/libxml2
  # We don't need it after complete build
  - --prefix=/app/opt/xmlstarlet
  - --exec-prefix=/app/opt/xmlstarlet
sources:
  # Source0
  - type: archive
    url: http://downloads.sourceforge.net/xmlstar/xmlstarlet-1.6.1.tar.gz
    sha256: 15d838c4f3375332fd95554619179b69e4ec91418a3a5296e7c631b7ed19e7ca
  # Patch0
  # https://sourceforge.net/p/xmlstar/bugs/109/
  - type: patch
    path: xmlstarlet-1.6.1-nogit.patch
    strip-components: 1
    sha256: c54485c5e2bd038219884250228333113a9751e999baa28a833a679f79421890
  - type: patch
    path: xmlstarlet-1.6.1-pkg-config.patch
    strip-components: 1
    sha256: e89019f1e9da772245cb2dfba5e24c96878ba055822520bd4d66a33deeb3ac00
  - type: patch
    path: xmlstarlet-1.6.1-deps.patch
    strip-components: 1
    sha256: b182fa395d3bf9b2777446db1ada35abd77bd7d1ef59823cde38c5b0c2f68267
  - type: shell
    commands:
      - cp -p /usr/share/automake-*/config.{sub,guess} .;
      - autoreconf -i;
post-install:
  - ln -s 'xml' '/app/opt/xmlstarlet/bin/xmlstarlet' ||:;
