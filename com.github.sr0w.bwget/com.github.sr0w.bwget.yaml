app-id:      com.github.sr0w.bwget
runtime:     org.freedesktop.Platform
runtime-version: '23.08'
sdk:         org.freedesktop.Sdk

build-options:
  build-args:
    - --share=network            # needed so pip can reach PyPI
  append-path: /app/bin
  env:
    PYTHONUSERBASE: /app

command: bwget

modules:
  - name: bwget
    buildsystem: simple
    build-commands:
      # 1. install Python deps
      - pip3 install --no-cache-dir --no-warn-script-location --user \
          requests rich tomli
      # 2. normalise the script to LF endings
      - sed -i 's/\r$//' bwget-0.3.2.py
      # 3. install it as an executable
      - install -Dm755 bwget-0.3.2.py /app/bin/bwget
    sources:
      - type: git
        url: https://github.com/Sr-0w/bwget.git
        branch: master

finish-args:
  - --share=network
  - --filesystem=home
