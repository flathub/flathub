{
  "app-id": "io.github.parsemonkey.PersonalHistoryTimeline",
  "runtime": "org.freedesktop.Platform",
  "runtime-version": "23.08",
  "sdk": "org.freedesktop.Sdk",
  "command": "personal-history-timeline",
  "separate-locales": false,
  "finish-args": [
    "--share=ipc",
    "--socket=x11",
    "--socket=wayland",
    "--device=dri",
    "--filesystem=home",
    "--filesystem=xdg-documents",
    "--filesystem=xdg-download",
    "--talk-name=org.freedesktop.FileManager1",
    "--talk-name=org.freedesktop.Notifications"
  ],
  "modules": [
    {
      "name": "personal-history-timeline",
      "buildsystem": "simple",
      "sources": [
        {
          "type": "extra-data",
          "filename": "Personal_History_Timeline_v1.0.flatpak",
          "url": "https://github.com/parsemonkey/PersonalHistoryTimeline/releases/download/v1.0/Personal_History_Timeline_v1.0.flatpak",
          "sha256": "49567c4f501877d19a020f15470351a45d343c4dec09f4baac7a4be650021895",
          "size": 174919480
        },
        {
          "type": "file",
          "path": "io.github.parsemonkey.PersonalHistoryTimeline.desktop"
        },
        {
          "type": "file",
          "path": "io.github.parsemonkey.PersonalHistoryTimeline.metainfo.xml"
        },
        {
          "type": "file",
          "path": "timeline.png",
          "dest-filename": "io.github.parsemonkey.PersonalHistoryTimeline.png"
        }
      ],
      "build-commands": [
        "# Extract the pre-built Flatpak bundle",
        "mkdir -p /tmp/flatpak-extract",
        "cd /tmp/flatpak-extract",
        "ar x /run/build/personal-history-timeline/Personal_History_Timeline_v1.0.flatpak",
        "tar -xf data.tar.gz",
        "",
        "# Install the application files",
        "mkdir -p /app/bin",
        "mkdir -p /app/lib/python3.11/site-packages",
        "mkdir -p /app/share/applications",
        "mkdir -p /app/share/metainfo",
        "mkdir -p /app/share/icons/hicolor/512x512/apps",
        "mkdir -p /app/share/PersonalHistoryTimeline",
        "",
        "# Copy application files from extracted bundle",
        "if [ -d files/bin ]; then cp -r files/bin/* /app/bin/; fi",
        "if [ -d files/lib ]; then cp -r files/lib/* /app/lib/; fi",
        "if [ -d files/share/PersonalHistoryTimeline ]; then cp -r files/share/PersonalHistoryTimeline/* /app/share/PersonalHistoryTimeline/; fi",
        "",
        "# Install metadata files",
        "install -Dm644 /run/build/personal-history-timeline/io.github.parsemonkey.PersonalHistoryTimeline.desktop /app/share/applications/io.github.parsemonkey.PersonalHistoryTimeline.desktop",
        "install -Dm644 /run/build/personal-history-timeline/io.github.parsemonkey.PersonalHistoryTimeline.metainfo.xml /app/share/metainfo/io.github.parsemonkey.PersonalHistoryTimeline.metainfo.xml",
        "install -Dm644 /run/build/personal-history-timeline/io.github.parsemonkey.PersonalHistoryTimeline.png /app/share/icons/hicolor/512x512/apps/io.github.parsemonkey.PersonalHistoryTimeline.png",
        "",
        "# Ensure launcher script is executable",
        "chmod +x /app/bin/personal-history-timeline",
        "",
        "# Create any missing directories for user data",
        "mkdir -p /app/share/PersonalHistoryTimeline/sample_data"
      ]
    }
  ]
}
