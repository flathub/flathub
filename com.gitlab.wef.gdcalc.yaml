app-id: com.gitlab.wef.gdcalc
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
command: gdcalc
rename-icon: gdcalc
copy-icon: true
finish-args:
  - --device=dri
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --socket=x11
cleanup:
  - /include
  - /lib/pkgconfig
modules:
  - name: gdcalc
    post-install:
      - install -Dm644 gdcalc.glade -t ${FLATPAK_DEST}/share/gdcalc/
      - install -Dm644 gdcalc.css -t ${FLATPAK_DEST}/etc/gdcalc/
      - install -Dm644 pixmaps/HP-16C-48.png ${FLATPAK_DEST}/share/icons/hicolor/48x48/apps/gdcalc.png
      - install -Dm644 gdcalc.desktop ${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.desktop
      - install -Dm644 ${FLATPAK_ID}.metainfo.xml -t ${FLATPAK_DEST}/share/metainfo/
    sources:
      - type: archive
        url: https://gitlab.com/wef/gdcalc/-/archive/3.1/gdcalc-3.1.tar.gz
        sha256: 0a45ac5de54ce5a1da3c4231b6c06890d93dc3f37230a01bd2b17ff100ca09c3
        x-checker-data:
          type: anitya
          project-id: 236225
          stable-only: true
          url-template: https://gitlab.com/wef/gdcalc/-/archive/$version/gdcalc-$version.tar.gz
      - type: file
        path: com.gitlab.wef.gdcalc.metainfo.xml
      - type: shell
        commands:
          - sed -i 's#/etc/gdcalc#/app/etc/gdcalc#' src/main.c
    modules:
      - ncurses/libncurses.json
