{
  "name": "xvfb",
  "buildsystem": "meson",
  "build-options": {
    "prepend-path": "/app/build_staging/xvfb/bin",
    "prepend-ld-library-path": "/app/build_staging/xvfb/lib",
    "prepend-pkg-config-path": "/app/build_staging/xvfb/lib/pkgconfig",
    "env": {
      "LPATH": "/app/build_staging/xvfb/lib"
    }
  },
  "config-opts": [
    "--prefix=/app/build_staging/xvfb",
    "-Dxorg=true",
    "-Dxvfb=true",
    "-Dhal=false",
    "-Dxwayland=false"
  ],
  "sources": [
    {
      "type": "git",
      "url": "https://gitlab.freedesktop.org/xorg/xserver.git",
      "commit": "7515c23a416825f0db51f9b445279b12d5918ebf"
    },
    {
      "type": "file",
      "path": "xvfb-run"
    }
  ],
  "post-install": [
    "install -c -m 755 ${FLATPAK_BUILDER_BUILDDIR}/xvfb-run /app/build_staging/xvfb/bin/xvfb-run"
  ],
  "modules": [
    {
      "name": "xvfb-libXmu",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://xorg.freedesktop.org/archive/individual/lib/libXmu-1.1.3.tar.gz",
          "sha256": "5bd9d4ed1ceaac9ea023d86bf1c1632cd3b172dce4a193a72a94e1d9df87a62e"
        }
      ]
    },
    {
      "name": "xvfb-libfontenc",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://xorg.freedesktop.org/archive/individual/lib/libfontenc-1.1.4.tar.bz2",
          "sha256": "2cfcce810ddd48f2e5dc658d28c1808e86dcf303eaff16728b9aa3dbc0092079"
        }
      ]
    },
    {
      "name": "xvfb-libtirpc",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb --disable-gssapi",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://downloads.sourceforge.net/sourceforge/libtirpc/libtirpc-1.3.2.tar.bz2",
          "sha256": "e24eb88b8ce7db3b7ca6eb80115dd1284abc5ec32a8deccfed2224fc2532b9fd"
        }
      ]
    },
    {
      "name": "xvfb-font-util",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://xorg.freedesktop.org/archive/individual/font/font-util-1.3.2.tar.bz2",
          "sha256": "3ad880444123ac06a7238546fa38a2a6ad7f7e0cc3614de7e103863616522282"
        }
      ]
    },
    {
      "name": "xvfb-libXfont2",
      "buildsystem": "simple",
      "build-options": {
        "prepend-path": "/app/build_staging/xvfb/bin",
        "prepend-ld-library-path": "/app/build_staging/xvfb/lib",
        "prepend-pkg-config-path": "/app/build_staging/xvfb/lib/pkgconfig"
      },
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://xorg.freedesktop.org/archive/individual/lib/libXfont2-2.0.4.tar.bz2",
          "sha256": "6d151b3368e5035efede4b6264c0fdc6662c1c99dbc2de425e3480cababc69e6"
        }
      ]
    },    
    {
      "name": "xvfb-xauth",
      "buildsystem": "simple",
      "build-options": {
        "prepend-path": "/app/build_staging/xvfb/bin",
        "prepend-ld-library-path": "/app/build_staging/xvfb/lib",
        "prepend-pkg-config-path": "/app/build_staging/xvfb/lib/pkgconfig"
      },
      "build-commands": [
        "./autogen.sh --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://gitlab.freedesktop.org/xorg/app/xauth.git",
          "commit": "18a3c3a7672ff5d65bf0b79b89464eac7540b95b"
        }
      ]
    }
  ]
}
