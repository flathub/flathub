id: com.obsproject.Studio.Plugin.DroidCam
branch: stable
runtime: com.obsproject.Studio
runtime-version: stable
sdk: org.kde.Sdk//6.3
build-extension: true
separate-locales: false
appstream-compose: false
build-options:
  prefix: /app/plugins/DroidCam

modules:
  - name: droidcam
    buildsystem: simple
    build-commands:
      - mkdir -p  ${FLATPAK_DEST}/data/obs-plugins/droidcam-obs
      - mv data/* ${FLATPAK_DEST}/data/obs-plugins/droidcam-obs
      - mkdir -p ${FLATPAK_DEST}/obs-plugins/
      - mv bin/* ${FLATPAK_DEST}/obs-plugins/
    sources:
      - type: file
        path: com.obsproject.Studio.Plugin.DroidCam.metainfo.xml

      - type: archive
        url: "https://github.com/dev47apps/droidcam-obs-plugin/releases/download/2.1.0/droidcam_obs_2.1.0_linux_ffmpeg5.zip"
        sha1: e190bfa277d89bc02eacb41e3a4e155f912d19b3

    post-install:
      - install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo ${FLATPAK_ID}.metainfo.xml
      - appstream-compose --basename=${FLATPAK_ID} --prefix=${FLATPAK_DEST} --origin=flatpak ${FLATPAK_ID}
