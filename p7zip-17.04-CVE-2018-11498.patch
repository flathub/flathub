diff -upr p7zip-17.04.org/C/lizard/lizard_decompress_liz.h p7zip-17.04/C/lizard/lizard_decompress_liz.h
--- p7zip-17.04.org/C/lizard/lizard_decompress_liz.h	2021-04-04 05:11:06.000000000 +0200
+++ p7zip-17.04/C/lizard/lizard_decompress_liz.h	2021-09-19 15:39:08.526133775 +0200
@@ -203,7 +203,7 @@ FORCE_INLINE int Lizard_decompress_LIZv1
     /* last literals */
     length = ctx->literalsEnd - ctx->literalsPtr;
     cpy = op + length;
-    if ((ctx->literalsPtr+length != iend) || (cpy > oend)) { LIZARD_LOG_DECOMPRESS_LIZv1("14"); goto _output_error; }   /* Error : input must be consumed */
+    if ((length < 0) || (ctx->literalsPtr+length != iend) || (cpy > oend)) { LIZARD_LOG_DECOMPRESS_LIZv1("14"); goto _output_error; }   /* Error : input must be consumed */
     memcpy(op, ctx->literalsPtr, length);
     ctx->literalsPtr += length;
     op += length;
diff -upr p7zip-17.04.org/C/lizard/lizard_decompress_lz4.h p7zip-17.04/C/lizard/lizard_decompress_lz4.h
--- p7zip-17.04.org/C/lizard/lizard_decompress_lz4.h	2021-04-04 05:11:06.000000000 +0200
+++ p7zip-17.04/C/lizard/lizard_decompress_lz4.h	2021-09-19 15:39:27.020342882 +0200
@@ -147,7 +147,7 @@ FORCE_INLINE int Lizard_decompress_LZ4(
     /* last literals */
     length = ctx->literalsEnd - ctx->literalsPtr;
     cpy = op + length;
-    if ((ctx->literalsPtr+length != iend) || (cpy > oend)) { LIZARD_LOG_DECOMPRESS_LZ4("9"); goto _output_error; }   /* Error : input must be consumed */
+    if ((length < 0) || (ctx->literalsPtr+length != iend) || (cpy > oend)) { LIZARD_LOG_DECOMPRESS_LZ4("9"); goto _output_error; }   /* Error : input must be consumed */
     memcpy(op, ctx->literalsPtr, length);
     ctx->literalsPtr += length;
     op += length;
