---
app-id: org.laborejo.laborejo
runtime: org.kde.Platform
runtime-version: '5.15'
sdk: org.kde.Sdk
command: laborejo
rename-icon: laborejo
finish-args:
  - --device=all
  - --filesystem=home
  - --filesystem=xdg-run/pipewire-0:ro
  - --share=ipc
  - --share=network
  - --socket=pulseaudio
  - --socket=system-bus
  - --socket=x11
  - --socket=wayland

modules:
  - name: toml
    buildsystem: simple
    build-commands:
      - python3 setup.py install --prefix=/app --root=/
    sources:
      - type: archive
        url: https://files.pythonhosted.org/packages/da/24/84d5c108e818ca294efe7c1ce237b42118643ce58a14d2462b3b2e3800d5/toml-0.10.1.tar.gz
        sha256: 926b612be1e5ce0634a2ca03470f95169cf16f939018233a670519cb4ac58b0f

  - name: packaging
    buildsystem: simple
    build-commands:
      - python3 setup.py install --prefix=/app --root=/
    sources:
      - type: archive
        url: https://files.pythonhosted.org/packages/55/fd/fc1aca9cf51ed2f2c11748fa797370027babd82f87829c7a8e6dbe720145/packaging-20.4.tar.gz
        sha256: 4357f74f47b9c12db93624a82154e9b120fa8293699949152b22065d556079f8

  - name: pyparsing
    buildsystem: simple
    build-commands:
      - python3 setup.py install --prefix=/app --root=/
    sources:
      - type: archive
        url: https://files.pythonhosted.org/packages/c1/47/dfc9c342c9842bbe0036c7f763d2d6686bcf5eb1808ba3e170afdb282210/pyparsing-2.4.7.tar.gz
        sha256: c203ec8783bf771a155b207279b9bccb8dea02d8f0c9e5f8ead507bc3246ecc1

  - name: sip
    buildsystem: simple
    build-commands:
      - python3 setup.py install --prefix=/app --root=/
    cleanup:
      - /bin
    sources:
      - type: archive
        url: https://files.pythonhosted.org/packages/af/68/c603a9d6319ef1126187c42e0b13ac5fcf556d040feded2e574e1a6a27e4/sip-5.4.0.tar.gz
        sha256: 4282ab45948674f5ef74278a8e70d1302f65c95b519a0af19409002f5715d641

  - name: PyQt5_sip
    buildsystem: simple
    build-commands:
      - python3 setup.py install --prefix=/app --root=/
    sources:
      - type: archive
        url: https://files.pythonhosted.org/packages/73/8c/c662b7ebc4b2407d8679da68e11c2a2eb275f5f2242a92610f6e5024c1f2/PyQt5_sip-12.8.1.tar.gz
        sha256: 30e944db9abee9cc757aea16906d4198129558533eb7fadbe48c5da2bd18e0bd

  - name: PyQt5
    buildsystem: simple
    build-commands:
      - QMAKEPATH=/app/lib python3 configure.py
        --confirm-license
        --bindir=/app/bin
        --destdir=/app/lib/python3.8/site-packages
        --designer-plugindir=/app/lib/plugins/designer
        --qml-plugindir=/app/lib/plugins/PyQt5
        --sipdir=/app/share/sip
        --stubsdir=/app/lib/python3.8/site-packages/PyQt5
      - make -j $FLATPAK_BUILDER_N_JOBS
      - make install
    cleanup:
      - /bin
    sources:
      - type: archive
        url: https://files.pythonhosted.org/packages/28/6c/640e3f5c734c296a7193079a86842a789edb7988dca39eab44579088a1d1/PyQt5-5.15.2.tar.gz
        sha256: 372b08dc9321d1201e4690182697c5e7ffb2e0770e6b4a45519025134b12e4fc

  - name: jack2
    buildsystem: simple
    build-commands:
      - python3 waf configure --prefix=/app
      - python3 waf build
      - python3 waf install
    sources:
      - type: archive
        url: https://github.com/jackaudio/jack2/archive/v1.9.16.tar.gz
        sha256: e176d04de94dcaa3f9d32ca1825091e1b938783a78c84e7466abd06af7637d37
    cleanup:
      - '*'

  - name: Laborejo
    buildsystem: autotools
    config-opts:
      - --prefix=/app
    sources:
      - type: archive
        url: https://laborejo.org/downloads/laborejo-2.0.1.tar.gz
        sha256: ebdca70841742d138e11bbb885cea86b3fac66520c91c8645da2bb4ef40e75b5

  - name: appdata
    buildsystem: simple
    build-commands:
      - mkdir -p /app/share/metainfo
      - cp org.laborejo.laborejo.appdata.xml /app/share/metainfo
    sources:
    - type: file
      path: org.laborejo.laborejo.appdata.xml

