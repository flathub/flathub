app-id: com.ylsoftware.qmmp.Qmmp
runtime: org.kde.Platform
runtime-version: 6.2
sdk: org.kde.Sdk
command: qmmp
rename-icon: qmmp
rename-desktop-file: qmmp.desktop
rename-appdata-file: qmmp.appdata.xml

finish-args:
  - --share=ipc
  - --share=network
  - --socket=fallback-x11
  - --socket=wayland
  - --socket=pulseaudio
  - --filesystem=xdg-music

cleanup:
  - '*.a'
  - '*.la'
  - /lib/pkgconfig
  - /include
  - /share/man

modules:
  - name: taglib
    buildsystem: cmake-ninja
    config-opts:
      - -DBUILD_SHARED_LIBS=ON
    sources:
      - type: archive
        url: https://github.com/taglib/taglib/releases/download/v1.12/taglib-1.12.tar.gz
        sha256: 7fccd07669a523b07a15bd24c8da1bbb92206cb19e9366c3692af3d79253b703
        x-checker-data:
          type: anitya
          project-id: 1982
          url-template: https://github.com/taglib/taglib/releases/download/v$version/taglib-$version.tar.gz

  - name: libcddb
    buildsystem: autotools
    sources:
      - type: archive
        url: https://prdownloads.sourceforge.net/libcddb/libcddb-1.3.2.tar.bz2
        sha256: 35ce0ee1741ea38def304ddfe84a958901413aa829698357f0bee5bb8f0a223b
        x-checker-data:
          type: anitya
          project-id: 1572
          url-template: https://prdownloads.sourceforge.net/libcddb/libcddb-$version.tar.bz2
      - type: shell
        commands:
          - cp -p /usr/share/automake-*/config.{sub,guess} .

  - name: libcdio
    buildsystem: autotools
    sources:
      - type: archive
        url: https://ftp.gnu.org/gnu/libcdio/libcdio-2.1.0.tar.bz2
        sha256: 8550e9589dbd594bfac93b81ecf129b1dc9d0d51e90f9696f1b2f9b2af32712b
        x-checker-data:
          type: anitya
          project-id: 1573
          stable-only: true
          url-template: https://ftp.gnu.org/gnu/libcdio/libcdio-$version.tar.bz2

  - name: soxr
    buildsystem: cmake-ninja
    sources:
      - type: archive
        url: http://downloads.sourceforge.net/soxr/soxr-0.1.3-Source.tar.xz
        sha256: b111c15fdc8c029989330ff559184198c161100a59312f5dc19ddeb9b5a15889
        x-checker-data:
          type: anitya
          project-id: 4859
          stable-only: true
          url-template: http://downloads.sourceforge.net/soxr/soxr-$version-Source.tar.xz

  - name: libgme
    buildsystem: cmake-ninja
    sources:
      - type: archive
        url: https://bitbucket.org/mpyne/game-music-emu/downloads/game-music-emu-0.6.3.tar.xz
        sha256: aba34e53ef0ec6a34b58b84e28bf8cfbccee6585cebca25333604c35db3e051d
        x-checker-data:
          type: anitya
          project-id: 866
          stable-only: true
          url-template: https://bitbucket.org/mpyne/game-music-emu/downloads/game-music-emu-$version.tar.xz

  - name: wildmidi
    buildsystem: cmake-ninja
    sources:
      - type: archive
        url: https://github.com/Mindwerks/wildmidi/archive/wildmidi-0.4.4.tar.gz
        sha256: 6f267c8d331e9859906837e2c197093fddec31829d2ebf7b958cf6b7ae935430
        x-checker-data:
          type: anitya
          project-id: 9179
          stable-only: true
          url-template: https://github.com/Mindwerks/wildmidi/archive/wildmidi-$version.tar.gz

  - name: libshout
    buildsystem: autotools
    sources:
      - type: archive
        url: https://downloads.xiph.org/releases/libshout/libshout-2.4.6.tar.gz
        sha256: 39cbd4f0efdfddc9755d88217e47f8f2d7108fa767f9d58a2ba26a16d8f7c910
        x-checker-data:
          type: anitya
          project-id: 11084
          stable-only: true
          url-template: https://downloads.xiph.org/releases/libshout/libshout-$version.tar.gz

  - name: libxmp
    buildsystem: autotools
    sources:
      - type: archive
        url: https://github.com/libxmp/libxmp/releases/download/libxmp-4.5.0/libxmp-4.5.0.tar.gz
        sha256: 7847d262112d14e8442f44e5ac6ed9ddbca54c251284720b563c852b31f26e75
        x-checker-data:
          type: anitya
          project-id: 1784
          stable-only: true
          url-template: https://github.com/libxmp/libxmp/releases/download/libxmp-$version/libxmp-$version.tar.gz

  - name: qmmp
    buildsystem: cmake-ninja
    sources:
      - type: archive
        url: https://qmmp.ylsoftware.com/files/qmmp/2.1/qmmp-2.1.0.tar.bz2
        sha256: ac7b5981e371dc58759d5efd2babb42e377ecc5260ba3e57ac6dbf0897570ddc
        x-checker-data:
          type: anitya
          project-id: 4129
          stable-only: true
          url-template: https://qmmp.ylsoftware.com/files/qmmp/$major.$minor/qmmp-$version.tar.bz2
      - type: patch
        path: qmmp.appdata.diff