id: eu.binjr.binjr
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.openjdk25
command: binjr
finish-args:
  - --socket=x11
  - --share=ipc
  - --device=dri
  - --share=network
  - --filesystem=host
  - --talk-name=org.gtk.vfs.*
modules:
  - name: binjr
    buildsystem: simple
    build-commands:
      - source /usr/lib/sdk/openjdk25/enable.sh && export JFX_JMOD_PATH='jfx/jmods'; export REPO_TAG_NAME=v3.27.0-SNAPSHOT; export IS_TAG=true; export USE_BUILD_JDK_IN_BUNDLE=true; gradle clean jpackageLinuxFlatpak --offline --stacktrace
      - cp -ar build/flatpak/* /app/
      - install -Dm644 distribution/bundlers/linux_fpk/icons/binjr_16.png /app/share/icons/hicolor/16x16/apps/eu.binjr.binjr.png
      - install -Dm644 distribution/bundlers/linux_fpk/icons/binjr_32.png /app/share/icons/hicolor/32x32/apps/eu.binjr.binjr.png
      - install -Dm644 distribution/bundlers/linux_fpk/icons/binjr_48.png /app/share/icons/hicolor/48x48/apps/eu.binjr.binjr.png
      - install -Dm644 distribution/bundlers/linux_fpk/icons/binjr_64.png /app/share/icons/hicolor/64x64/apps/eu.binjr.binjr.png
      - install -Dm644 distribution/bundlers/linux_fpk/icons/binjr_128.png /app/share/icons/hicolor/128x128/apps/eu.binjr.binjr.png
      - install -Dm644 distribution/bundlers/linux_fpk/icons/binjr_256.png /app/share/icons/hicolor/256x256/apps/eu.binjr.binjr.png
      - install -Dm644 distribution/bundlers/linux_fpk/icons/binjr_512.png /app/share/icons/hicolor/512x512/apps/eu.binjr.binjr.png
      - install -Dm644 distribution/bundlers/linux_fpk/metadata/eu.binjr.binjr.metainfo.xml /app/share/metainfo/eu.binjr.binjr.metainfo.xml
      - install -Dm644 distribution/bundlers/linux_fpk/metadata/eu.binjr.binjr.mime.xml /app/share/mime/packages/eu.binjr.binjr.mime.xml
      - install -Dm644 distribution/bundlers/linux_fpk/metadata/eu.binjr.binjr.desktop -t /app/share/applications
    sources:
      - type: git
        url: https://github.com/binjr/binjr.git
        commit: b871e96b98ddb42be852a27ee6920b76535ecacb
      - type: archive
        url: https://download2.gluonhq.com/openjfx/25/openjfx-25_linux-x64_bin-jmods.zip
        sha256: 96e520f48610d8ffb94ca30face1f11ffe8a977ddc1c4ff80b1a9e9f048bd94e
        strip-components: 0
        dest: "jfx/jmods/"
        only-arches:
        - x86_64
      - type: archive
        url: https://download2.gluonhq.com/openjfx/25/openjfx-25_linux-aarch64_bin-jmods.zip
        sha256: 9ad4ca7b769ca4ee6419f1e99143dd6ff812f8be4fddb46a7d7cacbeea148af4
        strip-components: 0
        dest: "jfx/jmods/"
        only-arches:
        - aarch64
      - binjr-plugins-sources.json
      - binjr-app-sources.json

