app-id: com.github.scramble45.PigeonHillRangeStatus
runtime: org.kde.Platform
runtime-version: '6.8'
sdk: org.kde.Sdk
command: pigeon-hill-range-status
finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --share=network
  - --device=dri
  - --talk-name=org.freedesktop.Notifications
  - --talk-name=org.kde.StatusNotifierWatcher
  - --talk-name=org.freedesktop.StatusNotifierWatcher
  - --talk-name=org.ayatana.indicator.application
  - --share=ipc
  - --env=QT_QPA_PLATFORM=wayland;xcb

modules:
  - name: pigeon-hill-range-status
    buildsystem: simple
    build-commands:
      # Generate moc file
      - /usr/lib/libexec/moc pigeon-hill-range-status.cpp -o pigeon-hill-range-status.moc
      # Compile the application
      - |
        g++ -std=c++17 -Wall -O2 -fPIC \
          $(pkg-config --cflags Qt6Core Qt6Widgets Qt6Network) \
          -Wl,--no-undefined \
          -o pigeon-hill-range-status \
          pigeon-hill-range-status.cpp \
          $(pkg-config --libs Qt6Core Qt6Widgets Qt6Network)
      # Install files
      - install -D pigeon-hill-range-status /app/bin/pigeon-hill-range-status
      - install -D com.github.scramble45.PigeonHillRangeStatus.desktop /app/share/applications/com.github.scramble45.PigeonHillRangeStatus.desktop
      - install -D com.github.scramble45.PigeonHillRangeStatus.appdata.xml /app/share/metainfo/com.github.scramble45.PigeonHillRangeStatus.appdata.xml
      - install -D com.github.scramble45.PigeonHillRangeStatus.svg /app/share/icons/hicolor/scalable/apps/com.github.scramble45.PigeonHillRangeStatus.svg
    sources:
      - type: archive
        url: https://github.com/scramble45/pigeon-hill-range-status/archive/refs/tags/v1.0.0.tar.gz
        sha256: 45e81ba1e45a7c1f76dcaba32a7aed2edf7e4c4553065cb7efd8150bfddfadc1