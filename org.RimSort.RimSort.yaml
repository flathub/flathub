app-id: org.RimSort.RimSort
runtime: org.kde.Platform
runtime-version: "6.7"
sdk: org.kde.Sdk
base: io.qt.PySide.BaseApp
base-version: "6.7"
cleanup-commands:
  - /app/cleanup-BaseApp.sh
command: RimSort
finish-args:
  - --share=ipc
  - --socket=wayland
  - --socket=fallback-x11
  - --socket=pulseaudio

  # XDG commons folders
  - --filesystem=xdg-download
  - --filesystem=xdg-pictures
  - --filesystem=xdg-videos

  # external disk mount
  - --filesystem=/media
  - --filesystem=/run/media
  - --filesystem=/mnt

  # file chooser
  - --talk-name=org.freedesktop.portal.FileChooser

modules:
  # generate from requirements.txt with python3 flatpak-pip-generator --requirements-file=requirements.txt --output pypi-dependencies
  #
  # maturin
  - maturin.json
  # Python crypto
  - python3-requirements-binaries.json
  # Python dependencies from requirement.txts
  - pypi-dependencies.json

  - steamfiles.json

  - name: RimSort
    buildsystem: simple
    build-commands:
      - mkdir -p /app/bin
      - cp -R app /app/bin/
      - cp -R libs /app/bin/
      - install -D app/__main__.py /app/bin/RimSort
      # - pip3 install --verbose --exists-action=i --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST} . --no-build-isolation
    sources:
      - type: archive
        url: https://github.com/RimSort/RimSort/archive/refs/tags/v1.0.10.tar.gz
        sha256: fd6f80cf908c111c2f1c6ad977664d3fb4533e345602773bfa3ebdfdbb002f00
      - type: patch
        path: run.patch
