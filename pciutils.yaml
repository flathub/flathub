name: pciutils
no-autogen: true
make-args:
  - SHARED=yes
  - ZLIB=no
  - LIBKMOD=yes
  - STRIP=
  - LIBDIR=/app/lib
  - IDSDIR=/app/share/hwdata
  - PCI_IDS=pci.ids
make-install-args:
  - PREFIX=/app
sources:
  - type: archive
    url: https://github.com/pciutils/pciutils/archive/v3.6.2.tar.gz
    sha256: d84d7096a71890f0ddddc50e88ac5a3bc7412bf48d8100fc15857a411564687d
  - type: file
    path: multilibconfigh
  # Change pci.ids directory to hwdata
  - type: file
    path: pciutils-2.2.1-idpath.patch
  # Add support for directory with another pci.ids, rejected by upstream, rhbz#195327
  - type: file
    path: pciutils-dir-d.patch
post-install:
  # install libs
  - install -p -D -m 0755 "lib"/libpci.so.* -t "${FLATPAK_DEST}/lib/";
    pushd "${FLATPAK_DEST}/lib/"; ln -s libpci.so.* libpci.so.3; ln -s libpci.so.3 libpci.so; popd;
  # install bins
  - for f in "${FLATPAK_DEST}/sbin"/*; do
    ln -s "${f}" "${FLATPAK_DEST}/bin/";
    done;
cleanup:
  - /share/man
