name: retext
buildsystem: simple
sources:
  # Source0
  - type: archive
    url: https://github.com/retext-project/retext/archive/7.0.4.tar.gz
    sha256: dd9358dd541266eadf7b4f4606b1eb0a98fa321c25f58f1a9917ec4600345fad
  # Patch0
  - type: patch
    path: notepadqq-7.0.4-appdata.patch
build-commands:
  - python3 setup.py build;
  - python3 setup.py install -O1 --skip-build --prefix="${FLATPAK_DEST}" --root="/";
post-install:
  # install icons
  - echo 'install icons';
    icon_in="icons/retext.svg";
    icon_out="retext.png";
    for s in {16,22,24,32,48,64,72,96,128,192,256,512}; do
    rsvg-convert "${icon_in}" -w "${s}" -h "${s}" -a -f png -o "${icon_out}";
    install -p -D -m 0644 "${icon_out}" -t "${FLATPAK_DEST}/share/icons/hicolor/${s}x${s}/apps/";
    done;
  # install docs
  - echo 'install docs';
    install -p -D -m 0644 *.md -t "${FLATPAK_DEST}/share/doc/retext/";
  # install licenses
  - echo 'install licenses';
    install -p -D -m 0644 "LICENSE_GPL" -t "${FLATPAK_DEST}/share/licenses/retext/";
