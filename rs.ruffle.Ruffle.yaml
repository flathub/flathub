app-id: rs.ruffle.Ruffle
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: ruffle

finish-args:
  - --socket=wayland
# <x11
  - --socket=x11 # required for arboard fault
  - --share=ipc
# x11>
  - --socket=pulseaudio
  - --share=network # Flash can connect to the internet
  - --device=all # controllers (?)

modules:
  - name: ruffle
    buildsystem: simple
    build-commands:
      - install -D -t "${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/" ./rs.ruffle.Ruffle.svg
      - install -D -t "${FLATPAK_DEST}/share/applications/" ./rs.ruffle.Ruffle.desktop
      - install -D -t "${FLATPAK_DEST}/share/metainfo/" ./rs.ruffle.Ruffle.metainfo.xml
      - install -D -t "${FLATPAK_DEST}/bin/" ./ruffle
    sources:
      - type: file
        path: rs.ruffle.Ruffle.metainfo.xml # Waiting for PR merge
      - type: file
        path: rs.ruffle.Ruffle.desktop
      - type: file
        url: https://raw.githubusercontent.com/ruffle-rs/ruffle/16210cbcf6a33aa4035358f935dd363ea9e9f898/desktop/assets/logo.svg
        sha256: 4b718d6645c7453171be1060a785b27ae8dfd260020531273885df2beb0abaec
        dest-filename: rs.ruffle.Ruffle.svg
      - type: archive
        url: https://github.com/ruffle-rs/ruffle/releases/download/nightly-2024-02-13/ruffle-nightly-2024_02_13-linux-x86_64.tar.gz
        sha256: c9112b06d0362be96e8117397ebc6b02428ce7b0925b11fd6e9f596953e00d53
        strip-components: 0
        x-checker-data:
          type: html
          url: https://ruffle.rs/
          pattern: (https:\/\/github\.com\/ruffle-rs\/ruffle\/releases\/download\/.+\/ruffle-nightly-(\d{4}_\d{2}_\d{2})-linux-x86_64\.tar\.gz)
