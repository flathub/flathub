app-id: de.informationsanarchistik.teapot.megamichi.berrypaper
runtime: org.gnome.Platform
runtime-version: '49'
sdk: org.gnome.Sdk
command: berrypaper
finish-args:
  - --share=network
  - --socket=fallback-x11
  - --socket=wayland
  - --share=ipc

modules:
  - name: python3-requirements
    build-commands: []
    buildsystem: simple
    modules:
     - name: python3-xmltodict
       buildsystem: simple
       build-commands:
         - pip3 install --verbose --exists-action=i --no-index --find-links="file://${PWD}"
           --prefix=${FLATPAK_DEST} "xmltodict" --no-build-isolation
       sources:
         - type: file
           url: https://files.pythonhosted.org/packages/c0/20/69a0e6058bc5ea74892d089d64dfc3a62ba78917ec5e2cfa70f7c92ba3a5/xmltodict-1.0.2-py3-none-any.whl
           sha256: 62d0fddb0dcbc9f642745d8bbf4d81fd17d6dfaec5a15b5c1876300aad92af0d


  - name: berrypaper
    buildsystem: simple
    build-commands:
      - install -Dm644 berrypaper/assets/icon.svg flatpak/  # temporary linking icon for appstream
      - install -Dm644 berrypaper/assets/icon.svg /app/share/icons/hicolor/scalable/apps/de.informationsanarchistik.teapot.megamichi.berrypaper.svg
      - install -Dm644 flatpak/de.informationsanarchistik.teapot.megamichi.berrypaper.desktop /app/share/applications/de.informationsanarchistik.teapot.megamichi.berrypaper.desktop
      - install -Dm644 flatpak/de.informationsanarchistik.teapot.megamichi.berrypaper.metainfo.xml /app/share/metainfo/de.informationsanarchistik.teapot.megamichi.berrypaper.metainfo.xml
      - pip3 install --no-cache-dir . --prefix=/app
    sources:
       - type: git
         url: https://teapot.informationsanarchistik.de/Megamichi/BerryPaper.git
         commit: ac1242b0ec09593df46990d975b16ff92fbb0206
