app-id: io.github.savantsavior.t-crisis4
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
command: tc4-tribute3-wrapper.sh

finish-args:
  - --share=ipc
  - --socket=wayland
  - --socket=fallback-x11
  - --socket=pulseaudio
  - --device=all
  - --allow=bluetooth
  - --persist=.tc4-tribute3

modules:
  # SDL2 (Developer's exact version with pipewire disabled for 25.08 compatibility)
  - name: SDL2
    buildsystem: autotools
    config-opts:
      - --disable-pipewire
    sources:
      - type: archive
        url: https://github.com/libsdl-org/SDL/releases/download/release-2.32.2/SDL2-2.32.2.tar.gz
        sha256: c5f30c427fd8107ee4a400c84d4447dd211352512eaf0b6e89cc6a50a2821922

  # SDL2_image from shared-modules
  - shared-modules/SDL2/SDL2_image.json

  # SDL2_ttf from shared-modules  
  - shared-modules/SDL2/SDL2_ttf.json

  # SDL2_mixer (not available in shared-modules, so we bundle it, runtime was giving error )
  - name: SDL2_mixer
    buildsystem: autotools
    sources:
      - type: archive
        url: https://github.com/libsdl-org/SDL_mixer/releases/download/release-2.8.1/SDL2_mixer-2.8.1.tar.gz
        sha256: cb760211b056bfe44f4a1e180cc7cb201137e4d1572f2002cc1be728efd22660

  # Your game
  - name: t-crisis4
    buildsystem: simple
    build-commands:
      - make
      - install -Dm755 tc4-tribute3 /app/bin/tc4-tribute3
      - install -Dm755 tc4-tribute3-wrapper.sh /app/bin/tc4-tribute3-wrapper.sh
      - install -Dm644 io.github.savantsavior.t-crisis4.desktop /app/share/applications/io.github.savantsavior.t-crisis4.desktop
      - install -Dm644 io.github.savantsavior.t-crisis4.metainfo.xml /app/share/metainfo/io.github.savantsavior.t-crisis4.metainfo.xml
      - install -Dm644 io.github.savantsavior.t-crisis4.png /app/share/icons/hicolor/256x256/apps/io.github.savantsavior.t-crisis4.png
      - install -Dm644 license.txt /app/share/licenses/io.github.savantsavior.t-crisis4/LICENSE
      - cp -r data /app/bin/data
    sources:
      - type: archive
        url: https://github.com/savantsavior/t-crisis4/archive/d3a7ac3e04dfe5899b89d0de73a6a7933564f6a4.tar.gz
        sha256: 13d34e3018684487a0d2f27a2d4df11da5059ff57cd32092b80630ec253ecb47
      - type: file
        path: tc4-tribute3-wrapper.sh
