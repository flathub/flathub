app-id: org.archimatetool.Archi
# Same as Eclipse-Java flatpak
# SWT produces visual bugs on other platforms
runtime: org.gnome.Platform
runtime-version: '44'
sdk: org.gnome.Sdk
command: Archi
finish-args:
  # X11 access
  - --socket=x11
  - --share=ipc
  # Needs to talk to the network
  - --share=network
  # Needs to save files locally
  - --filesystem=home
modules:
  - name: archi
    buildsystem: simple
    sources:
      - type: archive
        archive-type: tar-gzip
        # Only x86_64 Binaries are provided by archimatetool
        url: https://www.archimatetool.com/downloads/archi.php?/5.0.2/Archi-Linux64-5.0.2.tgz
        sha256: de86a688d5c94ec8ec1e77b5ed045845546cc4b6ae25fa39aa8424cdfa3bb586
      - type: file
        path: org.archimatetool.Archi.desktop
        dest-filename: org.archimatetool.Archi.desktop
      - type: file
        path: org.archimatetool.Archi.appdata.xml
        dest-filename: org.archimatetool.Archi.appdata.xml
      - type: file
        path: org.archimatetool.Archi.png
        dest-filename: org.archimatetool.Archi.png
    build-commands:
      - install -Dm644 org.archimatetool.Archi.appdata.xml /app/share/metainfo/org.archimatetool.Archi.appdata.xml
      - install -Dm644 org.archimatetool.Archi.desktop /app/share/applications/org.archimatetool.Archi.desktop
      - install -Dm644 org.archimatetool.Archi.png /app/share/icons/hicolor/256x256/apps/org.archimatetool.Archi.png
      - mkdir -p /app/lib /app/bin
      - mv * /app/lib
      - ln -s /app/lib/Archi /app/bin/Archi
