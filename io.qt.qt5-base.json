{
    "name": "qt5-qtbase",
    "cleanup-platform": [
        "/bin",
        "/mkspecs"
    ],
    "build-options": {
        "arch": {
            "x86_64": {
                "config-opts": [
                    "-debug",
                    "-reduce-relocations"
                ]
            },
            "arm": {
                "config-opts": [
                    "-no-reduce-relocations",
                    "-no-use-gold-linker",
                    "-optimize-size"
                ]
            }
        },
        "cflags": "-O2 -g -fstack-protector-strong -D_FORTIFY_SOURCE=2",
        "cxxflags": "-O2 -g -fstack-protector-strong -D_FORTIFY_SOURCE=2",
        "ldflags": "-fstack-protector-strong -Wl,-z,relro,-z,now",
        "env": {
            "V": "1"
        }
    },
    "config-opts": [ 
        "-confirm-license", 
        "-opensource",
        "-shared",
        "-platform linux-g++",
        "-optimized-qmake",
        "-nomake examples",
        "-nomake tests",
        "-system-harfbuzz",
        "-system-sqlite",
        "-accessibility",
        "-dbus-linked",
        "-fontconfig",
        "-glib",
        "-icu",
        "-openssl-linked",
        "-no-pch",
        "-no-rpath",
        "-no-directfb",
        "-no-linuxfb",
        "-no-kms",
        "-no-cups",
        "-system-proxies",
        "-gtk"
    ],
    "sources": [
        { 
          "type": "git",
          "url": "git://code.qt.io/qt/qtbase.git",
          "branch": "v5.9.2"
        },
        {
            "type": "shell",
            "commands": [
                "mv configure configure.qt"
            ]
        },
        {
            "type": "patch",
            "path": "qt5-base_patches/qtbase-flatpak-portals.patch"
        },
        {
            "type": "script",
            "commands": [
                "processed=`sed -e 's/--/-/g ; s/=/ /g' <<< $@`",
                "./configure.qt $processed"
            ],
            "dest-filename": "configure"
        }
    ]
}
