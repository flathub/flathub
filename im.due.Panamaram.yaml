app-id: im.due.Panamaram
runtime: org.kde.Platform
runtime-version: '6.9'
sdk: org.kde.Sdk
base: io.qt.PySide.BaseApp
base-version: '6.9'

command: run-app.sh

build-options:
  append-path: /app/bin
  env:
    PYTHONPATH: /app/lib/python3.12/site-packages

modules:
  # --- Offline Python wheels install ---
  - name: python3-deps
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=/app --no-warn-script-location *.whl
    sources:
      - type: dir
        path: flatpak/pypi

  # --- Your app code and assets ---
  - name: panamaram-app
    buildsystem: simple
    build-commands:
      - install -Dm755 main.py /app/bin/main.py
      - install -Dm755 run-app.sh /app/bin/run-app.sh
      - install -Dm644 im.due.Panamaram.desktop /app/share/applications/im.due.Panamaram.desktop
      - install -Dm644 im.due.Panamaram.png /app/share/icons/hicolor/128x128/apps/im.due.Panamaram.png
      - install -d /app/bin/assets && cp -r assets/* /app/bin/assets/
      - install -d /app/bin/auth && cp -r auth/* /app/bin/auth/
      - install -d /app/bin/db && cp -r db/* /app/bin/db/
      - install -d /app/bin/worker && cp -r worker/* /app/bin/worker/
      - install -d /app/bin/utils && cp -r utils/* /app/bin/utils/
      - install -d /app/bin/ui && cp -r ui/* /app/bin/ui/
    sources:
      - type: dir
        path: .

finish-args:
  - --socket=x11
  - --share=ipc
  - --socket=wayland
  - --device=dri
  - --talk-name=org.freedesktop.Notifications

