app-id: io.botfather.Botfather
branch: stable
runtime: org.kde.Platform
runtime-version: '5.11'
sdk: org.kde.Sdk
command: botfather
tags:
  - proprietary
finish-args:
  - "--filesystem=home:rw" # let user use their scripts properly
  - "--require-version=0.11.4" # fixes kde file saving
  - "--socket=x11" # show windows using X11
  - "--share=ipc" # share IPC namespace with the host (necessary for X11)
  - "--device=dri" # OpenGL rendering (for CEF)
  - "--socket=pulseaudio" # play sound with PulseAudio
  - "--share=network" # access the network (CEF)
  - "--device=all" # for /dev/uinput (mouse and keyboard input)
  - "--talk-name=org.freedesktop.ScreenSaver"
build-options:
  env:
    CEF_ROOT: "/app/CEF"
    LD_LIBRARY_PATH: "/app/lib"
cleanup:
  - "/CEF"
  - "/include"
  - "/lib/pkgconfig"
  - "/share/pkgconfig"
  - "/share/OpenCV"
  - "*.la"
  - "*.a"
modules:
  - shared-modules/udev/udev-175.json
  - gyp/gyp.json
  - nss/nss-3.39.json
  - cef/cef-3.3325.1758-linux64.json
  - opencv/opencv-3.4.3.json
  - name: botfather
    buildsystem: simple
    build-commands:
      - install -D -t /app/bin botfather botfather_helper
      - install -Dm644 io.botfather.Botfather-64.png /app/share/icons/hicolor/64x64/apps/io.botfather.Botfather.png
      - install -Dm644 io.botfather.Botfather-128.png /app/share/icons/hicolor/128x128/apps/io.botfather.Botfather.png
      - install -Dm644 -t /app/share/metainfo io.botfather.Botfather.appdata.xml
      - install -Dm644 -t /app/share/applications io.botfather.Botfather.desktop
    sources:
      - type: file
        path: io.botfather.Botfather-64.png
      - type: file
        path: io.botfather.Botfather-128.png
      - type: file
        path: io.botfather.Botfather.appdata.xml
      - type: file
        path: io.botfather.Botfather.desktop
      - type: file
        path: botfather
      - type: file
        path: botfather_helper