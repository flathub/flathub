app-id: com.mikrotik.Winbox
runtime: org.freedesktop.Platform
runtime-version: '22.08'
sdk: org.freedesktop.Sdk
base: org.winehq.Wine
base-version: stable-22.08
command: winbox
tags:
  - proprietary

finish-args:
  - --share=network
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --filesystem=xdg-desktop
  - --filesystem=xdg-documents
  - --filesystem=xdg-pictures
  - --filesystem=xdg-music
  - --filesystem=xdg-videos
  - --filesystem=xdg-download
  # Skip Gecko and Mono popups when creating Wine prefix
  - --env=WINEDLLOVERRIDES=mscoree,mshtml=
  - --env=WINEPREFIX=/var/data/wine

inherit-extensions:
  - org.freedesktop.Platform.ffmpeg-full
  - org.freedesktop.Platform.ffmpeg_full.i386
  - org.freedesktop.Platform.GL32
  - org.freedesktop.Platform.VAAPI.Intel.i386
  - org.winehq.Wine.gecko
  - org.winehq.Wine.mono
  - org.winehq.Wine.DLLs

modules:
  - name: winbox
    buildsystem: simple
    build-commands:
      - install -Dm 644 winbox.desktop /app/share/applications/com.mikrotik.Winbox.desktop
      - install -Dm 644 icon.svg /app/share/icons/hicolor/scalable/apps/com.mikrotik.Winbox.svg
      - install -Dm 755 winbox.sh /app/bin/winbox
      - install -Dm 644 -t /app/share/metainfo com.mikrotik.Winbox.metainfo.xml
    sources:
      - type: extra-data
        filename: winbox64.exe
        only-arches: [x86_64]
        url: https://download.mikrotik.com/winbox/3.37/winbox64.exe
        sha256: abe696e45809f26b0320926a0014d3088dcc5ac43d553a2b7a4e25f54a047439
        size: 2283392
        x-checker-data:
          type: rotating-url
          url: https://mt.lv/winbox64
          pattern: https://download.mikrotik.com/winbox/([0-9.]+)/winbox64.exe
      - type: file
        path: icon.svg
      - type: file
        path: com.mikrotik.Winbox.metainfo.xml
      - type: file
        path: winbox.desktop
      - type: file
        path: winbox.sh
