id: org.chessmd.chessmd
runtime: org.kde.Platform
runtime-version: '6.9'
sdk: org.kde.Sdk
command: start.sh

finish-args: 
  - --share=ipc
  - --share=network
  - --socket=x11
  - --device=dri
  
modules:
  - name: Caissa
    buildsystem: simple
    subdir: src
    sources:
      - type: archive
        url: https://github.com/Witek902/Caissa/archive/refs/tags/1.23.zip
        sha256: 3042e0bec79f51fff158e0774eb9f91c7915cc6e52a8e6d2e1b79cf54c8d19e4

    build-commands:
      - make
      - install -D caissa /app/engine/caissa
      
  - name: chessmd-opening
    buildsystem: simple
    sources:
      - type: file
        path: start.sh
      - type: archive
        url: https://github.com/ChessMD/ChessMD/releases/download/v1.0/ChessMD_portable.zip
        sha256: 05d8953f912f76126a677b12aa89a08131e0d8252ec8d513091808c79fc0e70b
    build-commands:
      - install -Dm755 start.sh /app/bin/start.sh
      - install -D opening/openings.bin /app/opening/openings.bin
      - install -D opening/openings.headers /app/opening/openings.headers
  
  - name: ChessMD
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
    sources:
      - type: archive
        url: https://github.com/ChessMD/ChessMD/archive/refs/tags/v1.0.1.tar.gz
        sha256: 759fddc5513ea3c30097ca6ac970e434bbd0d37e6cb5a3fbae360f4bf6b4c469
        
  - name: metaData
    buildsystem: simple
    sources:
      - type: file
        url: https://github.com/dxu0107-png/flathub/raw/refs/heads/new-branch/org.chessmd.chessmd.metainfo.xml
        sha256: 039625addd4d2ae5573628936af4e1885cf3a13d854612acfd3ed3552b1f1c75
      - type: file
        url: https://github.com/dxu0107-png/flathub/raw/refs/heads/new-branch/org.chessmd.chessmd.desktop
        sha256: 417ba2fff65e7da65ce659ce1ec5bfc998209cb1719c916d0b107c9d5ab0541e
      - type: file
        url: https://github.com/dxu0107-png/flathub/raw/refs/heads/new-branch/org.chessmd.chessmd.svg
        sha256: 181e5d718f95f9d2df321455d84af34fff0d288617ed8a171bd4ffe460bc3b96
    build-commands:
      - install -D org.chessmd.chessmd.metainfo.xml /app/share/metainfo/org.chessmd.chessmd.metainfo.xml
      - install -D org.chessmd.chessmd.desktop /app/share/applications/org.chessmd.chessmd.desktop
      - install -D org.chessmd.chessmd.svg /app/share/icons/hicolor/scalable/apps/org.chessmd.chessmd.svg
        
