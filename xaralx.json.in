{
    "app-id": "org.xaraxtreme.XaraLX",
    //"branch": "stable",
    //"base": "org.xaraxtreme.wxGTK2.BaseApp",
	//"base-version": "stable",
    //"runtime": "org.freedesktop.Platform",
    //"runtime-version": "1.6",
    //"sdk": "org.freedesktop.Sdk",
    "runtime": "org.gnome.Platform",
    //"runtime-version": "3.24",
    //"runtime-version": "3.26",
    "runtime-version": "3.28",
    "sdk": "org.gnome.Sdk",
    "command": "xaralx",
    "rename-icon": "xaralx",
    "rename-desktop-file": "xaralx.desktop",
    "rename-appdata-file": "xaralx.appdata.xml",
    "finish-args": [
        // X11 + XShm access
        "--share=ipc",
        "--socket=x11",
        // Wayland access
        //"--socket=wayland",
        // Play sounds
        "--socket=pulseaudio",
        //"--socket=system-bus",
        //"--socket=session-bus",
        // Needs to talk to the network
        "--share=network",
        //"--filesystem=home",
        //"--filesystem=/run/media",
        //"--filesystem=/tmp",
        "--filesystem=host",
        // Needed for dconf to work
        //"--filesystem=xdg-run/dconf", "--filesystem=~/.config/dconf:ro",
        //"--filesystem=xdg-run/dconf", "--filesystem=~/.config/dconf:rw",
        //"--talk-name=ca.desrt.dconf", "--env=DCONF_USER_CONFIG_DIR=.config/dconf",
        // Browse gvfs
        "--talk-name=org.gtk.vfs", "--talk-name=org.gtk.vfs.*",
        // Notifications
        //"--talk-name=org.freedesktop.Notifications",
        //"--talk-name=org.freedesktop.secrets",
        //"--system-talk-name=org.freedesktop.GeoClue2",
        /*
        // <Totem>
        // Browse user's Videos directory
        "--filesystem=xdg-videos",
        // Needed for dconf to work
        "--filesystem=xdg-run/dconf", "--filesystem=~/.config/dconf:ro",
        "--talk-name=ca.desrt.dconf", "--env=DCONF_USER_CONFIG_DIR=.config/dconf",
        // Online accounts support
        "--talk-name=org.gnome.OnlineAccounts",
        // Tracker
        "--talk-name=org.freedesktop.Tracker1",
        // DLNA server
        "--talk-name=com.intel.dleyna-server",
        // Browse gvfs
        "--talk-name=org.gtk.vfs", "--talk-name=org.gtk.vfs.*",
        // screensaver plugin
        "--talk-name=org.gnome.ScreenSaver",
        // screenshot plugin
        "--talk-name=org.gnome.Shell",
        // save-file plugin
        "--talk-name=org.gnome.Nautilus",
        // media-player-keys plugin
        "--talk-name=org.gnome.SettingsDaemon",
        // im-status plugin
        "--talk-name=org.gnome.SessionManager",
        // Avahi
        "--system-talk-name=org.freedesktop.Avahi",
        // </Totem>
        //*/
        //"--env=LC_ALL=C",
        //"--extension=org.freedesktop.Platform.Compat=directory=lib/64bit",
        //"--extension=org.freedesktop.Platform.Compat=version=1.6",
        //"--extension=org.freedesktop.Platform.GL=directory=lib/64bit/lib/GL",
        //"--extension=org.freedesktop.Platform.GL=version=1.4",
        //"--extension=org.freedesktop.Platform.GL=versions=1.6;1.4",
        //"--extension=org.freedesktop.Platform.GL=subdirectories=true",
        //"--extension=org.freedesktop.Platform.GL=no-autodownload=true",
        //"--extension=org.freedesktop.Platform.GL=autodelete=false",
        //"--extension=org.freedesktop.Platform.GL=add-ld-path=lib",
        //"--extension=org.freedesktop.Platform.GL=merge-dirs=vulkan/icd.d;glvnd/egl_vendor.d",
        //"--extension=org.freedesktop.Platform.GL=download-if=active-gl-driver",
        //"--extension=org.freedesktop.Platform.GL=enable-if=active-gl-driver",
        //"--extension=org.freedesktop.Platform.Compat32=directory=lib/32bit",
        //"--extension=org.freedesktop.Platform.Compat32=version=1.6",
        //"--extension=org.freedesktop.Platform.GL32=directory=lib/32bit/lib/GL",
        //"--extension=org.freedesktop.Platform.GL32=version=1.4",
        //"--extension=org.freedesktop.Platform.GL32=versions=1.6;1.4",
        //"--extension=org.freedesktop.Platform.GL32=subdirectories=true",
        //"--extension=org.freedesktop.Platform.GL32=no-autodownload=true",
        //"--extension=org.freedesktop.Platform.GL32=autodelete=false",
        //"--extension=org.freedesktop.Platform.GL32=add-ld-path=lib",
        //"--extension=org.freedesktop.Platform.GL32=merge-dirs=vulkan/icd.d;glvnd/egl_vendor.d",
        //"--extension=org.freedesktop.Platform.GL32=download-if=active-gl-driver",
        //"--extension=org.freedesktop.Platform.GL32=enable-if=active-gl-driver",
        //"--device=all",
        // OpenGL access
        "--device=dri"
    ],
    "build-options" : {
        "cflags": "-O2 -g -Wno-deprecated-declarations -fstack-protector-strong -D_FORTIFY_SOURCE=2",
        "cxxflags": "-O2 -g -Wno-deprecated-declarations -fstack-protector-strong -D_FORTIFY_SOURCE=2",
        "ldflags": "-fstack-protector-strong -Wl,-z,relro,-z,now",
        "env": {
            "V": "1"
        }
    },
    "modules": [
        {
            "name": "dos2unix",
            // remove configure script to run autoreconf
            //"rm-configure": true,
            "no-autogen": true,
            //"no-parallel-make": true,
            "sources": [
                // Source0
                {
                    "type": "archive",
                    "url": "https://waterlan.home.xs4all.nl/dos2unix/dos2unix-7.4.0.tar.gz",
                    "sha256": "bac765abdbd95cdd87a71989d4382c32cf3cbfeee2153f0086cb9cf18261048a"
                },
                {
                    "type": "shell",
                    "commands": [
                        "echo 'fix Makefile';",
                        // We don't need it after complete build
                        "sed -r -i 's#^([[:blank:]]*)(prefix[[:blank:]]*=[[:blank:]]*)(.*)(/usr)(/|[[:blank:]]|$)(.*)$#\\1\\2\\3/app/opt/dos2unix\\5\\6#' 'Makefile';",
                        "grep -Ei '/usr' 'Makefile' || :;"
                    ]
                }
            ],
            "post-install": [
                "echo 'post-install: docs';",
                "install -d '/app/opt/dos2unix/share/doc/dos2unix'; install -p -m 0644 'man/man1/dos2unix.htm' 'BUGS.txt' 'ChangeLog.txt' 'DEVEL.txt' 'INSTALL.txt' 'NEWS.txt' 'README.txt' 'TODO.txt' '/app/opt/dos2unix/share/doc/dos2unix/';",
                "echo 'post-install: licenses';",
                "install -d '/app/opt/dos2unix/share/licenses/dos2unix'; install -p -m 0644 'COPYING.txt' '/app/opt/dos2unix/share/licenses/dos2unix/';"
            ],
            "cleanup": [
                "/opt/dos2unix/share/doc",
                "/opt/dos2unix/share/man"
            ]
        },
        {
            "name": "xmlstarlet",
            // remove configure script to run autoreconf
            //"rm-configure": true,
            //"no-autogen": true,
            //"no-parallel-make": true,
            "config-opts": [
                // We don't need it after complete build
                "--disable-static-libs",
                "--with-libxml-libs-prefix=/usr/lib",
                "--with-libxml-include-prefix=/usr/include/libxml2",
                "--prefix=/app/opt/xmlstarlet",
                "--exec-prefix=/app/opt/xmlstarlet"
            ],
            "sources": [
                // Source0
                {
                    "type": "archive",
                    "url": "http://downloads.sourceforge.net/xmlstar/xmlstarlet-1.6.1.tar.gz",
                    "sha256": "15d838c4f3375332fd95554619179b69e4ec91418a3a5296e7c631b7ed19e7ca"
                },
                // Patch0
                {
                    "type": "patch",
                    "path": "xmlstarlet-1.6.1-nogit.patch",
                    "strip-components": 1,
                    "sha256": "c54485c5e2bd038219884250228333113a9751e999baa28a833a679f79421890"
                },
                // checking for xml2-config... /bin/xml2-config
                // ERROR: /usr/bin/xml2-config should not be used, use an alternative such as pkg-config
                // configure: error: xmlstarlet needs at least libxml version 2.6.27 (http://www.xmlsoft.org/)
                // Error: module xmlstarlet: Child process exited with code 1
                // checking for xslt-config... /bin/xslt-config
                // ERROR: /usr/bin/xslt-config should not be used, use an alternative such as pkg-config
                // configure: error: xmlstarlet needs at least libxslt version 1.1.9 (http://www.xmlsoft.org/)
                // Error: module xmlstarlet: Child process exited with code 1
                {
                    "type": "shell",
                    "commands": [
                        "echo 'fix configure: xml2 & xslt';",
                        "sed -r -i 's/^([[:blank:]]*XSTAR_LIB_CHECK[[:blank:]]*\\(\\[LIBXML\\],[[:blank:]]*\\[)xml2-config(\\]\\))/\\1pkg-config libxml-2.0\\2/' 'configure.ac';",
                        "sed -r -i 's/^([[:blank:]]*XSTAR_LIB_CHECK[[:blank:]]*\\(\\[LIBXSLT\\],[[:blank:]]*\\[)xslt-config(\\]\\))/\\1pkg-config libxslt\\2/' 'configure.ac';",
                        "grep -Ei 'XSTAR_LIB_CHECK' 'configure.ac' || :;"
                    ]
                },
                {
                    "type": "shell",
                    "commands": [
                        "echo 'fix configure: xml2 & xslt version';",
                        "sed -r -i 's/^(\\[LIBXML_REQUIRED_VERSION=)/#\\1/' 'configure.ac';",
                        "sed -r -i 's/^(\\[LIBXSLT_REQUIRED_VERSION=)/#\\1/' 'configure.ac';",
                        "grep -Ei '_REQUIRED_VERSION' 'configure.ac' || :;"
                    ]
                },
                {
                    "type": "shell",
                    "commands": [
                        "echo 'autoreconf';",
                        "cp -p /usr/share/automake-*/config.{sub,guess} .;",
                        "autoreconf -i;"
                    ]
                }
            ],
            "post-install": [
                // symlink
                "echo 'post-install: symlink';",
                "[[ -f '/app/opt/xmlstarlet/bin/xmlstarlet' ]] || ln -s 'xml' '/app/opt/xmlstarlet/bin/xmlstarlet';",
                "echo 'post-install: docs';",
                "install -d '/app/opt/xmlstarlet/share/doc/xmlstarlet'; install -p -m 0644 'AUTHORS' 'ChangeLog' 'INSTALL' 'NEWS' 'README' 'TODO' '/app/opt/xmlstarlet/share/doc/xmlstarlet/';",
                "echo 'post-install: licenses';",
                "install -d '/app/opt/xmlstarlet/share/licenses/xmlstarlet'; install -p -m 0644 'COPYING' 'Copyright' '/app/opt/xmlstarlet/share/licenses/xmlstarlet/';"
            ],
            "cleanup": [
                "/opt/xmlstarlet/share/doc",
                "/opt/xmlstarlet/share/man"
            ]
        },
        {
            "name": "imagemagick",
            // remove configure script to run autoreconf
            //"rm-configure": true,
            //"no-autogen": true,
            // Do *NOT* use parallel make, this causes PerlMagick to be silently misbuild
            "no-parallel-make": true,
            "config-opts": [
                "--enable-shared",
                "--disable-static",
                "--with-modules",
                //"--with-perl",
                "--with-x",
                "--with-threads",
                "--with-magick_plus_plus",
                "--with-gslib",
                "--with-wmf",
                "--with-webp",
                "--with-openexr",
                "--with-rsvg",
                "--with-xml",
                //"--with-perl-options=\"INSTALLDIRS=vendor CC='gcc -L$PWD/magick/.libs' LDDLFLAGS='-shared -L$PWD/magick/.libs'\"",
                //"--without-dps",
                //"--without-gcc-arch",
                "--with-jbig",
                "--with-openjp2",
                // We don't need it after complete build
                //"--prefix=/app/opt/imagemagick",
                //"--exec-prefix=/app/opt/imagemagick"
                // Warning from Xara Xtreme: Xara Xtreme cannot find ImageMagick version 6.0.0 or above. Various bitmap filters will be disabled. To install ImageMagick, either use the package manager supplied with your distribution, or visit http://www.imagemagick.org/
                "--prefix=/app",
                "--exec-prefix=/app"
            ],
            "sources": [
                {
                    "type": "archive",
                    //"url": "https://www.imagemagick.org/download/ImageMagick-6.9.9-41.tar.xz",
                    //"sha256": "35b52173c240f81654368a5c453614f572fcb44132531a8fa4538e2d304adfd3"
                    //"url": "https://www.imagemagick.org/download/ImageMagick-6.9.9-42.tar.xz",
                    //"sha256": "873654cd55792cdaa9c3ee35f63e389fedfb3d34685a1f77d6b81e5c578ae527"
                    "url": "https://www.imagemagick.org/download/ImageMagick-6.9.9-43.tar.xz",
                    "sha256": "66c2937728ae3f385d84691a360d74993675f43ae16236773daa3a49c3ea6e27"
                },
                {
                    "type": "patch",
                    "path": "ImageMagick-6.9.9-3-multiarch-implicit-pkgconfig-dir.patch",
                    "strip-components": 1,
                    "sha256": "80eea73e19a47cdb322d9006d4fe4a868db0d0d43fd7a0c9ae1a5e2fbbdbfe4b"
                },
                {
                    "type": "shell",
                    "commands": [
                        "echo 'copy examples';",
                        "mkdir 'Magick++/examples'; cp -p Magick++/demo/*.cpp Magick++/demo/*.miff Magick++/examples;"
                    ]
                }
            ],
            "post-install": [
                "echo 'post-install: docs';",
                //"install -d '/app/opt/imagemagick/share/doc/imagemagick'; install -p -m 0644 'AUTHORS.txt' 'ChangeLog' 'Install-mac.txt' 'Install-unix.txt' 'Install-vms.txt' 'Install-windows.txt' 'NEWS.txt' 'NOTICE' 'Platforms.txt' 'README.txt' 'QuickStart.txt' '/app/opt/imagemagick/share/doc/imagemagick/';",
                "install -d '/app/share/doc/imagemagick'; install -p -m 0644 'AUTHORS.txt' 'ChangeLog' 'Install-mac.txt' 'Install-unix.txt' 'Install-vms.txt' 'Install-windows.txt' 'NEWS.txt' 'NOTICE' 'Platforms.txt' 'README.txt' 'QuickStart.txt' '/app/share/doc/imagemagick/';",
                //"install -d '/app/opt/imagemagick/share/doc/imagemagick/Magick++'; install -p -m 0644 'Magick++/AUTHORS' 'Magick++/ChangeLog' 'Magick++/NEWS' 'Magick++/README' '/app/opt/imagemagick/share/doc/imagemagick/Magick++/';",
                "install -d '/app/share/doc/imagemagick/Magick++'; install -p -m 0644 'Magick++/AUTHORS' 'Magick++/ChangeLog' 'Magick++/NEWS' 'Magick++/README' '/app/share/doc/imagemagick/Magick++/';",
                //"install -d '/app/opt/imagemagick/share/doc/imagemagick/Magick++/examples'; install -p -m 0644 Magick++/examples/* '/app/opt/imagemagick/share/doc/imagemagick/Magick++/examples/';",
                "install -d '/app/share/doc/imagemagick/Magick++/examples'; install -p -m 0644 Magick++/examples/* '/app/share/doc/imagemagick/Magick++/examples/';",
                "echo 'post-install: licenses';",
                //"install -d '/app/opt/imagemagick/share/licenses/imagemagick'; install -p -m 0644 'LICENSE' '/app/opt/imagemagick/share/licenses/imagemagick/';",
                "install -d '/app/share/licenses/imagemagick'; install -p -m 0644 'LICENSE' '/app/share/licenses/imagemagick/';",
                //"install -d '/app/opt/imagemagick/share/licenses/imagemagick/Magick++'; install -p -m 0644 'www/Magick++/COPYING' '/app/opt/imagemagick/share/licenses/imagemagick/Magick++/';"
                "install -d '/app/share/licenses/imagemagick/Magick++'; install -p -m 0644 'www/Magick++/COPYING' '/app/share/licenses/imagemagick/Magick++/';"
            ]//,
            //"cleanup": [
            //    //"/opt/imagemagick/share/doc",
            //    "/share/doc",
            //    //"/opt/imagemagick/share/man"
            //    "/share/man"
            //]
        },
        {
            //"name": "wxWidgets",
            "name": "wxGTK2",
            // remove configure script to run autoreconf
            //"rm-configure": true,
            "no-autogen": true,
            //"no-parallel-make": true,
            //"modules": [
            //    "shared-modules/glu/glu-9.0.0.json"
            //],
            "sources": [
                // Sources and Prepare:
                // Source0
                {
                    "type": "archive",
                    "url": "http://downloads.sf.net/wxwindows/wxGTK-2.8.12.tar.bz2",
                    "sha256": "f4193c29fb0e790c9a5c8936f082377a7e51c76bccafe41f4f9da7ca15c0ef1a"
                },
                // Source1
                {
                    "type": "file",
                    "path": "wx-config",
                    "sha256": "9002d9b69d0ff9a1b67cae59fc61783a1fd16a6f2213bc79af60ff1ee364ed1c"
                },
                {
                    "type": "shell",
                    "commands": [
                        "echo 'fix wx-config';",
                        "sed -r -i 's!lib64!lib!g;s!/usr/!/app/!g' 'wx-config';"
                    ]
                },
                // Patch0
                {
                    "type": "patch",
                    "path": "wxGTK-2.8.12-test.patch",
                    "strip-components": 1,
                    "sha256": "217ed70bacd95b3be51d462155d87cecf27a789fca9fd7a9334f4a4f586e6b02"
                },
                // Patch1
                {
                    "type": "patch",
                    "path": "wxGTK-2.8.12-abicheck.patch",
                    "strip-components": 1,
                    "sha256": "46a1bb97d69163547da13d5e23a4c73e68de27ee601da5d2fb5bc5c417931453"
                },
                // Patch2
                {
                    "type": "patch",
                    "path": "wxGTK-2.8.12-char.patch",
                    "strip-components": 1,
                    "sha256": "5025cf8a73405106c8c55c819a92006088da53ed0256e8e41b4c58cd93d354be"
                },
                // fix permissions for sources
                {
                    "type": "shell",
                    "commands": [
                        "echo 'fix permissions for sources';",
                        "chmod a-x include/wx/{msgout.h,dcgraph.h,graphics.h} src/common/msgout.cpp;"
                    ]
                },
                // Build:
                // autogen & autoreconf
                //{
                //    "type": "shell",
                //    "commands": [
                //        "echo 'autogen and autoreconf';",
                //        "cp -p /usr/share/automake-*/config.{sub,guess} .;",
                //        "./autogen.sh",
                //        "autoreconf -f -i;"
                //    ]
                //},
                // configure
                {
                    "type": "shell",
                    "commands": [
                        "echo 'configure';",
                        "export GDK_USE_XFT='1';
                        export optflags='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic';
                        export CFLAGS=\"${optflags} -fno-strict-aliasing \";
                        export CXXFLAGS=\"${optflags} -fno-strict-aliasing \";
                        configure_args=( );
                        #configure_args+=( '--with-opengl' );
                        configure_args+=( '--with-sdl' );
                        configure_args+=( '--without-gnomeprint' );
                        configure_args+=( '--enable-shared' );
                        configure_args+=( '--enable-soname' );
                        configure_args+=( '--disable-optimise' );
                        configure_args+=( '--enable-debug_info' );
                        configure_args+=( '--enable-intl' );
                        configure_args+=( '--enable-unicode' );
                        configure_args+=( '--enable-no_deps' );
                        configure_args+=( '--disable-rpath' );
                        configure_args+=( '--enable-geometry' );
                        configure_args+=( '--enable-graphics_ctx' );
                        configure_args+=( '--enable-sound' );
                        configure_args+=( '--enable-mediactrl' );
                        configure_args+=( '--enable-display' );
                        configure_args+=( '--enable-timer' );
                        configure_args+=( '--enable-compat24' );
                        configure_args+=( '--disable-catch_segvs' );
                        configure_args+=( '--with-gtk=2' );
                        configure_args+=( '--with-libpng' );
                        configure_args+=( '--with-libjpeg' );
                        configure_args+=( '--with-libtiff' );
                        configure_args+=( '--with-libxpm' );
                        configure_args+=( '--with-zlib' );
                        configure_args+=( '--with-expat' );
                        configure_args+=( '--with-libiconv-prefix=/usr' );
                        configure_args+=( '--enable-mediactrl' );
                        configure_args+=( '--enable-grid' );
                        configure_args+=( '--prefix=/app' );
                        configure_args+=( '--exec-prefix=/app' );
                        echo 'configure: wxGTK2';
                        for i in \"${configure_args[@]}\"; do
                            echo \"- '${i}'\";
                        done;
                        ./configure \"${configure_args[@]}\";"
                    ]
                },
                // make
                {
                    "type": "shell",
                    "commands": [
                        "echo 'make';",
                        "make -j$(nproc);",
                        "make -j$(nproc) -C 'contrib/src/stc';",
                        "make -j$(nproc) -C 'contrib/src/ogl';",
                        "make -j$(nproc) -C 'contrib/src/gizmos';",
                        "make -j$(nproc) -C 'contrib/src/svg';",
                        // Why isn't this part of the main build? Need to investigate.
                        "make -j$(nproc) -C 'locale' 'allmo';"
                    ]
                },
                // make install
                {
                    "type": "shell",
                    "commands": [
                        "echo 'make install';",
                        //"install -d '/app/bin';",
                        "make install;",
                        "make install -C 'contrib/src/stc';",
                        "make install -C 'contrib/src/ogl';",
                        "make install -C 'contrib/src/gizmos';",
                        "make install -C 'contrib/src/svg';"
                    ]
                },
                // install
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install';",
                        "echo 'install: begin';
                        
                        # install our multilib-aware wrapper
                        #rm '/app/bin/wx-config';
                        mv '/app/bin/wx-config' '/app/bin/wx-config-2.0';
                        #install -p -m 755 'wx-config' '/app/bin/wx-config-2.0';
                        touch '/app/bin/wx-config';
                        
                        # Alternatives setup with wxrc
                        mv '/app/bin/wxrc' '/app/bin/wxrc-2';
                        touch '/app/bin/wxrc';
                        
                        echo 'install: end';"
                    ]
                },
                // install docs
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install docs';",
                        "install -d '/app/share/doc/wxGTK2';
                        install -p -m 0644 'docs/readme.txt' 'docs/readme_vms.txt' '/app/share/doc/wxGTK2/';
                        install -p -m 0644 'docs/changes.txt' 'docs/todo.txt' '/app/share/doc/wxGTK2/';"
                    ]
                },
                // install licenses
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install licenses';",
                        "install -d '/app/share/licenses/wxGTK2';
                        install -p -m 0644 'docs/gpl.txt' 'docs/lgpl.txt' '/app/share/licenses/wxGTK2/';
                        install -p -m 0644 'docs/licence.txt' 'docs/licendoc.txt' 'docs/preamble.txt' '/app/share/licenses/wxGTK2/';"
                    ]
                },
                // fake Makefile
                {
                    "type": "shell",
                    "commands": [
                        "echo 'backup old autotools files';",
                        "for filename in 'autogen' 'autogen.sh' 'configure' 'configure.ac' 'configure.in' 'install-sh' 'Makefile' 'Makefile.am' 'Makefile.in'; do
                            [[ -f \"${filename}\" ]] || continue;
                            mv \"${filename}\" \"${filename}.bak\";
                        done;",
                        "echo 'create empty Makefile';",
                        "echo '# Empty Makefile\n\nall:\n\techo \"Using an empty Makefile doing nothing\"\n\ninstall:\n\techo \"Using an empty Makefile doing nothing\"' > 'Makefile';"
                    ]
                }
            ],
            "post-install": [
                "echo 'post-install';",
                "echo 'post-install: begin';

                echo 'update-alternatives';
                # remove symlink
                if [[ -f '/app/bin/wx-config' ]] && [[ ! -h '/app/bin/wx-config' ]] ; then
                    rm '/app/bin/wx-config';
                fi;
                if [[ -f '/app/bin/wxrc' ]] && [[ ! -h '/app/bin/wxrc' ]] ; then
                    rm '/app/bin/wxrc';
                fi;
                use_symlink='0';
                command -v 'update-alternatives' || use_symlink='1';
                if [[ \"${use_symlink}\" -ne 0 ]]; then
                    ln -sf 'wx-config-2.0' '/app/bin/wx-config';
                    ln -sf 'wxrc-2' '/app/bin/wxrc';
                else
                    update-alternatives --install '/app/bin/wx-config' 'wx-config' '/app/bin/wx-config-2.0' 2;
                    update-alternatives --install '/app/bin/wxrc' 'wxrc' '/app/bin/wxrc-2' 2;
                fi

                echo 'post-install: end';"
            ]//,
            //"cleanup": [
            //    "/bin",
            //    "/include",
            //    "/share/bakefile",
            //    "/share/aclocal",
            //    "/lib/wx/include"
            //]
        },
        {
            "name": "xaralx",
            // remove configure script to run autoreconf
            //"rm-configure": true,
            "no-autogen": true,
            //"no-parallel-make": true,
            "sources": [
                // Sources and Prepare:
                // Source0
                {
                    "type": "archive",
                    //http://www.xaraxtreme.org/developers/subversion-access-instructions.html
                    //"path": "XaraLX-0.7r1785.tar.bz2",
                    //"url": "http://mirror.sobukus.de/files/grimoire/graphics/XaraLX-0.7r1785.tar.bz2",
                    //"sha256": "d053e44debe30ca80d7e40cf591e90e18dedfa7558feb375ab82ef1003feab17"
                    "url": "http://archive.ubuntu.com/ubuntu/pool/multiverse/x/xaralx/xaralx_0.7r1785.orig.tar.gz",
                    "sha256": "ab2620253b0f7ae83f27e9ac4314b71fa78367e6fe442fdcd37fb6a61da53972"
                },
                // Source1
                {
                    "type": "file",
                    "path": "XARFormatDocument.pdf",
                    "sha256": "7eb68037eb9ea971c111e75258d6e9d84c28cdc1ec54b70a810ec9f1d684b7ea"
                },
                // Source2
                {
                    "type": "file",
                    "path": "xaralx.desktop",
                    "sha256": "5eee3f2607ad5c625a054eaa4d8dcd871f48715a893e0ebafb6cc8063bec8e91"
                },
                // Source3
                {
                    "type": "file",
                    "path": "XaraLX-i18n-0.7r1785.tar.gz",
                    "sha256": "d38dbc1335e3048705f1bc9e2e2acaa3ab64a5ea8e4ee49f235ab633dbbe2108"
                },
                {
                    "type": "shell",
                    "commands": [
                        "echo 'extract PO files';",
                        "pushd 'po'; tar -xf '../XaraLX-i18n-0.7r1785.tar.gz'; popd;"
                    ]
                },
                // Source4
                {
                    "type": "file",
                    "path": "xaralx.svg",
                    "sha256": "726f494805133f938577207290f30700f97ac07e60b90793bc87f6ffa2ce7cbc"
                },
                // Source5
                {
                    "type": "file",
                    "path": "xaralx.appdata.xml",
                    "sha256": "5ba8e6e538336fa3e0d94f825445fae89d90f1b517d6e1817f36e0129aeafd62"
                },
                // Source44
                //{
                //    "type": "file",
                //    "path": "import.info",
                //    "sha256": "17913333cf4bbe9b8c68e1efedafcd1b0b10b8ff6ba9506fcf84baab1eca4266"
                //},
                // Patch1
                {
                    "type": "patch",
                    "path": "abuild.diff",
                    "strip-components": 1,
                    "sha256": "d7c1f0a9331f9c42a9cb35ac86a0742649ff944748acf31ed57fa603d9aac30b"
                },
                // Patch2
                {
                    "type": "patch",
                    "path": "XaraLX-0.7r1785-missing-declaration.patch",
                    "strip-components": 1,
                    "sha256": "0d36a53e75cd83a7b318cf399e2d6c0d721c1d6c3452a19acf164ac59391f712"
                },
                // Patch3
                {
                    "type": "patch",
                    "path": "xaralx-0.7_p1785-pragma-gentoo.patch",
                    "strip-components": 1,
                    "sha256": "281450a2f81d45807e01d5cec98eebfcb8795d8a43ad8e1412ebac5f0a425a2e"
                },
                // Patch4
                {
                    "type": "patch",
                    "path": "xaralx-gsocket.patch",
                    "strip-components": 1,
                    "sha256": "4e8b85eae30ce5404481bc12704037c87d4f5d5ffea0e336abe185616a369a4e"
                },
                // Patch5
                {
                    "type": "patch",
                    "path": "xaralx-0.7_p1785-libpng15-gentoo.patch",
                    "strip-components": 1,
                    "sha256": "bc243121b905225587f2e6a916ca8d0e141bdca1433c1c43f5a3b81917e9a049"
                },
                // Patch6
                {
                    "type": "patch",
                    "path": "30_gtk_wxwidgets_symbol_clash-deb.patch",
                    "strip-components": 1,
                    "sha256": "3f7ef5304c47fe87ab48ba3cc00d3c9c41e85b3c7736939aaa235d5b136c89e5"
                },
                // Patch7
                {
                    "type": "patch",
                    "path": "50_update_imagemagick_version_parser-deb.patch",
                    "strip-components": 1,
                    "sha256": "279123b48c5c9e106f630cbf907036c69ddee0c42a5812984ec4640a1fd634da"
                },
                // Patch8
                {
                    "type": "shell",
                    "commands": [
                        "echo 'pre-patch: Makefile.am';",
                        "stat -c '%Y' 'Makefile.am' > 'Makefile.am.stamp';"
                    ]
                },
                {
                    "type": "patch",
                    "path": "add-linker-flags-deb-mga-el.patch",
                    "strip-components": 1,
                    "sha256": "46dd27c6161425580781fe73199b5266c2df10b136e5a7e9c60486423ae9a96c"
                },
                // Fix build on Fedora x86-64
                // https://lists.debian.org/debian-devel/2016/05/msg00309.html
                // code compiled without -fPIC and without -fPIE can be used only
                // in non-PIE executables
                {
                    "type": "shell",
                    "commands": [
                        "echo 'patch: Makefile.am';",
                        "sed -r -i 's/^(XaraLX_LDFLAGS.*)$/\\1 \\-no\\-pie /' 'Makefile.am';"
                    ]
                },
                {
                    "type": "shell",
                    "commands": [
                        "echo 'post-patch: Makefile.am';",
                        "date_orig_makefile=\"$( cat 'Makefile.am.stamp' | head -n 1 )\"; touch -d \"@${date_orig_makefile}\" 'Makefile.am';"
                    ]
                },
                // Patch9
                {
                    "type": "patch",
                    "path": "wxOil-wxHandleFatalError.patch",
                    "strip-components": 0,
                    "sha256": "e2fcf1b095e092f1618f2040ee8fbd6b2f4edc231fb90e779d8e3bb822b74e4f"
                },
                // Patch10
                {
                    "type": "patch",
                    "path": "xaralx-pragma.patch",
                    "strip-components": 0,
                    "sha256": "d74e01d4e3a79918b99ad9ad652aaee8eef3a5b8331f5159ee78936b287f0ad1"
                },
                // Pseudo-Patch11
                {
                    "type": "shell",
                    "commands": [
                        "echo 'prepare: remove .svn';",
                        //"find -type d -name '.svn' -print0 | xargs -0 rm -rf {} \\;"
                        "find . -type d -name '.svn' -prune -exec rm -rf {} +;"
                    ]
                },
                // Pseudo-Patch12
                // string "800_by_600_drawing.xar" must not be translated
                {
                    "type": "shell",
                    "commands": [
                        "echo 'prepare: fix *.po files';",
                        "sed -i 's|msgstr \"800 на 600 drawing.xar\"|msgstr \"\"|g' 'po/ru.po';"
                    ]
                },
                // Build:
                {
                    "type": "shell",
                    "commands": [
                        "echo 'fix configure: xml2';",
                        "find * -xtype f \\( -name 'configure' -o -name 'configure.in' -o -name 'output.0' -o -name 'output.1' \\) | sort -V | while read -r filename; do
                            sed -r -i 's/^([[:blank:]]*XML2CONFIG=)(xml2-config)([[:blank:]]*)$/\\1\"pkg-config libxml-2.0\"\\3/' \"${filename}\";
                            sed -r -i 's/([[:blank:]]*|^)(test \"\\$xml2version\" -lt )([0-9]+)([^0-9]|$)/\\1\\20\\4/g' \"${filename}\";
                        done;",
                        "grep -HERi 'XML2CONFIG=' * || :;",
                        "grep -HERi '\"\\$xml2version\"' * || :;"
                    ]
                },
                // autogen & autoreconf
                {
                    "type": "shell",
                    "commands": [
                        "echo 'autogen and autoreconf';",
                        "cp -p /usr/share/automake-*/config.{sub,guess} .;",
                        "./autogen.sh",
                        "pushd 'filters/SVGFilter'; autoreconf -f -i; popd;"
                    ]
                },
                // configure
                {
                    "type": "shell",
                    "commands": [
                        "echo 'configure';",
                        "export WXCONFIG='wx-config';
                        export WXCONFIG_PATH=\"$( command -v \"${WXCONFIG}\" )\";
                        export optflags='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic';
                        export CFLAGS=\"${optflags} -fno-strict-aliasing \";
                        export CXXFLAGS=\"${optflags} -fno-strict-aliasing -fpermissive \";
                        export LDFLAGS=\"${LDFLAGS} -lgobject-2.0 \";
                        configure_args=( );
                        configure_args+=( '--enable-unicode' );
                        configure_args+=( '--enable-xarlib' );
                        configure_args+=( '--enable-filters' );
                        #configure_args+=( '--disable-svnversion' );
                        configure_args+=( \"--with-wx-config=${WXCONFIG_PATH}\" );
                        configure_args+=( '--prefix=/app' );
                        configure_args+=( '--exec-prefix=/app' );
                        echo 'configure: XaraLX';
                        for i in \"${configure_args[@]}\"; do
                            echo \"- '${i}'\";
                        done;
                        ./configure \"${configure_args[@]}\";"
                    ]
                },
                // configure fix: disable some hardening flags
                {
                    "type": "shell",
                    "commands": [
                        "echo 'fix configure';",
                        "hardening_flags=( );
                        hardening_flags+=( '-fPIE' );
                        hardening_flags+=( '-pie' );
                        for text in \"${hardening_flags[@]}\"; do
                            text_cleared=\"$( sed -re 's/^[[:blank:]]*//;s/[[:blank:]]*$//' <<< \"${text}\" )\";
                            [[ -n \"${text_cleared}\" ]] || continue
                            sed -re 's/[[:blank:]]+/\\n/g' <<< \"${text_cleared}\" | grep -Ei 'pie' | while read -r subtext_cleared ; do
                                sed_cmd=\"s#([[:blank:]]+|^)(${subtext_cleared})([[:blank:]]+|$)#\\1\\3#g\";
                                find * -xtype f \\( -name 'Makefile' -o -name 'config.log' -o -name 'config.status' \\) | xargs -I{} sed -r -i \"${sed_cmd}\" '{}';
                            done;
                        done;
                        grep -HERi '\-fPIE|\-pie' * || :;"
                    ]
                },
                // make
                {
                    "type": "shell",
                    "commands": [
                        "echo 'make';",
                        "make -j$(nproc);"
                    ]
                },
                // compile locales by hand
                {
                    "type": "shell",
                    "commands": [
                        "echo 'compile locales';",
                        "pushd 'po';
                            for f in *.po; do
                                t=\"${f#xaralx-}\";
                                msgfmt -v -o \"${t%.po}.mo\" \"${f}\";
                            done;
                        popd;"
                    ]
                },
                // create icons
                {
                    "type": "shell",
                    "commands": [
                        "echo 'create icons';",
                        "app_name='xaralx';
                        #imagemagick_home='/app/opt/imagemagick';
                        #imagemagick_lib=\"${imagemagick_home}/lib\";
                        #imagemagick_bin=\"${imagemagick_home}/bin\";
                        #if [[ -n \"${LD_LIBRARY_PATH}\" ]]; then
                        #    LD_LIBRARY_PATH=\"${LD_LIBRARY_PATH}:${imagemagick_lib}\";
                        #else
                        #    LD_LIBRARY_PATH=\"${imagemagick_lib}\";
                        #fi;
                        #export LD_LIBRARY_PATH;
                        #if [[ -n \"${PATH}\" ]]; then
                        #    PATH=\"${PATH}:${imagemagick_bin}\";
                        #else
                        #    PATH=\"${imagemagick_bin}\";
                        #fi;
                        #export PATH;
                        icon='xaralx.svg';
                        for s in {16,22,24,32,48,64,72,96,128,192,256,512}; do
                            size=\"${s}x${s}\";
                            echo \"- ${size}\";
                            mkdir -p \"icons/${size}/\";
                            convert -background none -density 1024 -resize \"${size}\" \"${icon}\" \"icons/${size}/${app_name}.png\";
                        done;"
                    ]
                },
                // make install
                {
                    "type": "shell",
                    "commands": [
                        "echo 'make install';",
                        "install -d '/app/bin';",
                        "make install;"
                    ]
                },
                // install
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install';",
                        "echo 'install: begin';

                        dos2unix_home='/app/opt/dos2unix';
                        dos2unix_bin=\"${dos2unix_home}/bin\";
                        if [[ -n \"${PATH}\" ]]; then
                            PATH=\"${PATH}:${dos2unix_bin}\";
                        else
                            PATH=\"${dos2unix_bin}\";
                        fi;
                        export PATH;
                        
                        ( cd '/app/bin' && ln -s 'XaraLX' xara && ln -s 'XaraLX' 'xaralx'; )
                        ( cd '/app/share' && ln -s 'xaralx' 'XaraLX'; )
                        
                        # /usr/share/xaralx/doc/xaralx/ is used by the application for online help
                        ( cd '/app/share/xaralx' && ln -s '/share/doc/xaralx/help' 'doc'; )
                        
                        install -D -m 644 'doc/en/LICENSE' '/app/share/doc/xaralx/help/LICENSE';
                        install -m 644 'XARFormatDocument.pdf' '/app/share/doc/xaralx';
                        
                        cp -a 'Designs' 'TextDesigns' 'Templates' 'filters/SVGFilter'/{tests,images,openclipart,samples} 'testfiles' '/app/share/xaralx';
                        cat 'doc/en/xaralxHelp.tar.gz' | ( cd '/app/share/doc/xaralx/help' ; tar zxvf -; )
                        
                        find '/app/share/doc' -type f -print0 | xargs -0 dos2unix -q -o;
                        find '/app/share' '/app/share/doc' -type f -print0 | xargs -0 chmod 644;
                        
                        perl -ape 's{((src|document.location\\s+)=.?\")}{$1help/}g;' < '/app/share/doc/xaralx/help/xaralx.htm' > '/app/share/doc/xaralx/help.html';
                        
                        install -m 644 'COPYING' 'LICENSE' 'README' 'MTRand.txt' 'doc/gifutil.txt' 'doc/XSVG.txt' '/app/share/doc/xaralx/';
                        
                        install -D -m 644 'doc/xaralx.1' '/app/share/man/man1/xaralx.1';
                        ( cd '/app/share/man/man1' && ln -s 'xaralx.1' 'XaraLX.1' && ln -s 'xaralx.1' 'xara.1'; )
                        
                        install -D -m 644 'xaralx.png' '/app/share/pixmaps/xaralx.png';
                        install -D -m 644 'xaralx.desktop' '/app/share/applications/xaralx.desktop';
                        chmod 755 '/app/share/xaralx/tests/makerandom.sh';

                        install -p -D -m 0644 'xaralx.appdata.xml' '/app/share/metainfo/xaralx.appdata.xml';

                        echo 'install: end';"
                    ]
                },
                // install docs
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install docs';",
                        "install -d '/app/share/doc/xaralx';
                        install -p -m 0644 'ABOUT-NLS' 'INSTALL' '/app/share/doc/xaralx/';
                        install -p -m 0644 'Pragmas.txt' '/app/share/doc/xaralx/';
                        install -p -m 0644 'ChangeLog' 'Doxyfile' 'NEWS' 'portnotes' '/app/share/doc/xaralx/';"
                    ]
                },
                // install licenses
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install licenses';",
                        "install -d '/app/share/licenses/xaralx';
                        install -p -m 0644 'COPYING' 'LICENSE' 'GPL' '/app/share/licenses/xaralx/';
                        install -p -m 0644 'libs/LIBS-LICENSE' '/app/share/licenses/xaralx/';"
                    ]
                },
                // install icons
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install icons';",
                        "find 'icons' -mindepth 2 -maxdepth 2 -type f -name 'xaralx.png' | sort -V | xargs -I{} dirname '{}' | xargs -I{} basename '{}' | while read -r size ; do
                            install -p -D -m 0644 \"icons/${size}/xaralx.png\" \"/app/share/icons/hicolor/${size}/apps/xaralx.png\";
                        done;"
                    ]
                },
                // install locales
                {
                    "type": "shell",
                    "commands": [
                        "echo 'install locales';",
                        "pushd 'po';
                            for f in *.mo; do
                                install -pD -m644 \"${f}\" \"/app/share/locale/${f%.mo}/LC_MESSAGES/XaraLX.mo\";
                            done;
                        popd;"
                    ]
                },
                // edit desktop file
                {
                    "type": "shell",
                    "commands": [
                        "echo 'edit desktop file';",
                        "app_name='xaralx';
                        app_id='org.xaraxtreme.XaraLX';
                        desktop-file-edit --set-key='Icon' --set-value=\"${app_name}\" '/app/share/applications/xaralx.desktop';
                        desktop-file-edit --set-key='FilePattern' --set-value=\"${app_name}\" '/app/share/applications/xaralx.desktop';
                        desktop-file-edit --set-key='TryExec' --set-value=\"${app_name}\" '/app/share/applications/xaralx.desktop';"
                    ]
                },
                // fake Makefile
                {
                    "type": "shell",
                    "commands": [
                        "echo 'backup old autotools files';",
                        "for filename in 'autogen' 'autogen.sh' 'configure' 'configure.ac' 'configure.in' 'install-sh' 'Makefile' 'Makefile.am' 'Makefile.in'; do
                            [[ -f \"${filename}\" ]] || continue;
                            mv \"${filename}\" \"${filename}.bak\";
                        done;",
                        "echo 'create empty Makefile';",
                        "echo '# Empty Makefile\n\nall:\n\techo \"Using an empty Makefile doing nothing\"\n\ninstall:\n\techo \"Using an empty Makefile doing nothing\"' > 'Makefile';"
                    ]
                }
            ],
            "post-install": [
                // metainfo - https://fedoraproject.org/wiki/Packaging:AppData
                "echo 'post-install: metainfo';",
                "if [[ ! -d '/app/share/metainfo' ]]; then
                    [[ -d '/app/share/appdata' ]] || exit 1;
                    mv '/app/share/appdata' '/app/share/metainfo';
                fi;",
                "echo 'setting up xmlstarlet';
                xmlstarlet_home='/app/opt/xmlstarlet';
                xmlstarlet_bin=\"${xmlstarlet_home}/bin\";
                if [[ -n \"${PATH}\" ]]; then
                    PATH=\"${PATH}:${xmlstarlet_bin}\";
                else
                    PATH=\"${xmlstarlet_bin}\";
                fi;
                export PATH;
                app_id='org.xaraxtreme.XaraLX';
                echo \"app_id: ${app_id}\";
                app_ver=\"$( grep -Ei '^[[:blank:]]*VERSION[[:blank:]]*=[[:blank:]]*([^[:blank:]]*)*[[:blank:]]*$' 'configure.bak' 2>/dev/null | tail -n 1 2>/dev/null | sed -re 's/^[[:blank:]]*VERSION[[:blank:]]*=[[:blank:]]*([^[:blank:]]*)*[[:blank:]]*$/\\1/' 2>/dev/null || :; )\";
                echo \"app_ver: ${app_ver}\";
                app_rev=\"$( grep -E 'DECLARE_SOURCE\\(\"\\$Revision: [0-9]+ \\$\"\\);' 'Kernel/snapops.cpp' 2>/dev/null | grep -Eo '[0-9]+' 2>/dev/null | head -n 1 2>/dev/null || :; )\";
                echo \"app_rev: ${app_rev}\";
                app_version='';
                if [[ -n \"${app_ver}\" ]]; then
                    app_version=\"${app_ver}\";
                    if [[ -n \"${app_rev}\" ]]; then
                        app_version+=\"r${app_rev}\";
                    fi;
                fi;
                echo \"app_version: ${app_version}\";
                app_date=\"$( date --reference 'ChangeLog' -u '+%Y-%m-%d' 2>/dev/null || :; )\";
                echo \"app_date: ${app_date}\";
                find '/app/share/metainfo' -mindepth 1 -maxdepth 1 -xtype f -name '*.appdata.xml' | sort -V | while read -r filename; do
                    if [[ -n \"${app_version}\" && -n \"${app_date}\" ]]; then
                        need_fix='0';
                        xmlstarlet sel -t -v '/component/releases/release/@version' \"${filename}\" || need_fix='1';
                        if [[ \"${need_fix}\" -ne \"0\" ]]; then
                            echo 'updating release info';
                            xmlstarlet ed --inplace -d '/component/releases' -s '/component' -t elem -n 'releases' -s '/component/releases' -t elem -n 'release' -s '/component/releases/release' -t attr -n 'version' -v \"${app_version}\" -s '/component/releases/release' -t attr -n 'date' -v \"${app_date}\" \"${filename}\";
                            xmlstarlet sel -t -c '/component/releases/release' \"${filename}\" | sed -re 's/$/\\n/' || :;
                        fi
                    fi;
                    if [[ -n \"${app_id}\" ]]; then
                        id=\"$( xmlstarlet sel -t -v '/component/id' \"${filename}\" 2>/dev/null | head -n 1 2>/dev/null || :; )\";
                        if [[ \"${id}\" != \"${app_id}.desktop\" ]]; then
                            xmlstarlet ed --inplace -d '/component/id' -s '/component' -t elem -n 'id' -v \"${app_id}.desktop\" \"${filename}\";
                        fi;
                        need_fix='0';
                        xmlstarlet sel -t -v '/component/launchable' \"${filename}\" || need_fix='2';
                        if [[ \"${need_fix}\" -ne \"0\" ]]; then
                            echo 'adding additional tags: launchable';
                            xmlstarlet ed --inplace -d '/component/launchable' -s '/component' -t elem -n 'launchable' -v \"${app_id}.desktop\" -s '/component/launchable' -t attr -n 'type' -v 'desktop-id' \"${filename}\";
                            xmlstarlet sel -t -c '/component/launchable' \"${filename}\" | sed -re 's/$/\\n/' || :;
                        fi;
                    fi;
                done;",
                // validate data
                "echo 'post-install: validate data';",
                "cat /app/share/applications/*.desktop;",
                "desktop-file-validate /app/share/applications/*.desktop || :;",
                "cat /app/share/metainfo/*.appdata.xml;",
                "appstream-util validate-relax --nonet /app/share/metainfo/*.appdata.xml || :;"
            ]
        }/*,
        // <Totem>
        // https://github.com/flathub/org.gnome.Totem/blob/master/org.gnome.Totem.json
        "shared-modules/lua5.3/lua-5.3.2.json",
        {
            "name": "libpeas",
            "cleanup": [ "/bin/*", "/lib/peas-demo" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/libpeas/1.22/libpeas-1.22.0.tar.xz",
                    "sha256": "5b2fc0f53962b25bca131a5ec0139e6fef8e254481b6e777975f7a1d2702a962"
                }
            ]
        },
        {
            "name": "gmime",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gmime/2.6/gmime-2.6.23.tar.xz",
                    "sha256": "7149686a71ca42a1390869b6074815106b061aaeaaa8f2ef8c12c191d9a79f6a"
                }
            ],
            "cleanup": [ "/include", "/share/vala" ]
        },
        {
            "name": "totem-pl-parser",
            "buildsystem": "meson",
            // Error: module totem-pl-parser: Meson does not support building in sourcedir, set "builddir" to true.
            "builddir": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/totem-pl-parser/3.26/totem-pl-parser-3.26.0.tar.xz",
                    "sha256": "f153a53391e9b42fed5cb6ce62322a58e323fde6ec4a54d8ba4d376cf4c1fbcb"
                }
            ],
            "cleanup": [ "/include" ]
        },
        {
            "name": "grilo",
            "config-opts": [ "--enable-grl-net", "--enable-grl-pls", "--disable-static" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/grilo/0.3/grilo-0.3.4.tar.xz",
                    "sha256": "7c6964053b42574c2f14715d2392a02ea5cbace955eb73e067c77aa3e43b066e"
                }
            ],
            "cleanup": [ "/include", "/bin" ]
        },
        {
            "name": "librest",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/rest/0.8/rest-0.8.1.tar.xz",
                    "sha256": "0513aad38e5d3cedd4ae3c551634e3be1b9baaa79775e53b2dba9456f15b01c9"
                }
            ]
        },
        {
            "name": "gnome-online-accounts",
            "config-opts": [ "--disable-telepathy", "--disable-documentation", "--disable-backend" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gnome-online-accounts/3.26/gnome-online-accounts-3.26.0.tar.xz",
                    "sha256": "5cab736751c19efca762c0459e3358255d6662a6f4f27728cd02ea7b024e52ac"
                }
            ]
        },
        {
            "name": "liboauth",
            "sources": [
                {
                    "type": "archive",
                    "url": "http://netix.dl.sourceforge.net/project/liboauth/liboauth-1.0.3.tar.gz",
                    "sha256": "0df60157b052f0e774ade8a8bac59d6e8d4b464058cc55f9208d72e41156811f"
                }
            ]
        },
        {
            "name": "libgdata",
            "config-opts": [ "--disable-always-build-tests", "--disable-Werror", "--disable-static" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/libgdata/0.17/libgdata-0.17.9.tar.xz",
                    "sha256": "85c4f7674c0098ffaf060ae01b6b832cb277b3673d54ace3bdedaad6b127453a"
                }
            ]
        },
        {
            "name": "gom",
            "buildsystem": "meson",
            // Error: module gom: Meson does not support building in sourcedir, set "builddir" to true.
            "builddir": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gom/0.3/gom-0.3.3.tar.xz",
                    "sha256": "ac57e34b5fe273ed306efaeabb346712c264e341502913044a782cdf8c1036d8"
                }
            ]
        },
        {
            "name": "tracker",
            "cleanup": [ "/bin", "/etc", "/libexec" ],
            "config-opts": [ "--disable-miner-apps", "--disable-static",
                             "--with-bash-completion-dir=no",
                             "--disable-tracker-extract", "--disable-tracker-needle",
                             "--disable-tracker-preferences", "--disable-artwork",
                             "--disable-tracker-writeback", "--disable-miner-user-guides"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/tracker/1.12/tracker-1.12.4.tar.xz",
                    "sha256": "b33c2ff730bafaffb34cab79d29d50392426f02d29d1690c4f6d384ff60a358d"
                }
            ]
        },
        {
            "name": "libmediaart",
            "cleanup": [ "/bin", "/etc", "/libexec" ],
            "config-opts": [ "--disable-qt" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/libmediaart/1.9/libmediaart-1.9.4.tar.xz",
                    "sha256": "a57be017257e4815389afe4f58fdacb6a50e74fd185452b23a652ee56b04813d"
                }
            ]
        },
        {
            "name": "avahi",
            "cleanup": [ "/bin" ],
            "config-opts": [
                "--with-distro=none",
                "--enable-gobject",
                "--with-xml=expat",
                "--disable-libdaemon",
                "--disable-core-docs",
                "--disable-manpages",
                "--disable-mono",
                "--disable-qt3",
                "--disable-qt4",
                "--disable-python",
                "--disable-gtk",
                "--disable-gtk3"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://avahi.org/download/avahi-0.6.31.tar.gz",
                    "sha256": "8372719b24e2dd75de6f59bb1315e600db4fd092805bd1201ed0cb651a2dab48"
                },
                {
                    "type": "shell",
                    "commands": [
                        "cp -f /usr/share/gnu-config/config.sub .",
                        "cp -f /usr/share/gnu-config/config.guess ."
                    ]
                }
            ]
        },
        // XXX Remove the Lua sources we won't use
        {
            "name": "grilo-plugins",
            "config-opts": [ "--enable-goa", "--enable-filesystem", "--enable-optical-media", "--enable-youtube", "--enable-bookmarks", "--enable-lua-factory", "--enable-metadata-store", "--enable-vimeo", "--enable-tracker", "--enable-localmetadata", "--enable-dleyna", "--enable-thetvdb", "--enable-tmdb", "--enable-freebox", "--enable-opensubtitles" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/grilo-plugins/0.3/grilo-plugins-0.3.5.tar.xz",
                    "sha256": "2977827b8ecb3e15535236180e57dc35e85058d111349bdb6a1597e62a5068fb"
                }
            ],
            "cleanup": [ "/include" ]
        },
        {
            "name": "gnome-desktop",
            "config-opts": ["--disable-debug-tools", "--disable-udev"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gnome-desktop/3.26/gnome-desktop-3.26.2.tar.xz",
                    "sha256": "f7561a7a313fc474b2c390cd9696df1f5c1e1556080e43f4afe042b1060e5f2a"
                }
            ]
        },
        {
            "name": "totem",
            "buildsystem": "meson",
            // Error: module totem: Meson does not support building in sourcedir, set "builddir" to true.
            "builddir": true,
            // TODO: Vala plugins didn't build for some reason. Look into this
            "config-opts": ["-Denable-vala=no"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/totem/3.26/totem-3.26.0.tar.xz",
                    "sha256": "e32fb9a68097045e75c87ad1b8177f5c01aea2a13dcb3b2e71a0f9570fe9ee13"
                }
            ]
        }
        // </Totem>
        //*/
    ],
    "cleanup": [
        //"/cache",
        "/include",
        //"/lib/pkgconfig",
        "/share/cmake",
        //"/man",
        //"/share/man",
        //"/share/bash-completion"
        "/lib/systemd",
        "/opt",
        "*.la",
        "*.a"
    ]
}

