app-id: com.github.stakira.OpenUtau
runtime: org.freedesktop.Platform
runtime-version: '22.08'
sdk: org.freedesktop.Sdk
command: OpenUtau
finish-args:
  - --share=ipc
  - --socket=x11
  - --filesystem=home #OpenUtau doesn't use portals. https://github.com/stakira/OpenUtau/issues/548
  - --socket=pulseaudio
modules:

  - name: OpenUtau
    buildsystem: simple
    build-commands:
      - mkdir -p /app/bin/
      - mv * /app/bin/
      - chmod +x /app/bin/OpenUtau

    sources:
      - type: archive #I'd like to build from source, but it doesn't seem to work properly and I can't figure out how to make it build for both aarch64 and x86/
        url: https://github.com/stakira/OpenUtau/releases/download/build%2F0.0.991/OpenUtau-linux-x64.tar.gz
        sha256: cdfdec083015f902a543a701b0c885d636e52847c177ddf89aae2b3fe845b723
        x-checker-data:
          type: json
          url: https://api.github.com/repos/stakira/OpenUtau/releases/latest
          version-query: .tag_name | sub("^v"; "")
          url-query: .assets[] | select(.name=="OpenUtau-linux-x64.zip")
            | .browser_download_url


#I'll get right on adding the metadata and .desktop file when https://github.com/stakira/OpenUtau/pull/549 is merged!
