app-id: com.github.reduz.ChibiTracker
runtime: org.freedesktop.Platform
runtime-version: 1.6
sdk: org.freedesktop.Sdk
command: chibitracker
finish-args:
  - --socket=x11
  - --share=ipc
  - --socket=pulseaudio
  - --filesystem=host

build-options:
  - env:
    - PREFIX": /app

modules:
  - shared-modules/SDL/SDL-1.2.15.json
  - name: scons
    buildsystem: simple
    cleanup: '*'
    build-commands:
      - python setup.py install --prefix=/app
    sources:
      - type: archive
        url: http://prdownloads.sourceforge.net/scons/scons-3.0.1.tar.gz
        sha256: 24475e38d39c19683bc88054524df018fe6949d70fbd4c69e298d39a0269f173

  - name: chibitracker
    buildsystem: simple
    build-commands:
      - scons
      - scons install prefix=/app
      - install -Dm644 com.github.reduz.ChibiTracker.appdata.xml /app/share/appdata/com.github.reduz.ChibiTracker.appdata.xml
      - install -Dm644 com.github.reduz.ChibiTracker.desktop /app/share/applications/com.github.reduz.ChibiTracker.desktop
      - install -Dm644 program/cticon.png /app/share/icons/hicolor/32x32/apps/com.github.reduz.ChibiTracker.png
    sources:
      - type: git
        url: https://github.com/reduz/chibitracker.git
        commit: 8decc22858275845a53a313bf06f38f6aa62ec3f
      - type: file
        path: com.github.reduz.ChibiTracker.desktop
      - type: file
        path: com.github.reduz.ChibiTracker.appdata.xml

cleanup:
  - /bin/scons*
  - /man
  - /lib/scons*
