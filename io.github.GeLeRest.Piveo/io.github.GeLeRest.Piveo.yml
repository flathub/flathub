app-id: io.github.GeLeRest.Piveo
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk

command: piveo

finish-args:
  - --share=network
  - --filesystem=home

modules:
  - name: piveo
    buildsystem: simple
    build-commands:
      - chmod +x Piveo_1.2.0_x86_64.AppImage
      - ./Piveo_1.2.0_x86_64.AppImage --appimage-extract

      # Fix desktop file for Flatpak
      - sed -i 's/^Exec=.*/Exec=piveo/' squashfs-root/*.desktop
      - sed -i 's/^Icon=.*/Icon=io.github.GeLeRest.Piveo/' squashfs-root/*.desktop

      - install -Dm755 squashfs-root/AppRun /app/bin/piveo
      - install -Dm644 squashfs-root/*.desktop /app/share/applications/io.github.GeLeRest.Piveo.desktop
      - install -Dm644 squashfs-root/*.png /app/share/icons/hicolor/256x256/apps/io.github.GeLeRest.Piveo.png

    sources:
      - type: file
        url: https://github.com/GerardLeRest/Piveo/releases/download/v1.2.0/Piveo_1.2.0_x86_64.AppImage
        sha256: 17c404d8f909fecfd12c99c9e5f29c8f6c9b6f804a2b1bfc9f92c100adc35363

