app-id: io.github.tlcfem.suanPan
runtime: org.freedesktop.Platform
runtime-version: '22.08'
sdk: org.freedesktop.Sdk
command: suanPan
finish-args:
  - '--filesystem=home'
  - '--socket=fallback-x11'
  - '--device=dri'
  - '--socket=wayland'
  - '--share=ipc'
cleanup:
  - /vtk
modules:
  - name: suanPan
    buildsystem: cmake
    builddir: true
    config-opts:
      - '-DCMAKE_BUILD_TYPE=Release'
      - '-DBUILD_MULTITHREAD=ON'
      - '-DUSE_HDF5=ON'
      - '-DUSE_EXTERNAL_VTK=ON'
      - '-DVTK_DIR=/app/vtk/lib/cmake/vtk-9.2/'
    sources:
      - type: git
        url: 'https://github.com/TLCFEM/suanPan.git'
        tag: 'suanPan-v2.6.1'
    modules:
      - name: vtk
        buildsystem: simple
        builddir: true
        build-commands:
          - mkdir /app/vtk
          - cp -r * /app/vtk/
        sources:
          - type: archive
            url: >-
              https://github.com/TLCFEM/prebuilds/releases/download/latest/VTK-9.2.2-linux.tar.gz
            sha256: 1660e715778b535339fc322eb8ca73a5759055968ca3236d4df4413fe393bec6
      - name: metainfo
        buildsystem: simple
        build-commands:
          - mkdir -p /app/share/metainfo/
          - echo -e "<?xml version=\"1.0\" encoding=\"UTF-8\"?><component><id>io.github.tlcfem.suanPan</id><name>suanPan</name><metadata_license>CC-BY-SA-4.0</metadata_license><summary>ðŸ§® An Open Source, Parallel and Heterogeneous Finite Element Analysis Framework</summary><icon type=\"remote\" width=\"256\" height=\"256\">https://raw.githubusercontent.com/TLCFEM/suanPan/dev/Resource/suanPan-ua.svg</icon><categories><category>Science</category><category>Education</category></categories><url type=\"homepage\">https://github.com/TLCFEM/suanPan</url><screenshots><screenshot type=\"default\"><caption>The application</caption><image type=\"source\" width=\"1198\" height=\"608\">https://asciinema.org/a/491330.svg</image></screenshot></screenshots></component>" >/app/share/metainfo/io.github.tlcfem.suanPan.metainfo.xml
      - name: icon
        buildsystem: simple
        build-commands:
          - mkdir -p /app/share/icons/hicolor/128x128/apps/
          - mkdir -p /app/share/applications/
          - install -Dm644 suanPan-ua.svg /app/share/icons/hicolor/128x128/apps/io.github.tlcfem.suanPan.svg
          - echo -e "[Desktop Entry]\nExec=\nVersion=2.6.1\nType=Application\nIcon=io.github.tlcfem.suanPan\nCategories=Science\nName=suanPan\nTerminal=true\n" >/app/share/applications/io.github.tlcfem.suanPan.desktop
        sources:
          - type: file
            url: >-
              https://raw.githubusercontent.com/TLCFEM/suanPan/dev/Resource/suanPan-ua.svg
            sha256: 583d974d4e20f07d61a513b43c3a5a973323dc8a5de20514d365e95f770695bc
