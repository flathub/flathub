app-id: uk.co.parallelrealities.games.edgar
runtime: org.freedesktop.Platform
runtime-version: 22.08
sdk: org.freedesktop.Sdk
command: edgar
rename-icon: edgar
rename-desktop-file: edgar.desktop
rename-appdata-file: edgar.appdata.xml
finish-args:
  - --socket=wayland
  - --socket=pulseaudio
  - --socket=fallback-x11
  - --device=dri
  - --share=ipc

modules:
  - name: edgar
    buildsystem: autotools
    no-autogen: true
    sources:
      - type: git
        url: https://github.com/riksweeney/edgar
        tag: 1.35
        commit: 3bfd7a1ba3b6b46414ebf5fad39cc70237f75611
        x-checker-data:
          type: git
          tag-pattern: ^([\d.]+)$
      - type: shell
        commands:
          - sed -i -e 's|/usr|${FLATPAK_DEST}|' makefile
          - sed -i -e 's|$(PREFIX)/games/|$(PREFIX)/bin/|' makefile
      - type: patch
        path: appdata.patch
      - type: patch
        path: icon.patch
        use-git: true
