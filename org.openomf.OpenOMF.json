{
  "app-id": "org.openomf.OpenOMF",
  "runtime": "org.freedesktop.Platform",
  "runtime-version": "24.08",
  "sdk": "org.freedesktop.Sdk",
  "command": "openomf",
  "permissions": [
      "xdg-config",
      "xdg-state"
  ],
  "finish-args": [
    "--share=network",
    "--socket=wayland",
    "--socket=fallback-x11",
    "--share=ipc",
    "--device=dri",
    "--socket=pulseaudio"
  ],
  "modules": [
    {
      "name": "libxmp",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/libxmp/libxmp",
          "tag": "libxmp-4.6.1"
        }
      ],
      "config-opts": [
          "-DBUILD_STATIC=ON",
          "-DBUILD_SHARED=OFF"
      ],
      "cleanup": [
        "/include",
        "/share/doc",
        "*.a",
        "*.la"
      ]
    },
    {
      "name": "argtable3",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/argtable/argtable3",
          "tag": "v3.2.2.f25c624"
        }
      ],
      "config-opts": [
          "-DARGTABLE3_ENABLE_EXAMPLES=OFF"
      ],
      "cleanup": [
        "/include",
        "/share/doc",
        "*.a",
        "*.la"
      ]
    },
    {
      "name": "enet",
      "buildsystem": "autotools",
      "sources": [
        {
          "type": "archive",
          "url": "http://enet.bespin.org/download/enet-1.3.18.tar.gz",
          "sha256": "2a8a0c5360d68bb4fcd11f2e4c47c69976e8d2c85b109dd7d60b1181a4f85d36"
        }
      ],
    "make-install-args": "PREFIX=/app",
      "cleanup": [
        "/include",
        "/share/doc",
        "*.a",
        "*.la"
      ]
    },
    {
      "name": "confuse",
      "buildsystem": "autotools",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/libconfuse/libconfuse",
          "tag": "v3.3"
        }
      ],
    "make-install-args": "PREFIX=/app",
      "cleanup": [
        "/include",
        "/share/doc",
        "*.a",
        "*.la"
      ]
    },
    {
      "name": "miniupnpc",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/transmission/miniupnpc",
          "tag": "miniupnpc_2_3_0"
        }
      ],
      "config-opts": [
          "-DUPNPC_BUILD_STATIC=TRUE",
          "-DUPNPC_BUILD_SHARED=FALSE",
          "-DUPNPC_BUILD_SAMPLE=FALSE"
      ],
      "cleanup": [
        "/bin",
        "/include",
        "/share/doc",
        "*.a",
        "*.la"
      ]
    },
    {
      "name": "libnatpmp",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/miniupnp/libnatpmp",
          "commit": "8257134a5dcb077e40db1946554d676e444406e4"
        }
      ],
      "build-commands": [
        "install -m644 natpmp_declspec.h ${FLATPAK_DEST}/include"
      ],
      "cleanup": [
        "/bin",
        "/include",
        "/share/doc",
        "*.a",
        "*.la"
      ]
    },
    {
        "name": "omf2097-data",
        "buildsystem": "simple",
        "sources": [
            {
            "type": "archive",
            "url": "https://www.omf2097.com/pub/files/omf/omf2097-assets.zip",
            "sha256": "de472c786adf9e618bf4b71a5f2cb85bb0b090f27da2b3008f305453a8dea67d"
            }
        ],
        "build-commands": [
            "install -Dm644 -t ${FLATPAK_DEST}/share/games/openomf/ *.BK",
            "install -Dm644 -t ${FLATPAK_DEST}/share/games/openomf/ *.TRN",
            "install -Dm644 -t ${FLATPAK_DEST}/share/games/openomf/ *.AF",
            "install -Dm644 -t ${FLATPAK_DEST}/share/games/openomf/ *.PIC",
            "install -Dm644 -t ${FLATPAK_DEST}/share/games/openomf/ *.PSM",
            "install -Dm644 -t ${FLATPAK_DEST}/share/games/openomf/ *.DAT",
            "install -Dm644 -t ${FLATPAK_DEST}/share/games/openomf/ *.PCX"
        ]
    },
    {
      "name": "openomf",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/omf2097/OpenOMF.git",
          "commit": "45989d575c04233485edd12b643442d700614e73"
        }
      ],
      "config-opts": [
          "-DUSE_MINIUPNPC=YES",
          "-DUSE_NATPMP=YES"
      ],
      "build-commands": [
        "install -Dm644 resources/flatpak/org.openomf.OpenOMF.metainfo.xml -t ${FLATPAK_DEST}/share/metainfo",
        "install -Dm644 resources/flatpak/org.openomf.OpenOMF.desktop -t ${FLATPAK_DEST}/share/applications",
        "install -Dm644 resources/icons/openomf.png ${FLATPAK_DEST}/share/icons/hicolor/64x64/apps/org.openomf.OpenOMF.png",
        "install -Dm644 resources/icons/openomf-48x48.png ${FLATPAK_DEST}/share/icons/hicolor/48x48/apps/org.openomf.OpenOMF.png",
        "install -Dm644 resources/icons/openomf-128x128.png ${FLATPAK_DEST}/share/icons/hicolor/128x128/apps/org.openomf.OpenOMF.png"
      ],

      "cleanup": [
        "/include",
        "/share/doc",
        "*.a",
        "*.la"
      ]
    }
  ]
}
