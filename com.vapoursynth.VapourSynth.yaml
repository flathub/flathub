name: vapoursynth
# config-opts:
#   --with-plugindir=DEFAULT/PLUGIN/DIR
modules:
  - name: cython
    buildsystem: simple
    build-commands:
      - python3 setup.py install --prefix=/app
    cleanup:
      - '*'
    sources:
      - type: archive
        url: https://github.com/cython/cython/archive/0.29.1.tar.gz
        sha256: fab6796e5a5fb6e2f860c7d8180479dade01dfbebaf490a213c3e312a3a278d8

  - name: libass
    config-opts:
      - --disable-static
      - --enable-asm
      - --enable-harfbuzz
      - --enable-fontconfig
    modules:
      - name: fribidi
        buildsystem: meson
        config-opts:
          - -Ddocs=false
        sources:
          - type: archive
            url: https://github.com/fribidi/fribidi/archive/v1.0.5.tar.gz
            sha256: aee3a93d081c293eaca9157700f17dc780a0b6674bc911decc5aaa43aec9abd7
    sources:
      - type: archive
        url: https://github.com/libass/libass/releases/download/0.14.0/libass-0.14.0.tar.xz
        sha256: 881f2382af48aead75b7a0e02e65d88c5ebd369fe46bc77d9270a94aa8fd38a2
      - type: script
        dest-filename: autogen.sh
        commands:
          - autoreconf -fiv

  - name: zimg
    config-opts:
      - --disable-static
    sources:
      - type: archive
        url: https://github.com/sekrit-twc/zimg/archive/release-2.8.tar.gz
        sha256: a8f9d65c95ce6e8050d83d0417b109aabc94d2c7ba65cf2d8039840d162ad876

  - name: tesseract
    config-opts:
      - --disable-static
    modules:
      - name: leptonica
        config-opts:
          - --disable-static
          - --with-pic
        sources:
          - type: archive
            url: http://www.leptonica.com/source/leptonica-1.76.0.tar.gz
            sha256: 5e9a33b7ce33ab39fb03cee5a7ec353b044670176303265d7c64d51539616857
    sources:
      - type: archive
        url: https://github.com/tesseract-ocr/tesseract/archive/4.0.0.tar.gz
        sha256: a1f5422ca49a32e5f35c54dee5112b11b99928fc9f4ee6695cdc6768d69f61dd

  - name: imagemagick
    config-opts:
      - --disable-static
      - --disable-docs
      - --with-hdri
      - --with-pic
    modules:
      - name: fftw3
        config-opts:
          - --enable-shared
          - --enable-threads
          - --enable-openmp
          - --disable-fortran
        sources:
          - type: archive
            url: http://fftw.org/fftw-3.3.8.tar.gz
            md5: 8aac833c943d8e90d51b697b27d4384d
        cleanup:
          - /bin
    sources:
      - type: archive
        url: https://imagemagick.org/download/ImageMagick-7.0.8-15.tar.xz
        sha256: f635b9e4535a165862a49e18239b4da44d7ccf190dcb630ddae94e5a3dc2d0a4
sources:
  - type: archive
    url: https://github.com/vapoursynth/vapoursynth/archive/R45.1.tar.gz
    sha256: 4f43e5bb8c4817fdebe572d82febe4abac892918c54e1cb71aa6f6eb3677a877
