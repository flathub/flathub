{
    "name": "retext",
    "no-autogen": true,
    "sources": [
        {
            "type": "archive",
            "url": "https://files.pythonhosted.org/packages/01/70/aa870c2222be0ffe6efc700d9eb4f9125164b04e017a00f9302774ad62b2/ReText-7.0.3.tar.gz",
            "sha256": "e549697c9b7254930c8529e5b1d44155980fcd3d182d95be39b01387af71673c"
        },
        {
            "type": "archive",
            "url": "https://github.com/mquinson/po4a/archive/v0.52.tar.gz",
            "sha256": "547c410ad3bb8e5fd3939a6acdd39713529187be05fca7235095d57d3f0c6cfc",
            "strip-components": 0
        },
        {
            "type": "file",
            "path": "retext-man-de.po",
            "sha256": "9b00b30a693a3023b2f5619ab0586ddf9bd8f5bc9b75c2dabd5d6493558bb6f7"
        },
        {
            "type": "file",
            "path": "retext.1",
            "sha256": "300f04c1f808f63351b16ed0fa0f2d01b857c4d096ed71dcf54ab95281727d9a"
        },
        {
            "type": "shell",
            "commands": [
                "echo 'disabling external renderer';",
                "cp 'ReText/window.py' 'ReText/window.py.bak';",
                "cp 'ReText/tab.py' 'ReText/tab.py.bak';",
                "sed -r -i 's/^([[:blank:]]*)(menuEdit\\.addAction\\(self\\.(actionWebKit|actionWebEngine)\\))([[:blank:]]*)$/\\1pass #\\2\\4/' 'ReText/window.py';",
                "sed -r -i 's/^([[:blank:]]*)(globalSettings\\.(useWebKit|useWebEngine)[[:blank:]]*=[[:blank:]]*)(enable)([[:blank:]]*)$/\\1\\2False\\5/' 'ReText/window.py';",
                "sed -r -i 's/^(([[:blank:]]*)(if ReTextWebKitPreview and globalSettings\\.useWebKit:)([[:blank:]]*))$/\\2return ReTextPreview\\(self\\)\\n\\1/' 'ReText/tab.py';",
                "echo 'ReText/window.py';",
                "diff 'ReText/window.py.bak' 'ReText/window.py' -C 4 || :;",
                "echo 'ReText/tab.py';",
                "diff 'ReText/tab.py.bak' 'ReText/tab.py' -C 4 || :;",
                "rm -f 'ReText/window.py.bak' 'ReText/tab.py.bak';"
            ]
        },
        {
            "type": "file",
            "path": "retext_setup.bash"
        },
        {
            "type": "file",
            "path": "retext_pre-install.bash"
        },
        {
            "type": "file",
            "path": "retext_post-install.bash"
        },
        {
            "type": "shell",
            "commands": [
                "echo 'flatpak scripts: create & edit';",
                "./retext_pre-install.bash;",
                "echo;"
            ]
        },
        {
            "type": "file",
            "path": "empty-Makefile",
            "dest-filename": "Makefile",
            "sha256": "700c973913ef94b5b9762617abb2b9be2e9b04b8a3e5ae98906f8299b826f9d4"
        },
        {
            "type": "shell",
            "commands": [
                "python3 setup.py build; python3 setup.py install -O1 --skip-build --prefix=/app --root=/;"
            ]
        }
    ],
    "post-install": [
        "echo 'flatpak scripts: install & check';",
        "cd '/run/build/retext'; ./retext_post-install.bash;",
        "echo;"
    ]
}
