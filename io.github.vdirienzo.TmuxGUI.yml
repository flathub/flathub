app-id: io.github.vdirienzo.TmuxGUI
runtime: org.gnome.Platform
runtime-version: '49'
sdk: org.gnome.Sdk
command: tmuxgui

finish-args:
  # Display
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  # All devices (required for PTY/terminal)
  - --device=all
  # Home directory access
  - --filesystem=home
  # Tmp for tmux sockets
  - --filesystem=/tmp
  # Run directory for tmux socket
  - --filesystem=xdg-run/tmux
  # Session bus
  - --socket=session-bus
  - --talk-name=org.freedesktop.Flatpak

modules:
  # VTE terminal library (GTK4 version)
  - name: vte
    buildsystem: meson
    config-opts:
      - -Ddocs=false
      - -Dvapi=false
      - -Dgtk4=true
      - -Dgtk3=false
      - -Dgir=true
    sources:
      - type: archive
        url: https://download.gnome.org/sources/vte/0.78/vte-0.78.0.tar.xz
        sha256: 07f09c6228a8bb3c1599dd0f5a6ec797b30d3010c3ac91cf21b69d9635dfaf7c

  # Main application (uses host tmux via flatpak-spawn)
  - name: tmuxgui
    buildsystem: simple
    build-commands:
      - mkdir -p /app/share/tmuxgui
      - cp -r src/gnome_tmux /app/share/tmuxgui/
      - cp run.py /app/share/tmuxgui/
      - install -Dm755 tmuxgui.sh /app/bin/tmuxgui
      - install -Dm644 data/io.github.vdirienzo.TmuxGUI.desktop /app/share/applications/io.github.vdirienzo.TmuxGUI.desktop
      - install -Dm644 data/io.github.vdirienzo.TmuxGUI.metainfo.xml /app/share/metainfo/io.github.vdirienzo.TmuxGUI.metainfo.xml
      - install -Dm644 data/icons/hicolor/48x48/apps/io.github.vdirienzo.TmuxGUI.png /app/share/icons/hicolor/48x48/apps/io.github.vdirienzo.TmuxGUI.png
      - install -Dm644 data/icons/hicolor/64x64/apps/io.github.vdirienzo.TmuxGUI.png /app/share/icons/hicolor/64x64/apps/io.github.vdirienzo.TmuxGUI.png
      - install -Dm644 data/icons/hicolor/128x128/apps/io.github.vdirienzo.TmuxGUI.png /app/share/icons/hicolor/128x128/apps/io.github.vdirienzo.TmuxGUI.png
      - install -Dm644 data/icons/hicolor/512x512/apps/io.github.vdirienzo.TmuxGUI.png /app/share/icons/hicolor/512x512/apps/io.github.vdirienzo.TmuxGUI.png
    sources:
      - type: dir
        path: .
