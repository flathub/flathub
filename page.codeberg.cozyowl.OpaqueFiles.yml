id: page.codeberg.cozyowl.OpaqueFiles
runtime: org.freedesktop.Platform
runtime-version: '25.08'
sdk: org.freedesktop.Sdk
command: opaquefiles
sdk-extensions:
  - org.freedesktop.Sdk.Extension.openjdk17
finish-args:
  - --share=ipc
  - --socket=x11
  - --filesystem=host
  - --env=PATH=/usr/bin:/app/bin:/app/jre/bin
modules:
  - name: openjdk
    buildsystem: simple
    build-commands:
      - /usr/lib/sdk/openjdk17/install.sh
  - name: opaquefiles
    buildsystem: simple
    build-commands:
      - install -D -m0555 opaquefiles /app/bin/opaquefiles
      - install -D -m0555 OpaqueFiles/packaging/releases/opaquefiles-0.9.9.3.jar /app/share/opaquefiles.jar
      - install -D -m0444 OpaqueFiles/documentation/design/page.codeberg.cozyowl.OpaqueFiles.svg /app/share/icons/hicolor/scalable/apps/page.codeberg.cozyowl.OpaqueFiles.svg
      - install -D -m0644 OpaqueFiles/packaging/shared/page.codeberg.cozyowl.OpaqueFiles.desktop /app/share/applications/page.codeberg.cozyowl.OpaqueFiles.desktop
      - install -D -m0644 OpaqueFiles/packaging/shared/opaqueFiles.properties /etc/opaqueFiles.properties
      - install -D -m0644 OpaqueFiles/packaging/shared/opaquefiles.xml /app/share/mime/packages/page.codeberg.cozyowl.OpaqueFiles.xml
      - install -D -m0644 OpaqueFiles/packaging/flatpak/flathub/page.codeberg.cozyowl.OpaqueFiles.metainfo.xml /app/share/metainfo/page.codeberg.cozyowl.OpaqueFiles.metainfo.xml
    sources:
      - type: script
        dest-filename: opaquefiles
        commands:
          - exec java -XX:MaxRAMPercentage=75 -jar /app/share/opaquefiles.jar "$@"
      - type: git
        url: https://codeberg.org/cozyOwl/OpaqueFiles.git
        commit: c8286ee8c5030080f3996fe26c33ac8b2198ed47
        dest: OpaqueFiles
