app-id: io.gitlab.gjwu.pdf-tinkerer
runtime: org.freedesktop.Platform
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.openjdk
command: PDF-Tinkerer-runner
rename-desktop-file: PDF-Tinkerer.desktop
finish-args:
  - --socket=x11
  - --share=ipc
  - --share=network
  - --device=dri
  - --persist=.pdf
  - --filesystem=home
modules:
  - name: openjdk
    buildsystem: simple
    build-commands:
      - /usr/lib/sdk/openjdk/install.sh
  - name: PDF-Tinkerer
    buildsystem: simple
    build-commands:
      - install -Dm755 PDF-Tinkerer-11-minimal.jar /app/lib/PDF-Tinkerer-11-minimal.jar
      - unzip -q -j -d sdk sdk.zip '*lib/*'
      - mv sdk /app/lib/sdk
      - install -Dm755 PDF-Tinkerer-runner /app/bin/PDF-Tinkerer-runner
      - install -Dm755 PDF-Tinkerer.desktop /app/lib/PDF-Tinkerer.desktop
      - desktop-file-edit --set-key=Exec --set-value='PDF-Tinkerer-runner' /app/lib/PDF-Tinkerer.desktop
      - desktop-file-edit --set-key=Categories --set-value='Office;' /app/lib/PDF-Tinkerer.desktop
      - install -Dm644 io.gitlab.gjwu.pdf-tinkerer.svg /app/share/icons/hicolor/scalable/apps/io.gitlab.gjwu.pdf-tinkerer.svg
      - desktop-file-edit --set-icon=io.gitlab.gjwu.pdf-tinkerer /app/lib/PDF-Tinkerer.desktop
      - desktop-file-install /app/lib/PDF-Tinkerer.desktop --dir=/app/share/applications
      - install -Dm644 io.gitlab.gjwu.pdf-tinkerer.metainfo.xml /app/share/metainfo/io.gitlab.gjwu.pdf-tinkerer.metainfo.xml
    sources:
      - type: file
        dest-filename: PDF-Tinkerer-11-minimal.jar
        url: https://gitlab.com/gjwu/pdf-tinkerer/-/package_files/198380065/download
        sha256: f8ceee016ef81e60daafe25ee8c74fedbd2a55b7edf7d062137f7fe19599ba5d
      - type: file
        dest-filename: sdk.zip
        url: https://download2.gluonhq.com/openjfx/24.0.1/openjfx-24.0.1_linux-x64_bin-sdk.zip
        sha256: e12e18292b2aab45517fffa63cc6e442259b9889f4cb7ac21c61e88f2f529942
        only-arches:
          - x86_64
      - type: file
        dest-filename: sdk.zip
        url: https://download2.gluonhq.com/openjfx/24.0.1/openjfx-24.0.1_linux-aarch64_bin-sdk.zip
        sha256: d0e4b6888ecd150a94d9fa1975fada6f4357b28471ddd9d26cf25f7ef8956733
        only-arches:
          - aarch64
      - type: file
        path: io.gitlab.gjwu.pdf-tinkerer.metainfo.xml
      - type: file
        path: io.gitlab.gjwu.pdf-tinkerer.svg
      - type: file
        path: PDF-Tinkerer.desktop
      - type: script
        dest-filename: PDF-Tinkerer-runner
        commands:
          - exec /app/jre/bin/java --module-path /app/lib/sdk --add-modules javafx.web,javafx.fxml,javafx.swing,javafx.media
            --add-opens=javafx.fxml/javafx.fxml=ALL-UNNAMED -cp /app/lib/PDF-Tinkerer-11-minimal.jar
            pdf_tinkerer.PDFTinkerer $@
