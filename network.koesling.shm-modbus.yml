id: network.koesling.shm-modbus
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
command: shm-modbus
finish-args:
  - --device=shm
  - --share=network
modules:
  - name: Modbus_TCP_client_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.2.2
        commit: a9ac4222771f15f2161de22b0ae9c56ada532268
        url: https://github.com/NikolasK-source/modbus_tcp_client_shm.git

  - name: Modbus_RTU_client_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v0.2.2
        commit: 74dc622c296b5da099d652fdf067dccc8bcb5b18 
        url: https://github.com/NikolasK-source/modbus_rtu_client_shm.git

  - name: write_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v0.1.3
        commit: bc58b820a79fd00a699835acbfb23f8870c7a528 
        url: https://github.com/NikolasK-source/write_shm.git

  - name: SHM_random
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.0.5
        commit: 95c72b58cc2fc73447c7abae07622af1219b7f08 
        url: https://github.com/NikolasK-source/shared_mem_random.git

  - name: dump_shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.0.2
        commit: b39922ac9dbb3b37a73ffc0eed3c56582d0c50e9 
        url: https://github.com/NikolasK-source/dump_shm.git

  - name: stdin-to-modbus-shm
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DCLANG_FORMAT=OFF
      - -DCOMPILER_WARNINGS=OFF

    sources:
      - type: git
        tag: v1.1.0
        commit: 04e98cc0f17fa24643fdfefd9b0f5cb79236df92 
        url: https://github.com/NikolasK-source/stdin_to_modbus_shm.git

  - name: launch_scripts_and_metadata
    buildsystem: simple
    build-commands:
      - install -D -m 755 shm-modbus ${FLATPAK_DEST}/bin/shm-modbus
      - install -D -m 644 guided-commands.sh ${FLATPAK_DEST}/bin/guided-commands.sh
      - install -D -m 644 manual-commands.sh ${FLATPAK_DEST}/bin/manual-commands.sh

      - install -D -m 644 network.koesling.shm-modbus.metainfo.xml "${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml"
      - install -D -m 644 -t "${FLATPAK_DEST}/share/icons/hicolor/scalable/apps" ${FLATPAK_ID}.svg
      - install -D -m 644 ${FLATPAK_ID}_256.png "${FLATPAK_DEST}/share/icons/hicolor/256x256/apps/${FLATPAK_ID}.png"
      - install -D -m 644 -t ${FLATPAK_DEST}/share/applications/ ${FLATPAK_ID}.desktop

    sources:
      - type: git
        tag: v1.0.0
        commit: 43f43bcdf40afc282b0b2d2770ffce7f83e1c024 
        url: https://github.com/NikolasK-source/SHM_Modbus.git
