id: com.valvesoftware.Steam.Utility.steamtinkerlaunch
default-branch: stable
sdk: org.freedesktop.Sdk//21.08
runtime: com.valvesoftware.Steam
runtime-version: stable
build-extension: true
appstream-compose: false
separate-locales: false
rename-icon: steamtinkerlaunch
rename-desktop-file: steamtinkerlaunch.desktop

build-options:
  prefix: /app/utils/steamtinkerlaunch
  prepend-path: /app/utils/steamtinkerlaunch/bin
  append-pkg-config-path: /app/utils/steamtinkerlaunch/lib/pkgconfig
  strip: true

cleanup:
  - /include
  - /lib/*.a
  - /lib/*.la
  - /share/doc
  - /share/man

modules:
  - modules/git.yml
  - modules/imagemagick.yml
  - modules/innoextract.yml
  - modules/jq.yml
  - modules/pev.yml
  - modules/xdotool.yml
  - modules/xprop.yml
  - modules/xxd.yml
  - modules/xwininfo.yml
  - modules/yad.yml

  - name: steamtinkerlaunch
    build-options:
      env:
        PREFIX: /app/utils/steamtinkerlaunch
    buildsystem: simple
    build-commands:
      - make install
      - install -Dm644 -t ${FLATPAK_DEST}/share/steam/compatibilitytools.d SteamTinkerLaunch.vdf
      - install -Dm644 -t ${FLATPAK_DEST} toolmanifest.vdf
    sources:
      - type: git
        url: https://github.com/frostworx/steamtinkerlaunch/
        commit: 73c0ea180a332eb744ee64d1fb1ab7364e13d2a4 #v10.0.20220607
      #- type: archive
      #  url: https://github.com/frostworx/steamtinkerlaunch/archive/v10.0.tar.gz
      #  sha256: 9337bf239a00c7fe1ccc53b33311391f8bb47b1865d8bbff8b964ade557537b4
      - type: file
        path: SteamTinkerLaunch.vdf
      - type: file
        path: toolmanifest.vdf

  - name: metadata
    buildsystem: simple
    build-commands:
      - install -Dm644 -t ${FLATPAK_DEST}/share/metainfo ${FLATPAK_ID}.metainfo.xml
      - appstream-compose --basename=${FLATPAK_ID} --prefix=${FLATPAK_DEST} --origin=flatpak ${FLATPAK_ID}
    sources:
      - type: file
        path: com.valvesoftware.Steam.Utility.steamtinkerlaunch.metainfo.xml
