app-id: io.github.supercollider.SuperCollider
runtime: org.kde.Platform
base: io.qt.qtwebengine.BaseApp
base-version: '5.15-23.08'
runtime-version: '5.15-23.08'
sdk: org.kde.Sdk
command: scide
rename-icon: sc_ide
rename-desktop-file: SuperColliderIDE

finish-args:
  # It's development environment, need access to all devices
  - --device=all
  # Needed to talk with X11, Wayland
  - --socket=fallback-x11
  - --socket=wayland
  - --share=ipc
  # Need pulseaudio and pipewire
  - --filesystem=xdg-run/pipewire-0
  - --socket=pulseaudio
  # Needs to talk to the network:
  - --share=network
  # Needs to save files locally
  - --filesystem=host

modules:
  - shared-modules/linux-audio/fftw3f.json

  - name: SuperCollider
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DSC_EL=no
    sources:
      - type: archive
        url: https://github.com/supercollider/supercollider/releases/download/Version-3.13.0/SuperCollider-3.13.0-Source.tar.bz2
        sha256: 0fc5dba5baeae37f9069ad28885aa405c6a25309e3886cbe111bd3b7c05531ce

  - name: sc3-plugins
    buildsystem: cmake-ninja
    config-opts:
      - "-DFFTW3F_LIBRARY=/app/lib/libfftw3f.so"
    sources:
      - type: archive
        url: https://github.com/supercollider/sc3-plugins/releases/download/Version-3.13.0/sc3-plugins-3.13.0-Source.tar.bz2
        sha256: f8deeb861d402e2a72db51d40b48c443690261b5a53af78983d4cf7ba76717a2

  - name: git
    make-args:
      - NO_TCLTK=YesPlease
      - NO_PERL=YesPlease
      - INSTALL_SYMLINKS=1
    make-install-args:
      - NO_TCLTK=YesPlease
      - NO_PERL=YesPlease
      - INSTALL_SYMLINKS=1
    post-install:
      - find . -type f -name perllocal.pod -delete
    sources:
      - type: archive
        url: https://mirrors.edge.kernel.org/pub/software/scm/git/git-2.45.2.tar.xz
        sha256: 51bfe87eb1c02fed1484051875365eeab229831d30d0cec5d89a14f9e40e9adb
