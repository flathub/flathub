app-id: org.freedesktop.Sdk.Extension.dotnet9
branch: '24.08'
runtime: org.freedesktop.Sdk
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
build-extension: true
separate-locales: false
modules:
  - name: dotnet-sdk
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/{bin,lib}
      - cp -r * /usr/lib/sdk/dotnet9/lib
      - ln -s /usr/lib/sdk/dotnet9/lib/dotnet /usr/lib/sdk/dotnet9/bin/dotnet
    sources:
      - type: archive
        only-arches: [x86_64]
        url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0.100/dotnet-sdk-9.0.100-linux-x64.tar.gz
        sha256: 4c971ac80615faa806de82f0ab3073e50aebb402b79ac265ab97765c9a29ed56
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$version/dotnet-sdk-$version-linux-x64.tar.gz
      - type: archive
        only-arches: [aarch64]
        url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0.100/dotnet-sdk-9.0.100-linux-arm64.tar.gz
        sha256: b91b19f6bafd1184913082d135f575dd9faa53767b84d836c063ce52e8fab430
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$version/dotnet-sdk-$version-linux-arm64.tar.gz
  - name: scripts
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/share/appdata
      - cp install.sh install-sdk.sh /usr/lib/sdk/dotnet9/bin
      - cp enable.sh /usr/lib/sdk/dotnet9
      - cp org.freedesktop.Sdk.Extension.dotnet9.appdata.xml ${FLATPAK_DEST}/share/appdata
    sources:
      - type: script
        commands:
          - mkdir -p /app/lib/dotnet
          - mkdir -p /app/bin
          - cp -r /usr/lib/sdk/dotnet9/lib/{dotnet,host,shared} /app/lib/dotnet
          - ln -s /app/lib/dotnet/dotnet /app/bin/dotnet
        dest-filename: install.sh
      - type: script
        commands:
          - /usr/lib/sdk/dotnet9/bin/install.sh
          - cp -r /usr/lib/sdk/dotnet9/lib/sdk /app/lib/dotnet
        dest-filename: install-sdk.sh
      - type: script
        commands:
          - export PATH=$PATH:/usr/lib/sdk/dotnet9/bin
          - export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/sdk/dotnet9/lib
          - export DOTNET_CLI_TELEMETRY_OPTOUT=true
          - export DOTNET_NOLOGO=true
          - export DOTNET_ROOT=/usr/lib/sdk/dotnet9/lib
        dest-filename: enable.sh
      - type: file
        path: org.freedesktop.Sdk.Extension.dotnet9.appdata.xml
