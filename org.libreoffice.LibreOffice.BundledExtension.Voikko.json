{
    "id": "org.libreoffice.LibreOffice.BundledExtension.Voikko",
    "runtime": "org.libreoffice.LibreOffice",
    "runtime-version": "stable",
    "sdk": "org.freedesktop.Sdk//20.08",
    "build-extension": true,
    "separate-locales": false,
    "appstream-compose": false,
    "build-options": {
        "prefix": "/app/libreoffice/share/extensions/Voikko",
        "prepend-path": "/app/libreoffice/share/extensions/Voikko/bin"
    },
    "modules": [
        {
            "name": "libvoikko",
            "buildsystem": "autotools",
            "config-opts": [
                "--disable-hfst",
                "--with-dictionary-path=${FLATPAK_DEST}/voikko"
            ],
            "post-install": [
                "install -d ${FLATPAK_DEST}/voikko/Linux",
                "cp -L ${FLATPAK_DEST}/lib/libvoikko.so.1 ${FLATPAK_DEST}/voikko/Linux/",
                "install -d ${FLATPAK_DEST}/pythonpath",
                "cp python/libvoikko.py ${FLATPAK_DEST}/pythonpath/"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.puimula.org/voikko-sources/libvoikko/libvoikko-4.3.1.tar.gz",
                    "sha256": "368240d4cfa472c2e2c43dc04b63e6464a3e6d282045848f420d0f7a6eb09a13"
                }
            ]
        },
        {
            "name": "foma",
            "buildsystem": "simple",
            "build-commands": [ "make", "make install" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://bitbucket.org/mhulden/foma/downloads/foma-0.9.18.tar.gz",
                    "sha256": "cb380f43e86fc7b3d4e43186db3e7cff8f2417e18ea69cc991e466a3907d8cbd"
                },
                {
                    "type": "patch",
                    "path": "foma-installpath.patch"
                },
                {
                    "type": "patch",
                    "path": "foma-variables.patch"
                }
            ]
        },
        {
            "name": "voikko-fi",
            "buildsystem": "simple",
            "build-commands": [
                "make vvfst",
                "make vvfst-install DESTDIR=${FLATPAK_DEST}/voikko"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.puimula.org/voikko-sources/voikko-fi/voikko-fi-2.4.tar.gz",
                    "sha256": "320b2d4e428f6beba9d0ab0d775f8fbe150284fbbafaf3e5afaf02524cee28cc"
                }
            ]
        },
        {
            "name": "libreoffice-voikko",
            "buildsystem": "simple",
            "build-commands": [ "make oxt",
                                "unzip -d ${FLATPAK_DEST} build/voikko.oxt" ],
            "post-install": [
                "install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo ${FLATPAK_BUILDER_BUILDDIR}/org.libreoffice.LibreOffice.BundledExtension.Voikko.metainfo.xml",
                "appstream-compose --basename=org.libreoffice.LibreOffice.BundledExtension.Voikko --prefix=${FLATPAK_DEST} --origin=flatpak org.libreoffice.LibreOffice.BundledExtension.Voikko"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.puimula.org/voikko-sources/libreoffice-voikko/libreoffice-voikko-5.0.tar.gz",
                    "sha256": "8322b58d83eb6e1398d6914885d88a2ee08c8dd2fc2b72d75fba8fe83eefbe38"
                },
                {
                    "type": "patch",
                    "path": "libreoffice-voikko-path.patch"
                },
                {
                    "type": "file",
                    "path": "org.libreoffice.LibreOffice.BundledExtension.Voikko.metainfo.xml"
                }
            ]
        }
    ],
    "cleanup": [
        "/bin",
        "/include",
        "/lib",
        "/share/man"
    ]
}
