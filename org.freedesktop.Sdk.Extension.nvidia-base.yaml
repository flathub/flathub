id: org.freedesktop.Sdk.Extension.nvidia-base
runtime: org.freedesktop.Sdk
runtime-version: '24.08'
build-extension: true
sdk: org.freedesktop.Sdk
separate-locales: false

build-options:
  prefix: /usr/lib/sdk/nvidia-base

cleanup:
  - /bin
  - /include
  - /share

modules:
  - name: zlib
    config-opts:
      - --static
    sources:
      - type: archive
        url: https://github.com/madler/zlib/releases/download/v1.3.1/zlib-1.3.1.tar.xz
        sha256: 38ef96b8dfe510d42707d9c781877914792541133e1870841463bfa73f883e32
        x-checker-data:
          type: anitya
          project-id: 5303
          stable-only: true
          url-template: https://github.com/madler/zlib/releases/download/v$version/zlib-$version.tar.xz

  - name: liblzma
    config-opts:
      - --disable-encoders
      - --enable-decoders=lzma1,lzma2
      - --disable-microlzma
      - --disable-lzip-decoder
      - --disable-xz
      - --disable-xzdec
      - --disable-lzmadec
      - --disable-lzmainfo
      - --disable-lzma-links
      - --disable-scripts
      - --disable-doc
      - --disable-dependency-tracking
      - --disable-shared
    sources:
      - type: archive
        url: https://github.com/tukaani-project/xz/releases/download/v5.6.3/xz-5.6.3.tar.xz
        sha256: db0590629b6f0fa36e74aea5f9731dc6f8df068ce7b7bafa45301832a5eebc3a
        x-checker-data:
          type: anitya
          project-id: 5277
          stable-only: true
          url-template: https://github.com/tukaani-project/xz/releases/download/v$version/xz-$version.tar.xz

  - name: libzstd
    subdir: lib
    buildsystem: simple
    build-options:
      cppflags: -DZSTD_MULTITHREAD
    build-commands:
      - make -j ${FLATPAK_BUILDER_N_JOBS} PREFIX=${FLATPAK_DEST} install-static install-includes
        install-pc
    sources:
      - type: archive
        url: https://github.com/facebook/zstd/releases/download/v1.5.6/zstd-1.5.6.tar.zst
        sha256: 4aa8dd1c1115c0fd6b6b66c35c7f6ce7bd58cc1dfd3e4f175b45b39e84b14352
        x-checker-data:
          type: anitya
          project-id: 12083
          stable-only: true
          url-template: https://github.com/facebook/zstd/releases/download/v$version/zstd-$version.tar.zst

  - name: libarchive
    config-opts:
      - --disable-dependency-tracking
      - --disable-shared
      - --enable-static
      - --disable-xattr
      - --disable-acl
      - --without-bz2lib
      - --without-iconv
      - --without-lz4
      - --without-lzo2
      - --without-nettle
      - --without-openssl
      - --without-xml2
      - --without-expat
      - --disable-bsdcat
      - --disable-bsdcpio
      - --disable-bsdtar
      - --disable-bsdunzip
      - --without-libb2
      - --without-cng
      - --without-mbedtls
    sources:
      - type: archive
        url: https://github.com/libarchive/libarchive/releases/download/v3.7.7/libarchive-3.7.7.tar.xz
        sha256: 879acd83c3399c7caaee73fe5f7418e06087ab2aaf40af3e99b9e29beb29faee
        x-checker-data:
          type: anitya
          project-id: 1558
          stable-only: true
          url-template: https://github.com/libarchive/libarchive/releases/download/v$version/libarchive-$version.tar.xz
