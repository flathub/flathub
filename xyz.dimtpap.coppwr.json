{
	"app-id": "xyz.dimtpap.coppwr",
	"runtime": "org.freedesktop.Platform",
	"runtime-version": "22.08",
	"sdk": "org.freedesktop.Sdk",
	"sdk-extensions": [
		"org.freedesktop.Sdk.Extension.rust-stable",
		"org.freedesktop.Sdk.Extension.llvm16"
	],
	"command": "coppwr",
	"finish-args": [
		"--socket=fallback-x11",
		"--socket=wayland",
		"--device=dri",
		"--share=ipc",
		"--filesystem=xdg-run/pipewire-0"
	],
	"build-options": {
		"append-path": "/usr/lib/sdk/rust-stable/bin:/usr/lib/sdk/llvm16/bin",
		"prepend-ld-library-path": "/usr/lib/sdk/llvm16/lib"
	},
	"modules": [
		{
			"name": "pipewire",
			"buildsystem": "meson",
			"config-opts": [
				"-Dpw-cat=disabled",
				"-Dsndfile=disabled",
				"-Daudiotestsrc=disabled",
				"-Dvideotestsrc=disabled",
				"-Dvolume=disabled",
				"-Dvulkan=disabled",
				"-Ddocs=disabled",
				"-Dman=disabled",
				"-Dlibcamera=disabled",
				"-Dsystemd=disabled",
				"-Dalsa=enabled",
				"-Dpipewire-alsa=disabled",
				"-Djack=enabled",
				"-Dpipewire-jack=disabled",
				"-Dudev=disabled",
				"-Dudevrulesdir=/app/lib/udev/rules.d/",
				"-Dbluez5=disabled",
				"-Dgstreamer=disabled",
				"-Dsession-managers=[]",
				"-Dexamples=disabled",
				"-Dtests=disabled",
				"-Draop=enabled",
				"-Decho-cancel-webrtc=enabled"
			],
			"cleanup": [
				"/bin",
				"/include"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://gitlab.freedesktop.org/pipewire/pipewire.git",
					"tag": "0.3.71",
					"commit": "bd225b14bbda1a6e2dc7a52780eaf728920e0ff2"
				}
			]
		},
		{
			"name": "coppwr",
			"buildsystem": "simple",
			"build-commands": [
				"cargo install --locked --path . --root /app --no-track",
				"install -Dm644 LICENSE /app/share/licenses/coppwr/LICENSE",
				"install -Dm644 assets/xyz.dimtpap.coppwr.desktop /app/share/applications/xyz.dimtpap.coppwr.desktop",
				"install -Dm644 assets/xyz.dimtpap.coppwr.metainfo.xml /app/share/metainfo/xyz.dimtpap.coppwr.metainfo.xml",
				"install -Dm644 assets/icon/scalable.svg /app/share/icons/hicolor/scalable/apps/xyz.dimtpap.coppwr.svg",
				"install -Dm644 assets/icon/512.png /app/share/icons/hicolor/512x512/apps/xyz.dimtpap.coppwr.png",
				"install -Dm644 assets/icon/256.png /app/share/icons/hicolor/256x256/apps/xyz.dimtpap.coppwr.png",
				"install -Dm644 assets/icon/128.png /app/share/icons/hicolor/128x128/apps/xyz.dimtpap.coppwr.png",
				"install -Dm644 assets/icon/64.png /app/share/icons/hicolor/64x64/apps/xyz.dimtpap.coppwr.png",
				"install -Dm644 assets/icon/48.png /app/share/icons/hicolor/48x48/apps/xyz.dimtpap.coppwr.png",
				"install -Dm644 assets/icon/32.png /app/share/icons/hicolor/32x32/apps/xyz.dimtpap.coppwr.png"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/dimtpap/coppwr/releases/download/1.0.0/coppwr-1.0.0-vendor.tar.gz",
					"sha256": "a48b50620fc61d57e189f27f81939974d245100b509c2e5fe7443f4641ea464e"
				}
			]
		}
	]
}