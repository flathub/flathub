{
	"app-id": "it.dotslashplay.little-big-adventure-2",
	"runtime": "org.freedesktop.Platform",
	"runtime-version": "18.08",
	"sdk": "org.freedesktop.Sdk",
	"base": "com.dosbox.DOSBox",
	"base-version": "stable",
	"command": "/extra/play.it/little-big-adventure-2/little-big-adventure-2",
	"finish-args": [
		"--persist=.dosbox",
		"--device=dri",
		"--share=ipc",
		"--socket=x11",
		"--socket=pulseaudio"
	],

	"modules": [
		{
			"name": "game",
			"buildsystem": "simple",
			"build-commands": [
				"install apply_extra bin/amd64/innoextract /app/bin",
				"cp -a play.it icons /app/share",
				"install -D it.dotslashplay.little-big-adventure-2.appdata.xml -t /app/share/metainfo",
				"echo install little-big-adventure-2.desktop /app/share/applications/"
			],

			"sources": [
				{
					"type": "script",
					"dest-filename": "apply_extra",
					"commands": [
						"set -o errexit",
						"/app/share/play.it/play-little-big-adventure-2.sh --package appdir --prefix /app/extra --checksum none",
                                                "rm * 2> /dev/null || true",
						"mkdir -p export/share/applications",
						"mv play.it/*/*.desktop export/share/applications/it.dotslashplay.little-big-adventure-2.desktop",
						"echo Icon=it.dotslashplay.little-big-adventure-2 >> export/share/applications/it.dotslashplay.little-big-adventure-2.desktop"
					]
				},

				{
					"type": "extra-data",
					"filename": "setup_lba2_2.1.0.8.exe",
					"url": "http://setup_lba2_2.1.0.8.exe",
					"sha256": "022492f7b4d1a40c12e7fe9416cd17130f6a1dc26f75ac23fe0bfa63d5ea1c55",
					"size": 666776816,
					"installed-size": 768000000
				},

				{
					"type": "archive",
					"url":	"https://constexpr.org/innoextract/files/innoextract-1.7-linux.tar.xz",
					"mirror-urls": [ "https://github.com/dscharrer/innoextract/releases/download/1.7/innoextract-1.7-linux.tar.xz" ],
					"md5":	"7f352f697052d67e83d3dc7d8a9242ef"
				},

				{
					"type": "dir",
					"path": "play.it",
					"dest": "play.it"
				},

				{
					"type": "file",
					"path": "it.dotslashplay.little-big-adventure-2.appdata.xml"
				},

				{
					"type": "dir",
					"path": "icons",
					"dest": "icons"
				}
			]
		}
	]
}
