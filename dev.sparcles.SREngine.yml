id: dev.sparcles.SREngine
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: srengine-run.sh

finish-args:
  - --share=ipc
  - --socket=x11
  - --device=dri
  - --socket=pulseaudio
  - --share=network
  - --filesystem=home

modules:
   - name: srengine
     buildsystem: cmake-ninja
     builddir: true
     config-opts:
       - -DCMAKE_BUILD_TYPE=Release
       - -DSR_ENGINE_FLATPAK_BUILD=ON
       - -DSR_ENGINE_EXTENDED_NAME=OFF

     post-install:
       - install -Dm755 ../srengine-run.sh /app/bin/srengine-run.sh
       - mkdir -p /app/share/SREngine
       - install -Dm644 ../dev.sparcles.SREngine.metainfo.xml -t /app/share/metainfo
       - install -Dm644 ../Resources/Engine/Textures/dev.sparcles.SREngine.png -t /app/share/icons/hicolor/256x256/apps/
       - install -Dm644 ../dev.sparcles.SREngine.desktop -t /app/share/applications
       - mv ../Resources /app/share/SREngine

     sources:
       - type: git
         url: https://github.com/SpaRcle-Studio/SREngine
         commit: 4ff7a6c10c77f102afbea3065785b98ef1d9e625

       - type: script
         dest-filename: srengine-run.sh
         commands:
           - /app/bin/srengine -resources $XDG_DATA_HOME/Resources -logdir $XDG_DATA_HOME/
