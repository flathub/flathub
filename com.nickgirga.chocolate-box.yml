id: com.nickgirga.chocolate-box
runtime: org.gnome.Platform
runtime-version: '45'
sdk: org.gnome.Sdk
command: chocolate-box

base: org.winehq.Wine
base-version: stable-23.08

finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=fallback-x11
  # Wayland access
  - --socket=wayland
  # access to org.freedesktop.Flatpak; for flatpak Source port launching
  - --talk-name=org.freedesktop.Flatpak
  # GPU acceleration if needed
  - --device=dri
  # access to home files; for locating WADs and custom installed source ports
  - --filesystem=home

modules:
  - name: chocolate-box
    buildsystem: simple
    build-commands:
      - install -D chocolate-box /app/bin/chocolate-box
      - install -D chocolate-box.ui /app/share/chocolate-box/chocolate-box.ui
      - install -D res/icon/icon_128.png /app/share/icons/chocolate-box_128.png
      - install -D res/icon/icon_256.png /app/share/icons/chocolate-box_256.png
      - install -D res/icon/com.nickgirga.chocolate-box.png /app/share/icons/hicolor/256x256/apps/com.nickgirga.chocolate-box.png
      - install -D com.nickgirga.chocolate-box.desktop /app/share/applications/com.nickgirga.chocolate-box.desktop
      - install -Dm644 com.nickgirga.chocolate-box.metainfo.xml -t /app/share/metainfo

    sources:
      - type:   archive
        url:    https://gitlab.com/nickgirga/chocolate-box/-/archive/1.4/chocolate-box-1.4.tar.gz
        sha256: a3a4102421fd14d1fe8a12f3644cf306b844904dd29f2e5b0339a4fba9e4953e
