{
    "app-id": "com.sigil_ebook.Sigil",
    "runtime": "org.kde.Platform",
    "runtime-version": "5.12",
    "sdk": "org.kde.Sdk",
    "command": "sigil",
    "finish-args": [
        "--socket=x11",
        "--filesystem=home:rw"
    ],
    "modules": [
        {
            "name": "python3-lxml",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} lxml"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/c4/43/3f1e7d742e2a7925be180b6af5e0f67d38de2f37560365ac1a0b9a04c015/lxml-4.4.1.tar.gz",
                    "sha256": "c81cb40bff373ab7a7446d6bbca0190bccc5be3448b47b51d729e37799bb5692"
                }
            ]
        },
        {
            "name": "python3-six",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} six"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/73/fb/00a976f728d0d1fecfe898238ce23f502a721c0ac0ecfedb80e0d88c64e9/six-1.12.0-py2.py3-none-any.whl",
                    "sha256": "3350809f0555b11f552448330d0b52d5f24c91a322ea4a15ef22629740f3761c"
                }
            ]
        },
        {
            "name": "python3-css-parser",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} css-parser"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/13/25/23c61fb169b075dbccf0d9eb646483a897156bb08821070d2795394b8b7a/css_parser-1.0.4-py3-none-any.whl",
                    "sha256": "49d6906416569e715b144df97ed81a94b6dc663fbcae6d1dbf4807e7fb8367ae"
                }
            ]
        },
        {
            "name": "python3-sip",
            "config-opts": [
                "--no-dist-info",
                "--no-stubs",
                "--bindir=/app/bin",
                "--destdir=/app/lib/python3.7/site-packages",
                "--incdir=/app/include",
                "--pyidir=/app/lib/python3.7/site-packages",
                "--sipdir=/app/share/sip",
                "--sip-module PyQt5.sip"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.riverbankcomputing.com/static/Downloads/sip/4.19.15/sip-4.19.15.tar.gz",
                    "sha256": "2b5c0b2c0266b467b365c21376d50dde61a3236722ab87ff1e8dacec283eb610"
                },
                {
                    "type": "script",
                    "commands": [
                        "processed=`sed -e 's|--prefix=/app||' <<< $@`",
                        "python3 configure.py $processed"
                    ],
                    "dest-filename": "configure"
                }
            ]
        },
        {
            "name": "python3-pyqt5",
            "config-opts": [
                "--assume-shared",
                "--concatenate",
                "--confirm-license",
                "--no-designer-plugin",
                "--no-dist-info",
                "--no-docstrings",
                "--no-qml-plugin",
                "--no-qsci-api",
                "--no-stubs",
                "--no-tools",
                "QMAKE_CFLAGS_RELEASE='-I/usr/include/python3.7m/'",
                "QMAKE_CXXFLAGS_RELEASE='-I/usr/include/python3.7m/'",
                "--enable=QtCore",
                "--enable=QtGui",
                "--enable=QtWidgets"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.riverbankcomputing.com/static/Downloads/PyQt5/5.12.2/PyQt5_gpl-5.12.2.tar.gz",
                    "sha256": "c565829e77dc9c281aa1a0cdf2eddaead4e0f844cbaf7a4408441967f03f5f0f"
                },
                {
                    "type": "script",
                    "commands": [
                        "processed=`sed -e 's|prefix|sysroot|' <<< $@`",
                        "python3 configure.py $processed"
                    ],
                    "dest-filename": "configure"
                }
            ]
        },
        {
            "name": "python3-html5lib",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} html5lib"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/a5/62/bbd2be0e7943ec8504b517e62bab011b4946e1258842bc159e5dfde15b96/html5lib-1.0.1-py2.py3-none-any.whl",
                    "sha256": "20b159aa3badc9d5ee8f5c647e5efd02ed2a66ab8d354930bd9ff139fc1dc0a3"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/f4/24/2a3e3df732393fed8b3ebf2ec078f05546de641fe1b667ee316ec1dcf3b7/webencodings-0.5.1-py2.py3-none-any.whl",
                    "sha256": "a0af1213f3c2226497a97e2b3aa01a7e4bee4f403f95be16fc9acd2947514a78"
                }
            ]
        },
        {
            "name": "python3-regex",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} regex"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/6f/a6/99eeb5904ab763db87af4bd71d9b1dfdd9792681240657a4c0a599c10a81/regex-2019.08.19.tar.gz",
                    "sha256": "587b62d48ca359d2d4f02d486f1f0aa9a20fbaf23a9d4198c4bed72ab2f6c849"
                }
            ]
        },
        {
            "name": "python3-pillow",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} pillow"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/87/dc/7597336c48796d4a836007460148b7baf7f278ad42b73d49047eb0e8194c/Pillow-6.2.0.tar.gz",
                    "sha256": "4548236844327a718ce3bb182ab32a16fa2050c61e334e959f554cac052fb0df"
                }
            ]
        },
        {
            "name": "python3-cssselect",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} cssselect"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/3b/d4/3b5c17f00cce85b9a1e6f91096e1cc8e8ede2e1be8e96b87ce1ed09e92c5/cssselect-1.1.0-py2.py3-none-any.whl",
                    "sha256": "f612ee47b749c877ebae5bb77035d8f4202c6ad0f0fc1271b3c18ad6c4468ecf"
                }
            ]
        },
        {
            "name": "python3-chardet",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} chardet"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/bc/a9/01ffebfb562e4274b6487b4bb1ddec7ca55ec7510b22e4c51f14098443b8/chardet-3.0.4-py2.py3-none-any.whl",
                    "sha256": "fc323ffcaeaed0e0a02bf4d117757b98aed530d9ed4531e3e15460124c106691"
                }
            ]
        },
        {
            "name": "sigil",
            "buildsystem": "cmake",
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release",
                "-DCMAKE_INSTALL_PREFIX=/app"
            ],
            "post-install": [
                "install -Dm644 com.sigil_ebook.Sigil.metainfo.xml /app/share/metainfo/com.sigil_ebook.Sigil.metainfo.xml",
                "install -Dm644 src/Resource_Files/icon/app_icon_16.png /app/share/icons/hicolor/16x16/apps/com.sigil_ebook.Sigil.png",
                "install -Dm644 src/Resource_Files/icon/app_icon_32.png /app/share/icons/hicolor/32x32/apps/com.sigil_ebook.Sigil.png",
                "install -Dm644 src/Resource_Files/icon/app_icon_48.png /app/share/icons/hicolor/48x48/apps/com.sigil_ebook.Sigil.png",
                "install -Dm644 src/Resource_Files/icon/app_icon_128.png /app/share/icons/hicolor/128x128/apps/com.sigil_ebook.Sigil.png",
                "install -Dm644 src/Resource_Files/icon/app_icon_256.png /app/share/icons/hicolor/256x256/apps/com.sigil_ebook.Sigil.png",
                "install -Dm644 src/Resource_Files/icon/app_icon_512.png /app/share/icons/hicolor/512x512/apps/com.sigil_ebook.Sigil.png",
                "install -Dm644 src/Resource_Files/freedesktop/sigil.desktop /app/share/applications/com.sigil_ebook.Sigil.desktop"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/Sigil-Ebook/Sigil/archive/0.9.18.tar.gz",
                    "sha256": "d4ac2d178fd154d9892fcb552304b20fc12d9eb4b2be5a222c6421c18720cca6"
                },
                {
                    "type": "patch",
                    "path": "sigil-desktop-icon-fix.patch"
                },
                {
                    "type": "file",
                    "path": "com.sigil_ebook.Sigil.appdata.xml"
                }
            ]
        }
    ]
}
