name: wxMaxima
buildsystem: cmake-ninja
builddir: true
sources:
  - type: archive
    url: https://github.com/wxMaxima-developers/wxmaxima/archive/Version-19.07.0.tar.gz
    sha256: 16237f22cf76ecb9159e536bbb121e89ac5ad043843a5f32aaac74f0b409c658
  # https://github.com/wxMaxima-developers/wxmaxima/commit/ae2204db044025c8f4a063ac663b82c92f94efdb.patch
  - type: patch
    path: wxMaxima-19.07.0-appdata.patch
post-install:
  - |
    icon_in="../data/${FLATPAK_ID}.svg";
    icon_out="${FLATPAK_ID}.png";
    for s in {16,22,24,32,36,48,64,72,96,128,192,256,512}; do
      [[ ! -f "${FLATPAK_DEST}/share/icons/hicolor/${s}x${s}/apps/${icon_out}" ]] || continue;
      rsvg-convert "${icon_in}" -w "${s}" -h "${s}" -a -f png -o "${icon_out}";
      install -p -D -m 0644 "${icon_out}" -t "${FLATPAK_DEST}/share/icons/hicolor/${s}x${s}/apps/";
    done;
modules:
  - wxwidgets.yaml
  - maxima.yaml
  - jsmath-fonts.yaml
  - doxygen.yaml
