{
    "name": "ring-deamon",
    "config-opts":[
        "--enable-static",
        "--enable-ipv6"
    ],
    "sources": [
        {
            "type": "git",
            "url": "https://gerrit-ring.savoirfairelinux.com/ring-daemon.git",
            "commit": "8b5ef9647726ce7ff1593e78e5e8e1632065421e"
        }
    ],
    "modules":[
        {
            "name": "pjproject",
            "config-opts": [
                "-disable-oss",
                "--disable-sound",
                "--disable-video",
                "--enable-ext-sound",
                "--disable-speex-aec",
                "--disable-g711-codec",
                "--disable-l16-codec",
                "--disable-gsm-codec",
                "--disable-g722-codec",
                "--disable-g7221-codec",
                "--disable-speex-codec",
                "--disable-ilbc-codec",
                "--disable-opencore-amr",
                "--disable-silk",
                "--disable-sdl",
                "--disable-ffmpeg",
                "--disable-v4l2",
                "--disable-openh264",
                "--disable-resample",
                "--disable-libwebrtc",
                "--enable-ssl=gnutls"
            ],
            "build-options": {
                "cflags": "-fPIC -DPJ_ICE_MAX_CAND=256 -DPJ_ICE_MAX_CHECKS=150 -DPJ_ICE_COMP_BITS=2 -DPJ_ICE_MAX_STUN=3 -DPJSIP_MAX_PKT_LEN=8000 -DPJ_ICE_ST_MAX_CAND=32",
                "cxxflags": "-fPIC -DPJ_ICE_MAX_CAND=256 -DPJ_ICE_MAX_CHECKS=150 -DPJ_ICE_COMP_BITS=2 -DPJ_ICE_MAX_STUN=3 -DPJSIP_MAX_PKT_LEN=8000 -DPJ_ICE_ST_MAX_CAND=32 -std=gnu++11",
                "ldflags": "-fPIC"
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "http://www.pjsip.org/release/2.6/pjproject-2.6.tar.bz2",
                    "sha256": "2f5a1da1c174d845871c758bd80fbb580fca7799d3cfaa0d3c4e082b5161c7b4"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/add_dtls_transport.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/fix_ioqueue_ipv6_sendto.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/fix_turn_fallback.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/gnutls.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/fix_base64.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/ice_config.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/notestsapps.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/ipv6.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/multiple_listeners.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/pj_ice_sess.patch"
                },
                {
                    "type": "patch",
                    "path": "pjproject_patches/rfc6062.patch"
                }
            ]
        },
        {
            "name": "yaml-cpp",
            "buildsystem": "cmake",
            "build-options": {
                "cflags": "-fPIC",
                "cxxflags": "-fPIC",
                "ldflags": "-fPIC"
            },
            "config-opts": [
                "-DBUILD_STATIC=ON",
                "-DBUILD_SHARED=OFF",
                "-DYAML_CPP_BUILD_TOOLS=OFF",
                "-DBUILD_SHARED_LIBS=OFF"
            ],
            "sources":[
                {
                    "type": "git",
                    "url": "https://github.com/jbeder/yaml-cpp.git",
                    "commit": "beb44b872c07c74556314e730c6f20a00b32e8e5"
                }
            ]
        },
        {
            "name": "json-cpp",
            "buildsystem": "cmake",
            "config-opts":[
                "-DBUILD_STATIC_LIBS=ON",
                "-DBUILD_SHARED_LIBS=OFF",
                "-DJSONCPP_WITH_TESTS=OFF",
                "-DCMAKE_INSTALL_LIBDIR=lib",
                "-DCMAKE_CXX_FLAGS=-fPIC",
                "-DCMAKE_C_FLAGS=-fPIC"
            ],
            "sources":[
                {
                    "type": "git",
                    "url": "https://github.com/open-source-parsers/jsoncpp",
                    "branch": "1.8.3"
                }
            ]
        },
        {
            "name": "dbus-c++",
            "config-opts":[
                "--disable-examples",
                "--disable-ecore",
                "--enable-glib",
                "--disable-static"
            ],
            "rm-configure": true,
            "build-options": {
                "env": {
                "LIBS": "-lpthread"
                },
                "cflags": "-fPIC",
                "cxxflags": "-fPIC",
                "ldflags": "-fPIC"
            },
            "sources":[
                {
                    "type": "archive",
                    "url": "https://iweb.dl.sourceforge.net/project/dbus-cplusplus/dbus-c++/0.9.0/libdbus-c++-0.9.0.tar.gz",
                    "sha256": "bc11ac297b3cb010be904c72789695543ee3fdf3d75cdc8225fd371385af4e61"
                },
                {
                    "type": "patch",
                    "path": "dbus-cplusplus_patches/gcc47.patch"
                },
                {
                    "type": "patch",
                    "path": "dbus-cplusplus_patches/disable-threading.patch"
                },
                {
                    "type": "patch",
                    "path": "dbus-cplusplus_patches/fix-writechar.patch"
                },
                {
                    "type": "script",
                    "dest-filename": "autogen.sh",
                    "commands": [
                        "cp -p /usr/share/automake-*/config.{sub,guess} .",
                        "autoconf -f -B build/autoconf_prepend-include"
                    ]
                }
            ]
        },
        {
            "name": "restbed",
            "buildsystem": "cmake",
            "build-options": {
                "cflags": "-fPIC",
                "cxxflags": "-fPIC",
                "ldflags": "-fPIC"
            },
            "config-opts":[
                "-DCMAKE_INSTALL_LIBDIR=lib",
                "-DBUILD_TESTS=NO",
                "-DBUILD_EXAMPLES=NO",
    			"-DBUILD_SSL=NO",
                "-DBUILD_SHARED=NO"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "https://github.com/Corvusoft/restbed/archive/4.6/restbed-4.6.tar.gz",
                    "sha256": "b2b75c39129bf667a3e1a9494b9cf0e3dcf6d2b081746918f0f6ba202f14a7e4"
                },
                {
                    "type": "patch",
                    "path": "restbed_patches/strand.patch"
                }
            ],
            "modules": [
                {
                    "name": "asio",
                    "sources":[
                        {
                            "type": "archive",
                            "url": "http://downloads.sourceforge.net/asio/asio-1.10.8.tar.bz2",
                            "sha256": "26deedaebbed062141786db8cfce54e77f06588374d08cccf11c02de1da1ed49"
                        }
                    ],
                    "modules":[
                        "org.boost.Boost.json"
                    ]
                },
                {
                    "name": "kashmir",
                    "buildsystem": "simple",
                    "build-commands":[
                        "mkdir /app/include/kashmir",
                        "cp -a kashmir/* /app/include/kashmir"
                    ],
                    "sources":[
                        {
                            "type": "git",
                            "url": "https://github.com/Corvusoft/kashmir-dependency.git"
                        }
                    ]
                }
            ]
        },
        "org.ffmpeg.FFmpeg.json",
        "shared-modules/udev/udev-175.json",
        {
            "name": "gsm",
            "no-autogen":true,
            "make-args":[
                "CCFLAGS=-c -fPIC"
            ],
            "make-install-args":[
                "INSTALL_ROOT=/app",
                "GSM_INSTALL_INC=/app/include/gsm",
                "GSM_INSTALL_MAN=/app/share/man/man3",
                "TOAST_INSTALL_MAN=/app/share/man/man1"
            ],
            "build-commands":[
                "mkdir -p /app/include/gsm",
                "mkdir -p /app/share/man/man1",
                "mkdir -p /app/share/man/man3/"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "http://www.quut.com/gsm/gsm-1.0.17.tar.gz",
                    "sha256": "855a57d1694941ddf3c73cb79b8d0b3891e9c9e7870b4981613b734e1ad07601"
                },
                {
                    "type": "patch",
                    "path": "gsm_patches/gsm-shared.patch",
                    "strip-components": 0
                }
            ]
        },
        {
            "name": "opendht",
            "buildsystem": "cmake",
            "config-opts":[
                "-DCMAKE_BUILD_TYPE=Release",
                "-DCMAKE_INSTALL_PREFIX=/app",
                "-DOPENDHT_PYTHON=OFF",
                "-DOPENDHT_TOOLS=OFF",
                "-DOPENDHT_DOCUMENTATION=OFF",
                "-DCMAKE_INSTALL_LIBDIR=lib"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "https://github.com/savoirfairelinux/opendht/archive/1.3.6/opendht-1.3.6.tar.gz",
                    "sha256": "7e888748741a0a2cc44639c580f29fa4c58cddbf08622626b754f0c9b99a4392"
                }
            ],
            "modules": [
                {
                    "name": "argon2",
                    "no-autogen":true,
                    "post-install":[
                        "cp libargon2.pc /app/lib/pkgconfig/libargon2.pc"
                    ],
                    "cleanup": [
                        "libargon2.so*"
                    ],
                    "make-install-args":[
                        "PREFIX=/app"
                    ],
                    "sources":[
                        {
                            "type": "git",
                            "url": "https://github.com/P-H-C/phc-winner-argon2.git",
                            "branch": "20161029"
                        },
                        {
                            "type": "file",
                            "path": "argon2_pc/libargon2.pc"
                        }
                    ]
                },
                {
                    "name": "msgpack",
                    "buildsystem": "cmake",
                    "config-opts":[
                        "-DCMAKE_INSTALL_PREFIX=/app",
                        "-DMSGPACK_CXX11=ON",
                        "-DMSGPACK_BUILD_EXAMPLES=OFF",
                        "-DMSGPACK_ENABLE_SHARED=OFF",
                        "-DCMAKE_INSTALL_LIBDIR=lib",
                        "-DCMAKE_BUILD_TYPE=Release"
                    ],
                    "sources":[
                        {
                            "type": "archive",
                            "url": "https://github.com/msgpack/msgpack-c/releases/download/cpp-2.1.5/msgpack-2.1.5.tar.gz",
                            "sha256": "6126375af9b204611b9d9f154929f4f747e4599e6ae8443b337915dcf2899d2b"
                        }
                    ]
                }
            ]
        },
        {
            "name": "libnatpmp",
            "buildsystem": "simple",
            "build-commands":[
                "sed -e 's/CFLAGS = /CFLAGS += /' -i Makefile",
                "make INSTALLPREFIX=/app INSTALLDIRINC=/app/include install"
            ],
            "cleanup": [
                "libnatpmp.so*"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "http://miniupnp.tuxfamily.org/files/libnatpmp-20150609.tar.gz",
                    "sha256": "e1aa9c4c4219bc06943d6b2130f664daee213fb262fcb94dd355815b8f4536b0"
                }
            ]
        },
        {
            "name": "libupnp",
            "build-options": {
                "cflags": "-fPIC",
                "cxxflags": "-fPIC",
                "ldflags": "-fPIC"
            },
            "config-opts": [
                "--disable-samples",
                "--without-documentation",
                "--disable-blocking_tcp_connections"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://downloads.sourceforge.net/sourceforge/pupnp/libupnp-1.6.22.tar.bz2",
                    "sha256": "0bdfacb7fa8d99b78343b550800ff193264f92c66ef67852f87f042fd1a1ebbc"
                }
            ]
        },
        {
            "name": "secp256k1",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/bitcoin-core/secp256k1.git",
                    "commit": "0b7024185045a49a1a6a4c5615bf31c94f63d9c4"
                }
            ]
        },
        {
            "name": "libiblc",
            "sources" : [
                {
                    "type": "archive",
                    "url": "https://github.com/TimothyGu/libilbc/releases/download/v2.0.2/libilbc-2.0.2.tar.gz",
                    "sha256": "84d5c99087a35bda3463bcb993245b4f8c28c04fe037215a5ec56570f68ce519"
                }
            ]
        }
    ]
}
