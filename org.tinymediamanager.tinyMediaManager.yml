app-id: org.tinymediamanager.TinyMediaManager
runtime: org.freedesktop.Platform
runtime-version: "25.08"
sdk: org.freedesktop.Sdk
command: tinyMediaManager.sh
separate-locales: false
finish-args:
  # allow access to media files
  - --filesystem=home
  - --filesystem=xdg-download
  - --filesystem=xdg-videos  
  - --filesystem=host
  - --share=network
  - --socket=x11
  - --socket=wayland
  - --share=ipc  
  - --env=LC_ALL=C.UTF-8
  - --env=LANG=C.UTF-8  

modules:
  - name: tinyMediaManager
    buildsystem: simple
    build-commands:
      # Create necessary directories
      - mkdir -p /app/bin /app/share/applications /app/share/icons/hicolor/128x128/apps
      - mkdir -p /app/tmm
      - cp -r * /app/tmm
      - install -Dm755 tinyMediaManager.sh /app/bin/tinyMediaManager.sh
      
      # Install the embedded .desktop file
      - install -Dm644 org.tinymediamanager.TinyMediaManager.desktop /app/share/applications/org.tinymediamanager.TinyMediaManager.desktop

      # Install the icon
      - install -Dm644 org.tinymediamanager.TinyMediaManager.svg /app/share/icons/hicolor/scalable/apps/org.tinymediamanager.TinyMediaManager.svg

    sources:
      - type: dir
        path: tinyMediaManager

      - type: file
        path: tmm.svg

      - type: file
        path: tinyMediaManager.sh
          
      - type: file
        path: org.tinymediamanager.TinyMediaManager.desktop

  - name: libzen
    subdir: Project/GNU/Library
    config-opts:
      - --enable-shared
      - --disable-static
    cleanup:
      - /bin
      - /include
      - /lib/pkgconfig
      - /lib/*.la
    sources:
      - type: archive
        url: https://mediaarea.net/download/source/libzen/0.4.41/libzen_0.4.41.tar.xz
        sha256: 933bad3b7ecd29dc6bdc88a83645c83dfd098c15b0b90d6177a37fa1536704e8
        x-checker-data:
          type: anitya
          project-id: 1810
          url-template: https://mediaarea.net/download/source/libzen/$version/libzen_$version.tar.xz
          
  - name: libmediainfo
    subdir: Project/GNU/Library
    config-opts:
      - --enable-shared
      - --disable-static
      - --with-libcurl
    cleanup:
      - /bin
      - /include
      - /lib/pkgconfig
      - /lib/*.la
    sources:
      - type: archive
        url: https://mediaarea.net/download/source/libmediainfo/25.10/libmediainfo_25.10.tar.xz
        sha256: ad13d9797b046ce39d0c65a6f81d2aef2429734c21865a6a4c592c7c01f249dd
        x-checker-data:
          type: anitya
          project-id: 16249
          url-template: https://mediaarea.net/download/source/libmediainfo/$version/libmediainfo_$version.tar.xz