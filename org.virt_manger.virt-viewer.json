{
    "app-id" : "org.virt_manager.virt-viewer",
    "runtime" : "org.gnome.Platform",
    "runtime-version" : "3.28",
    "sdk" : "org.gnome.Sdk",
    "command" : "virt-viewer",
    "rename-desktop-file": "remote-viewer.desktop",
    "rename-icon": "virt-viewer",
    "finish-args" : [
        "--share=ipc",
        "--socket=x11",
        "--socket=wayland",
        "--socket=pulseaudio",
        "--share=network",
        "--talk-name=org.a11y.*",
        "--device=all",
        "--filesystem=xdg-pictures",
        "--filesystem=~/.ssh",
        "--filesystem=xdg-run/dconf",
        "--filesystem=~/.config/dconf:ro",
        "--talk-name=ca.desrt.dconf",
        "--env=DCONF_USER_CONFIG_DIR=.config/dconf"
    ],
    "build-options" : {
        "cflags" : "-O2 -g",
        "cxxflags" : "-O2 -g"
    },
    "cleanup" : [
        "/include",
        "/sbin",
        "/lib/pkgconfig",
        "/share/man",
        "/share/gtk-doc",
        "/share/gir-*",
        "/share/pkgconfig",
        "*.la",
        "*.a"
    ],
    "modules" : [
        {
            "name": "eudev",
            "config-opts": [
                "--disable-hwdb",
                "--disable-logging",
                "--disable-gudev",
                "--disable-introspection",
                "--disable-keymap",
                "--disable-mtd_probe"
            ],
            "cleanup": [
                "/include",
                "/etc",
                "/libexec",
                "/sbin",
                "/lib/pkgconfig",
                "/man",
                "/share/aclocal",
                "/share/doc",
                "/share/gtk-doc",
                "/share/man",
                "/share/pkgconfig",
                "*.la",
                "*.a"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/gentoo/eudev/archive/v3.2.5.tar.gz",
                    "sha256": "870920011285b919fca5c60eaa5670312eeffe3883dd8cf564cd1179fc639336"
                },
                {
                    "type": "script",
                    "dest-filename": "autogen.sh",
                    "commands": [
                        "autoreconf -vfi"
                    ]
                }
            ]
        },
        {
            "name": "gcrypt-wrapper",
            "buildsystem": "simple",
            "cleanup": [
                "*"
            ],
            "build-commands": [
                "install -Dm755 libgcrypt-config ${FLATPAK_DEST}/bin/libgcrypt-config"
            ],
            "sources": [
                {
                    "type": "script",
                    "dest-filename": "libgcrypt-config",
                    "commands": [
                        "if [ $1 == '--version' ]; then set -- '--modversion' ${@:4}; fi",
                        "exec pkg-config $@ libgcrypt"
                    ]
                }
            ]
        },
        {
            "name": "lz4",
            "build-options": {
                "env": {
                    "PREFIX": "/app"
                }
            },
            "buildsystem": "simple",
            "build-commands": [
                "make -j $FLATPAK_BUILDER_N_JOBS",
                "make install"
            ],
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/lz4/lz4/archive/v1.8.2.tar.gz",
                    "sha256": "0963fbe9ee90acd1d15e9f09e826eaaf8ea0312e854803caf2db0a6dd40f4464"
                }
            ]
        },
        {
            "name": "openssh",
            "cleanup": [
                "/bin/libexec",
                "/bin/ssh-*",
                "/bin/scp",
                "/bin/sftp"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://cloudflare.cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.7p1.tar.gz",
                    "sha256": "d73be7e684e99efcd024be15a30bffcbe41b012b2f7b3c9084aed621775e6b8f"
                }
            ]
        },
        {
            "name": "libssh2",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.libssh2.org/download/libssh2-1.8.0.tar.gz",
                    "sha256": "39f34e2f6835f4b992cafe8625073a88e5a28ba78f83e8099610a7b3af4676d4"
                }
            ]
        },
        {
            "name": "libusb",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/libusb/libusb/archive/v1.0.22.tar.gz",
                    "sha256": "3500f7b182750cd9ccf9be8b1df998f83df56a39ab264976bdb3307773e16f48"
                }
            ]
        },
        {
            "name": "usbutils",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/gregkh/usbutils.git",
                    "tag": "v009",
                    "commit": "133f781d88ae4aee22654bfed25894518e4109c7"
                }
            ]
        },
        {
            "name": "usbredir",
            "sources": [
                {
                    "type": "git",
                    "url": "git://anongit.freedesktop.org/spice/usbredir",
                    "tag": "usbredir-0.7.1",
                    "commit": "e1a7e3dbbe091bfdc568372ff5ab18ed7eae972e"
                }
            ]
        },
        {
            "name": "libcacard",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "git://anongit.freedesktop.org/spice/libcacard",
                    "tag": "v2.5.3",
                    "commit": "aaa5251791bf0b1640afcba77a7d79ea23c42d53"
                }
            ]
        },
        {
            "name": "libnl",
            "cleanup": [
                "/bin",
                "/etc"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/thom311/libnl/releases/download/libnl3_4_0/libnl-3.4.0.tar.gz",
                    "sha256": "b7287637ae71c6db6f89e1422c995f0407ff2fe50cecd61a312b6a9b0921f5bf"
                }
            ]
        },
        {
            "name": "gtk-vnc",
            "cleanup": [
                "/bin"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gtk-vnc/0.7/gtk-vnc-0.7.2.tar.xz",
                    "sha256": "f893f32b1ef6d09dd23cda39b8a2567be7c2aebda58026288e1362f042e20808"
                }
            ]
        },
        {
            "name": "spice-protocol",
            "sources": [
                {
                    "type": "git",
                    "url": "https://anongit.freedesktop.org/git/spice/spice-protocol.git",
                    "tag": "v0.12.13",
                    "commit": "8dda82b49d8f848a25e3a1ef6df943276c59e462"
                }
            ]
        },
        {
            "name": "phodav",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://ftp.gnome.org/pub/GNOME/sources/phodav/2.2/phodav-2.2.tar.xz",
                    "sha256": "080305dc9e804562f200ffc8c7d345c76754fce9cb01489dddb1b2c52c0557c1"
                }
            ]
        },
        {
            "name": "libvirt",
            "cleanup": [
                "/bin",
                "/share",
                "/libexec",
                "/etc"
            ],
            "config-opts": [
                "--prefix=/app",
                "--sysconfdir=/etc",
                "--localstatedir=/var",
                "--without-html-dir",
                "--without-bash-completion",
                "--without-test",
                "--without-html-subdir",
                "--without-storage-dir",
                "--without-storage-fs",
                "--without-storage-lvm",
                "--without-storage-iscsi",
                "--without-storage-scsi",
                "--without-storage-mpath",
                "--without-storage-disk",
                "--without-storage-rbd",
                "--without-storage-sheepdog",
                "--without-storage-gluster",
                "--without-storage-zfs",
                "--without-storage-vstorage"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://libvirt.org/sources/libvirt-4.3.0.tar.xz",
                    "sha256": "a531e22c8b985ecb2d1223b913fd6ec0f1800e3ebe02351924274885db20c2b7"
                }
            ]
        },
        {
            "name": "libvirt-glib",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://libvirt.org/sources/glib/libvirt-glib-1.0.0.tar.gz",
                    "sha256": "ca9158d01cc4d9e0218f94f8c9ee04ae367d8c3b4396daaebca2c4b89a2e8a47"
                }
            ]
        },
        {
            "name": "spice-gtk",
            "cleanup": [
                "/bin"
            ],
            "config-opts": [
                "--disable-gtk-doc",
                "--disable-gtk-doc-html",
                "--disable-gtk-doc-pdf",
                "--enable-usbredir"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "https://www.spice-space.org/download/gtk/spice-gtk-0.34.tar.bz2",
                    "sha256": "e9720e01165f8451c9f3f58ad50e3afb990993b81cc2db86b3661b7ac5b976ee"
                }
            ]
        },
        {
            "name" : "remote-viewer",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://releases.pagure.org/virt-viewer/virt-viewer-6.0.tar.gz",
                    "sha256": "9037bd7773da4dae761871ec1ab646cfefb4d7e48b1504dddf315a548ccb18b2"
                }
            ]
        }
    ]
}