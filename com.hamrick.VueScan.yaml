app-id: com.hamrick.VueScan
runtime: org.gnome.Platform
runtime-version: 3.28
sdk: org.gnome.Sdk
command: vuescan

tags:
- proprietary
  
finish-args:
- --share=ipc
- --socket=x11
- --socket=pulseaudio
# Upstream doesn't respect XDG
- --filesystem=xdg-pictures
- --filesystem=xdg-documents
- --filesystem=~/.vuescanrc
- --persist=.vuescan
- --device=all

modules:
- name: VueScan
  buildsystem: simple
  build-commands:
  - install -D apply_extra /app/bin/apply_extra
  - install -D vuescan /app/bin/vuescan
  - install -Dm644 com.hamrick.VueScan.appdata.xml /app/share/appdata/com.hamrick.VueScan.appdata.xml
  - install -Dm644 com.hamrick.VueScan.desktop /app/share/applications/com.hamrick.VueScan.desktop
  - install -Dm644 icon16x16.png /app/share/icons/hicolor/16x16/apps/com.hamrick.VueScan.png
  - install -Dm644 icon32x32.png /app/share/icons/hicolor/32x32/apps/com.hamrick.VueScan.png
  - install -Dm644 icon48x48.png /app/share/icons/hicolor/48x48/apps/com.hamrick.VueScan.png
  
  sources:
  - type: extra-data
    filename: vuescan.tgz
    only-arches:
    - i386
    url: https://www.hamrick.com/files/vuex3296.tgz
    sha256: 3c17ce55070a84d60dbca3052cb00b670ce1f66f0b107e307038da9ada163723
    size: 8116426
    
  - type: extra-data
    filename: vuescan.tgz
    only-arches:
    - x86_64
    url: https://www.hamrick.com/files/vuex6496.tgz
    sha256: 331e6030b2e8c0d4bc1c392e6c02bd0009725f6e3a98cf74c70ea8dc7d9e8850
    size: 8314388
    
  - type: script
    dest-filename: apply_extra
    commands:
    - tar xf vuescan.tgz
    - rm vuescan.tgz
    - mv VueScan/* .
    # Unfortunately the SVG is just a JPEG embedded in SVG container
    - rm vuescan.svg
    - rmdir VueScan
    
  - type: script
    dest-filename: vuescan
    commands:
    - 'exec /app/extra/vuescan "$@"'
    
  - type: file
    path: com.hamrick.VueScan.appdata.xml

  - type: file
    path: com.hamrick.VueScan.desktop
    
  - type: file
    path: icon16x16.png
    
  - type: file
    path: icon32x32.png
    
  - type: file
    path: icon48x48.png
    