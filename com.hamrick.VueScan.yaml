app-id: com.hamrick.VueScan
runtime: org.freedesktop.Platform
runtime-version: 18.08
sdk: org.freedesktop.Sdk
command: vuescan

tags:
- proprietary
  
finish-args:
- --share=ipc
- --socket=x11
- --socket=pulseaudio
#- --share=network
- --filesystem=xdg-pictures
- --filesystem=xdg-documents
- --persist=.vuescan
- --device=all

modules:
- name: VueScan
  buildsystem: simple
  build-commands:
  - install -D apply_extra /app/bin/apply_extra
  - install -D vuescan /app/bin/vuescan
  
  sources:
  - type: extra-data
    filename: vuescan.tgz
    only-arches:
    - i386
    url: https://www.hamrick.com/files/vuex3296.tgz
    sha256: 3c17ce55070a84d60dbca3052cb00b670ce1f66f0b107e307038da9ada163723
    
  - type: extra-data
    filename: vuescan.tgz
    only-arches:
    - x86_64
    url: https://www.hamrick.com/files/vuex6496.tgz
    sha256: 73280b9fc49fa959f8861e2c525a9f0980a1dd115275a075cb4faed1ce4441ac
    
  - type: script
    dest-filename: apply_extra
    commands:
    - tar xf vuescan.tgz
    - rm vuescan.tgz
    - mv VueScan/* .
    # Unfortunately the SVG is really just a JPEG embedded in SVG container
    - rm vuescan.svg
    - rmdir VueScan
    - install -Dm644 icon16x16.png /app/share/icons/hicolor/16x16/apps/com.hamrick.VueScan.png
    - install -Dm644 icon32x32.png /app/share/icons/hicolor/32x32/apps/com.hamrick.VueScan.png
    - install -Dm644 icon48x48.png /app/share/icons/hicolor/48x48/apps/com.hamrick.VueScan.png

  - type: script
    dest-filename: vuescan
    commands:
    - 'exec /app/extra/vuescan "$@"'
    
  - type: file
    path: icon16x16.png
    
  - type: file
    path: icon32x32.png
    
  - type: file
    path: icon48x48.png
    