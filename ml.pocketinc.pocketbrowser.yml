app-id: ml.pocketinc.pocketbrowser
runtime: org.freedesktop.Platform
runtime-version: '20.08'
branch: stable
sdk: org.freedesktop.Sdk
base: io.atom.electron.BaseApp
base-version: 20.08
command: install.sh
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=pulseaudio
  - --share=network
  env:
    NPM_CONFIG_LOGLEVEL: info
    - name: nodejs
  cleanup:
    - /include
    - /share
    - /app/lib/node_modules/npm/changelogs
    - /app/lib/node_modules/npm/doc
    - /app/lib/node_modules/npm/html
    - /app/lib/node_modules/npm/man
    - /app/lib/node_modules/npm/scripts
  sources:
    - type: archive
      url: https://nodejs.org/dist/v12.0.0/node-v12.0.0.tar.xz
- name: pocket-browser
  build-options:
    env:
      # Need this for electron-download to find the cached electron binary
      electron_config_cache: /run/build/pocket-browser/npm-cache
buildsystem: simple
sources:
  - type: archive
    url: https://github.com/PocketInc/Pocket-Browser/archive/v1.5.tar.gz
    dest: main
- type: script
  dest-filename: install.sh
  commands:
    - npm start --prefix=/app/main
