app-id: ml.pocketinc.pocketbrowser
runtime: org.freedesktop.Platform
runtime-version: '20.08'
branch: stable
sdk: org.freedesktop.Sdk
base: org.electronjs.Electron2.BaseApp
base-version: '20.08'
command: run.sh
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=pulseaudio
  - --share=network
modules:
  - name: pocket-browser
    buildsystem: simple
    build-options:
      append-path: /usr/lib/sdk/node12/bin
      env:
        electron_config_cache: /run/build/pocket-browser/npm-cache/cache
        npm_config_nodedir: /usr/lib/sdk/node12
    build-commands:
      - npm install --prefix=pocketbrowser --offline --cache=/run/build/pocket-browser/npm-cache/
      - mkdir -p /app/main /app/bin
      - cp -ra main/* /app/main/
      - install run.sh /app/bin/
    sources:
      - type: archive
        url: https://github.com/PocketInc/Pocket-Browser/archive/v1.5.tar.gz
        sha256: a224ad547663d416c6bbd79364636a6c67101fb7595be2c2b0e8445d89a5f5f0
        dest: pocket-browser
      - generated-sources.json
      - type: script
        dest-filename: run.sh
        commands:
          - npm start --prefix=/app/main
