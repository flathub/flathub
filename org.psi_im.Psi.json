{
  "id": "org.psi_im.Psi",
  "runtime": "org.kde.Platform",
  "runtime-version": "5.15-21.08",
  "base": "io.qt.qtwebengine.BaseApp",
  "base-version": "5.15-21.08",
  "sdk": "org.kde.Sdk",
  "command": "psi",
  "rename-icon": "psi",
  "rename-desktop-file": "psi.desktop",
  "rename-appdata-file": "psi.appdata.xml",
  "finish-args": [
    "--device=dri",
    "--share=ipc",
    "--share=network",
    "--socket=wayland",
    "--socket=fallback-x11",
    "--socket=pulseaudio",
    "--talk-name=org.kde.StatusNotifierWatcher",
    "--talk-name=org.freedesktop.Notifications",
    "--own-name=org.psi-im.Psi",
    "--own-name=org.psi-im.Psi.*"
  ],
  "modules": [
    {
      "name": "qca",
      "buildsystem": "cmake-ninja",
      "config-opts": [
        "-DBUILD_TESTS=OFF"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://download.kde.org/stable/qca/2.3.4/qca-2.3.4.tar.xz",
          "sha256": "6b695881a7e3fd95f73aaee6eaeab96f6ad17e515e9c2b3d4b3272d7862ff5c4",
          "x-checker-data": {
            "type": "anitya",
            "project-id": 13606,
            "stable-only": true,
            "url-template": "https://download.kde.org/stable/qca/$version/qca-$version.tar.xz"
          }
        }
      ]
    },
    {
      "name": "libidn",
      "buildsystem": "autotools",
      "config-opts": [
        "--disable-static",
        "--disable-gtk-doc"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://ftp.gnu.org/gnu/libidn/libidn-1.38.tar.gz",
          "sha256": "de00b840f757cd3bb14dd9a20d5936473235ddcba06d4bc2da804654b8bbf0f6",
          "x-checker-data": {
            "type": "anitya",
            "project-id": 1639,
            "stable-only": true,
            "url-template": "https://ftp.gnu.org/gnu/libidn/libidn-$version.tar.gz"
          }
        }
      ]
    },
    {
      "name": "libotr",
      "config-opts": [
        "--disable-static"
      ],
      "cleanup": [
        "/bin",
        "/lib/pkgconfig",
        "/include",
        "/share",
        "/lib/*.la"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://otr.cypherpunks.ca/libotr-4.1.1.tar.gz",
          "sha256": "8b3b182424251067a952fb4e6c7b95a21e644fbb27fbd5f8af2b2ed87ca419f5",
          "x-checker-data": {
            "type": "anitya",
            "project-id": 13303,
            "stable-only": true,
            "url-template": "https://otr.cypherpunks.ca/libotr-$version.tar.gz"
          }
        }
      ]
    },
    {
      "name": "libtidy",
      "buildsystem": "cmake-ninja",
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/htacg/tidy-html5.git",
          "tag": "5.8.0"
        }
      ]
    },
    {
      "name": "enchant",
      "config-opts": [
        "--disable-static",
        "--with-myspell-dir=/usr/share/hunspell"
      ],
      "cleanup": [
        "/bin"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/AbiWord/enchant/releases/download/enchant-1-6-1/enchant-1.6.1.tar.gz",
          "sha256": "bef0d9c0fef2e4e8746956b68e4d6c6641f6b85bd2908d91731efb68eba9e3f5"
        }
      ]
    },
    {
      "name": "psi",
      "buildsystem": "cmake-ninja",
      "config-opts": [
        "-DUSE_HUNSPELL=OFF",
        "-DUSE_ENCHANT=ON",
        "-DUSE_WEBENGINE=ON",
        "-DENABLE_PLUGINS=ON",
        "-DBUILD_PLUGINS=attentionplugin;autoreplyplugin;birthdayreminderplugin;chessplugin;cleanerplugin;conferenceloggerplugin;contentdownloaderplugin;enummessagesplugin;extendedmenuplugin;extendedoptionsplugin;gnupgplugin;gomokugameplugin;historykeeperplugin;httpuploadplugin;icqdieplugin;imageplugin;imagepreviewplugin;jabberdiskplugin;juickplugin;messagefilterplugin;otrplugin;pepchangenotifyplugin;qipxstatusesplugin;skinsplugin;stopspamplugin;storagenotesplugin;translateplugin;videostatusplugin;watcherplugin"
      ],
      "post-install": [
        "install -Dm644 iconsets/system/default/logo_16.png ${FLATPAK_DEST}/share/icons/hicolor/16x16/apps/psi.png",
        "install -Dm644 iconsets/system/default/logo_32.png ${FLATPAK_DEST}/share/icons/hicolor/32x32/apps/psi.png",
        "install -Dm644 iconsets/system/default/logo_48.png ${FLATPAK_DEST}/share/icons/hicolor/48x48/apps/psi.png",
        "install -Dm644 iconsets/system/default/logo_64.png ${FLATPAK_DEST}/share/icons/hicolor/64x64/apps/psi.png",
        "install -Dm644 iconsets/system/default/logo_128.png ${FLATPAK_DEST}/share/icons/hicolor/128x128/apps/psi.png",
        "install -Dm644 psi.appdata.xml ${FLATPAK_DEST}/share/appdata/psi.appdata.xml"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://sourceforge.net/projects/psi/files/Psi/1.5/psi-1.5.tar.xz",
          "sha256": "3167350fd43fab4dc948cb5179ca10159a7aa318472d1a8a7617e41f5aa8b5b7"
        },
        {
          "type": "file",
          "url": "https://raw.githubusercontent.com/psi-im/psi/686dd525e999f067f3a7a60d260954c477e75460/linux/psi.appdata.xml",
          "sha256": "635a6f3e0e5fe44e2480d2120e47a5e613269e7fbcd3ffe162e60744bd3e8590"
        },
        {
          "type": "archive",
          "url": "https://github.com/psi-im/psi-l10n/archive/1.5.tar.gz",
          "sha256": "a5f127dcf44b8d3a9f5de16823f4002937727fa5d6cb54ccbca631dd96db4632"
        },
        {
          "type": "archive",
          "url": "https://github.com/psi-im/plugins/archive/1.5.tar.gz",
          "sha256": "1857b9dc89ef0d548697207b3a56283f2d67c0de75cc66bf863936a58150401e",
          "dest": "src/plugins"
        }
      ]
    }
  ]
}
