app-id: org.tac.writer
runtime: org.gnome.Platform
runtime-version: '47'
sdk: org.gnome.Sdk
command: tac-writer
finish-args:
  - --share=network
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc
  - --device=dri
  # Permissão para acessar a pasta Documentos (padrão XDG)
  - --filesystem=xdg-documents
  # Se precisar acessar outros locais, use --filesystem=host (mas evite se possível)

modules:
  # 1. Dependências Python (O arquivo que acabamos de gerar)
  # Se o nome gerado for diferente, ajuste aqui (ex: pypi-dependencies.yaml)
  - python3-pybind11.yaml
  - python3-requirements.yaml

  # 2. Sua Aplicação
  - name: tac-writer
    buildsystem: simple
    build-commands:
      # Instala o executável
      - install -Dm755 usr/bin/tac-writer /app/bin/tac-writer
      
      # Ajusta o caminho dentro do script (de /usr/share para /app/share)
      - sed -i 's|/usr/share|/app/share|g' /app/bin/tac-writer
      
      # Cria diretórios
      - mkdir -p /app/share/tac-writer
      - mkdir -p /app/share/applications
      - mkdir -p /app/share/icons/hicolor/scalable/apps
      
      # Copia o código fonte
      - cp -r usr/share/tac-writer/* /app/share/tac-writer/
      
      # Instala o .desktop
      - install -Dm644 usr/share/applications/org.tac.writer.desktop /app/share/applications/org.tac.writer.desktop
      
      # Instala o AppStream Metainfo
      - install -Dm644 usr/share/metainfo/org.tac.writer.metainfo.xml /app/share/metainfo/org.tac.writer.metainfo.xml
      
      # Instala o ícone (Assumindo que você tem um SVG ou PNG no lugar certo)
      # O Flatpak precisa do ícone exportado em /app/share/icons para aparecer
      # Se o ícone estiver em usr/share/icons/hicolor/scalable/apps/tac-writer.svg:
      - cp -r usr/share/icons/* /app/share/icons/ 2>/dev/null || true

    sources:
      - type: git
        url: https://github.com/narayanls/tac-writer.git
        tag: v1.2.4  
        commit: 8a2522475e919e4a3a3be68731482956ef9a68ae 
