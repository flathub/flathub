app-id: org.tac.writer

runtime: org.gnome.Platform
runtime-version: '47'
sdk: org.gnome.Sdk

command: tac-writer

finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc
  - --device=dri
  - --filesystem=xdg-documents

modules:
  - python3-pybind11.yaml
  - python3-requirements.yaml

  - name: tac-writer
    buildsystem: simple
    build-commands:
      # Install exec
      - install -Dm755 usr/bin/tac-writer /app/bin/tac-writer
      # Adjust path
      - sed -i 's|/usr/share|/app/share|g' /app/bin/tac-writer
      # Create dirs
      - mkdir -p /app/share/tac-writer
      - mkdir -p /app/share/applications
      - mkdir -p /app/share/icons/hicolor/scalable/apps
      # Copy
      - cp -r usr/share/tac-writer/* /app/share/tac-writer/
      # Install .desktop
      - install -Dm644 usr/share/applications/org.tac.writer.desktop /app/share/applications/org.tac.writer.desktop
      # Install AppStream Metainfo
      - install -Dm644 usr/share/metainfo/org.tac.writer.metainfo.xml /app/share/metainfo/org.tac.writer.metainfo.xml
      # Install icon
      - cp -r usr/share/icons/* /app/share/icons/ 2>/dev/null || true
      # Install license
      - install -Dm644 LICENSE /app/share/licenses/org.tac.writer/LICENSE
    
    sources:
      - type: git
        url: https://github.com/narayanls/tac-writer.git
        tag: v1.2.4
        commit: 8a2522475e919e4a3a3be68731482956ef9a68ae

