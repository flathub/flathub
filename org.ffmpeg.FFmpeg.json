{
    "name": "ffmpeg",
    "config-opts":[
        "--disable-everything",
        "--enable-zlib",
        "--enable-gpl",
        "--enable-swscale",
        "--enable-protocols",
        "--disable-programs",
        "--disable-sdl",
        "--enable-demuxers",
        "--enable-muxers",
        "--enable-parser=h263",
        "--enable-parser=h264",
        "--enable-parser=mpeg4video",
        "--enable-parser=vp8",
        "--enable-encoder=adpcm_g722",
        "--enable-decoder=adpcm_g722",
        "--enable-encoder=rawvideo",
        "--enable-decoder=rawvideo",
        "--enable-encoder=libx264",
        "--enable-decoder=h264",
        "--enable-encoder=pcm_alaw",
        "--enable-decoder=pcm_alaw",
        "--enable-encoder=pcm_mulaw",
        "--enable-decoder=pcm_mulaw",
        "--enable-encoder=mpeg4",
        "--enable-decoder=mpeg4",
        "--enable-encoder=libvpx_vp8",
        "--enable-decoder=vp8",
        "--enable-encoder=h263",
        "--enable-encoder=h263p",
        "--enable-decoder=h263",
        "--enable-encoder=mjpeg",
        "--enable-decoder=mjpeg",
        "--enable-decoder=mjpegb",
        "--enable-libspeex",
        "--enable-libopus",
        "--enable-libvpx",
        "--enable-encoder=libspeex",
        "--enable-decoder=libspeex",
        "--enable-encoder=libopus",
        "--enable-decoder=libopus",
        "--enable-encoder=gif",
        "--enable-decoder=gif",
        "--enable-encoder=jpegls",
        "--enable-decoder=jpegls",
        "--enable-encoder=ljpeg",
        "--enable-decoder=jpeg2000",
        "--enable-encoder=png",
        "--enable-decoder=png",
        "--enable-encoder=bmp",
        "--enable-decoder=bmp",
        "--enable-encoder=tiff",
        "--enable-decoder=tiff"
    ],
    "build-options": {
        "cflags": "-fPIC",
        "cxxflags": "-fPIC",
        "ldflags": "-fPIC"
    },
    "sources": [
        {
            "type": "archive",
            "url": "https://ffmpeg.org/releases/ffmpeg-3.3.4.tar.xz",
            "sha256": "98b97e1b908dfeb6aeb6d407e5a5eacdfc253a40c2d195f5867ed2d1d46ea957"
        }
    ],
    "modules": [
        {
            "name": "ladspa",
            "buildsystem": "simple",
            "build-commands":[
                "./autogen.sh"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "http://www.ladspa.org/download/ladspa_sdk_1.13.tgz",
                    "sha256": "b5ed3f4f253a0f6c1b7a1f4b8cf62376ca9f51d999650dd822650c43852d306b"
                },
                {
                    "type": "patch",
                    "path": "ladspa_patches/fix-memleak-in-plugin-scanning.patch",
                    "strip-components": 0
                },
                {
                    "type": "patch",
                    "path": "ladspa_patches/fallback-ladspa-path.patch"
                },
                {
                    "type": "script",
                    "commands":[
                        "cd src",
                        "sed -e 's/mkdirhier/mkdir -p/' -e \"s#-O3#${CFLAGS} ${LDFLAGS/,--as-needed/}#\" -i makefile",
                        "make targets",
                        "make INSTALL_PLUGINS_DIR=/app/lib/ladspa INSTALL_INCLUDE_DIR=/app/include INSTALL_BINARY_DIR=/app/bin install"
                    ]
                }
            ]
        }
    ]
}
