app-id: io.github.essentialist_app.essentialist
runtime: org.freedesktop.Platform
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
    - org.freedesktop.Sdk.Extension.golang
command: essentialist
finish-args:
  - --share=ipc
  - --socket=wayland
  - --socket=fallback-x11
  - --device=dri
  - --filesystem=home
build-options:
  env:
    - GOBIN=/app/bin
    - GOROOT=/usr/lib/sdk/golang
modules:
  - name: essentialist
    buildsystem: simple
    build-commands:
      - $GOROOT/bin/go build -o essentialist ./cmd/essentialist
      - $GOROOT/bin/go build -o flashdown ./cmd/flashdown
      - install -Dm00755 essentialist /app/bin/essentialist
      - install -Dm00755 flashdown /app/bin/flashdown
      - install -Dm644 cmd/essentialist/flatpak/io.github.essentialist_app.essentialist.metainfo.xml /app/share/metainfo/io.github.essentialist_app.essentialist.metainfo.xml
      - install -Dm644 cmd/essentialist/flatpak/io.github.essentialist_app.essentialist.desktop /app/share/applications/io.github.essentialist_app.essentialist.desktop
      - install -Dm644 cmd/essentialist/flatpak/io.github.essentialist_app.essentialist.svg /app/share/icons/hicolor/scalable/apps/io.github.essentialist_app.essentialist.svg
    sources:
      - type: git
        url: https://github.com/essentialist-app/essentialist.git
        tag: v0.3.3
      # Update with `go run github.com/dennwc/flatpak-go-mod@latest ../..`
      - go.mod.yml
