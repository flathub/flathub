name: yelp
rm-configure: true
config-opts:
  - --enable-shared
  - --disable-static
  - --enable-maintainer-mode
sources:
  - type: archive
    url: https://download.gnome.org/sources/yelp/3.30/yelp-3.30.0.tar.xz
    sha256: 647fb00a592e92c95815d59e86016339ef1bd1a0aea309bd3367962005480a18
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/issues/100
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/issues/114
  # https://gitlab.gnome.org/GNOME/yelp/issues/123
  # https://gitlab.gnome.org/GNOME/gnome-sdk-images/blob/1ac355de7b0c8cdcaa5765fa4c491a0f898422c4/yelp-use-in-sandbox.patch
  # https://gitlab.gnome.org/GNOME/gnome-sdk-images/blob/1ac355de7b0c8cdcaa5765fa4c491a0f898422c4/org.gnome.Sdk.json.in#L736-749
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/blob/7bfb5e9dfb65485aa462974f3435c562ee2de209/elements/sdk/yelp.bst
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/merge_requests/182
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/blob/25df7583570b24e509f67cf8c6a44c271a70a7ff/files/yelp/0001-Try-to-fit-in-a-sandbox.patch
  - type: patch
    path: yelp-3.30.0-sandbox.patch
  - type: shell
    commands:
      - cp -p /usr/share/automake-*/config.{sub,guess} .;
post-install:
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/issues/100
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/issues/115
  # https://gitlab.gnome.org/GNOME/gnome-build-meta/merge_requests/184
  - update-desktop-database;
  - install -p -D -m 0644 "COPYING" -t "${FLATPAK_DEST}/share/licenses/yelp/";
