{
    "app-id" : "org.virt_manager.virt-viewer",
    "runtime" : "org.gnome.Platform",
    "runtime-version" : "3.28",
    "sdk" : "org.gnome.Sdk",
    "command" : "virt-viewer",
    "rename-desktop-file": "remote-viewer.desktop",
    "rename-icon": "virt-viewer",
    "finish-args" : [
        "--share=ipc",
        "--socket=x11",
        "--socket=wayland",
        "--socket=pulseaudio",
        "--socket=ssh-auth",
        "--device=dri",
        "--share=network",
        "--talk-name=org.a11y.*",
        "--device=all",
        "--filesystem=~/.ssh/",
        "--filesystem=xdg-pictures",
        "--filesystem=xdg-run/dconf",
        "--filesystem=~/.config/dconf:ro",
        "--talk-name=ca.desrt.dconf",
        "--env=DCONF_USER_CONFIG_DIR=.config/dconf"
    ],
    "build-options" : {
        "cflags" : "-O2 -g",
        "cxxflags" : "-O2 -g"
    },
    "cleanup" : [
        "/include",
        "/sbin",
        "/lib/pkgconfig",
        "/share/man",
        "/share/gtk-doc",
        "/share/gir-*",
        "/share/pkgconfig",
        "*.la",
        "*.a"
    ],
    "modules" : [
        {
            "name": "eudev",
            "config-opts": [
                "--disable-hwdb",
                "--disable-logging",
                "--disable-gudev",
                "--disable-introspection",
                "--disable-keymap",
                "--disable-mtd_probe"
            ],
            "cleanup": [
                "/include",
                "/etc",
                "/libexec",
                "/sbin",
                "/lib/pkgconfig",
                "/man",
                "/share/aclocal",
                "/share/doc",
                "/share/gtk-doc",
                "/share/man",
                "/share/pkgconfig",
                "*.la",
                "*.a"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/gentoo/eudev/archive/v3.2.5.tar.gz",
                    "sha256": "870920011285b919fca5c60eaa5670312eeffe3883dd8cf564cd1179fc639336"
                },
                {
                    "type": "script",
                    "dest-filename": "autogen.sh",
                    "commands": [
                        "autoreconf -vfi"
                    ]
                }
            ]
        },
        {
            "name": "gcrypt-wrapper",
            "buildsystem": "simple",
            "cleanup": [
                "*"
            ],
            "build-commands": [
                "install -D libgcrypt-config /app/bin/libgcrypt-config"
            ],
            "sources": [
                {
                    "type": "script",
                    "dest-filename": "libgcrypt-config",
                    "commands": [
                        "if [ $1 == '--version' ]; then set -- '--modversion' ${@:4}; fi",
                        "exec pkg-config $@ libgcrypt"
                    ]
                }
            ]
        },
        {
            "name": "lz4",
            "build-options": {
                "env": {
                    "PREFIX": "/app"
                }
            },
            "buildsystem": "simple",
            "build-commands": [
                "make -j $FLATPAK_BUILDER_N_JOBS",
                "make install"
            ],
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/lz4/lz4/archive/v1.8.2.tar.gz",
                    "sha256": "0963fbe9ee90acd1d15e9f09e826eaaf8ea0312e854803caf2db0a6dd40f4464"
                }
            ]
        },
        {
            "name": "openssh",
            "cleanup": [
                "/bin/libexec",
                "/bin/ssh-*",
                "/bin/scp",
                "/bin/sftp"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://cloudflare.cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-7.8p1.tar.gz",
                    "sha256": "1a484bb15152c183bb2514e112aa30dd34138c3cfb032eee5490a66c507144ca"
                }
            ]
        },
        {
            "name": "libusb",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/libusb/libusb/archive/v1.0.22.tar.gz",
                    "sha256": "3500f7b182750cd9ccf9be8b1df998f83df56a39ab264976bdb3307773e16f48"
                }
            ]
        },
        {
            "name": "usbutils",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/gregkh/usbutils.git",
                    "tag": "v010",
                    "commit": "ca05b35b4edc26a2cc1582f3ec5d114f57e03470"
                }
            ]
        },
        {
            "name": "usbredir",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://gitlab.freedesktop.org/spice/usbredir/uploads/0996a17e5fb99309cfc971e499d036f5/usbredir-0.8.0.tar.bz2",
                    "sha256": "87bc9c5a81c982517a1bec70dc8d22e15ae197847643d58f20c0ced3c38c5e00"
                }
            ]
        },
        {
            "name": "libcacard",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://gitlab.freedesktop.org/spice/libcacard.git",
                    "tag": "v2.6.0",
                    "commit": "6f9f2a89886cbadb487f7b01c5baef0b95233a3d"
                }
            ]
        },
        {
            "name": "libnl",
            "config-opts": [
                "--enable-cli=no"
            ],
            "cleanup": [
                "/etc"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/thom311/libnl/releases/download/libnl3_4_0/libnl-3.4.0.tar.gz",
                    "sha256": "b7287637ae71c6db6f89e1422c995f0407ff2fe50cecd61a312b6a9b0921f5bf"
                }
            ]
        },
        {
            "name": "gtk-vnc",
            "cleanup": [
                "/bin"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/gtk-vnc/0.9/gtk-vnc-0.9.0.tar.xz",
                    "sha256": "3a9a88426809a5df2c14353cd9839b8c8163438cb708b31d8048c79d180fcab7"
                }
            ]
        },
        {
            "name": "spice-protocol",
            "sources": [
                {
                    "type": "git",
                    "url": "https://gitlab.freedesktop.org/spice/spice-protocol.git",
                    "tag": "v0.12.14",
                    "commit": "d0cfb3648cc1635df4d14facf2fdda0c40876619"
                }
            ]
        },
        {
            "name": "phodav",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://ftp.gnome.org/pub/GNOME/sources/phodav/2.2/phodav-2.2.tar.xz",
                    "sha256": "080305dc9e804562f200ffc8c7d345c76754fce9cb01489dddb1b2c52c0557c1"
                }
            ]
        },
        {
            "name": "libvirt",
            "cleanup": [
                "/bin",
                "/share",
                "/libexec",
                "/etc"
            ],
            "config-opts": [
                "--prefix=/app",
                "--sysconfdir=/etc",
                "--localstatedir=/var",
                "--without-html-dir",
                "--without-bash-completion",
                "--without-test",
                "--without-html-subdir",
                "--without-storage-dir",
                "--without-storage-fs",
                "--without-storage-lvm",
                "--without-storage-iscsi",
                "--without-storage-scsi",
                "--without-storage-mpath",
                "--without-storage-disk",
                "--without-storage-rbd",
                "--without-storage-sheepdog",
                "--without-storage-gluster",
                "--without-storage-zfs",
                "--without-storage-vstorage"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://libvirt.org/sources/libvirt-4.6.0.tar.xz",
                    "sha256": "b4ac6cd1825d89b9bbafff53f6308f1ac292a44d78eee67bebe01973e2574066"
                }
            ]
        },
        {
            "name": "libvirt-glib",
            "cleanup": [
                "/bin"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://libvirt.org/sources/glib/libvirt-glib-1.0.0.tar.gz",
                    "sha256": "ca9158d01cc4d9e0218f94f8c9ee04ae367d8c3b4396daaebca2c4b89a2e8a47"
                }
            ]
        },
        {
            "name": "spice-gtk",
            "cleanup": [
                "/bin"
            ],
            "config-opts": [
                "--disable-gtk-doc",
                "--disable-gtk-doc-html",
                "--disable-gtk-doc-pdf",
                "--enable-usbredir"
            ],
            "sources":[
                {
                    "type": "archive",
                    "url": "https://www.spice-space.org/download/gtk/spice-gtk-0.35.tar.bz2",
                    "sha256": "b4e6073de5125e2bdecdf1fbe7c9e8c4cabe9c85518889b42f72bf63c8ab9e86"
                }
            ]
        },
        {
            "name" : "remote-viewer",
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://releases.pagure.org/virt-viewer/virt-viewer-7.0.tar.gz",
                    "sha256": "47c2cfaa376f5f20968c0addfd65c62b90cab4e6336febf2bc44499d4cdcc903"
                }
            ]
        }
    ]
}